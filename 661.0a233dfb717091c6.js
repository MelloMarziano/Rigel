"use strict";(self.webpackChunkrigel=self.webpackChunkrigel||[]).push([[661],{3661:(w,g,c)=>{c.r(g),c.d(g,{RecetasPageModule:()=>T});var F=c(7412),a=c(9417),m=c(177),b=c(5743),f=c(467),d=c(9173),h=c(8359),v=c(4572),_=c(8032),u=c.n(_),e=c(7705);function k(s,l){if(1&s){const t=e.RV6();e.j41(0,"div",76)(1,"small",5),e.nrm(2,"i",77),e.EFF(3),e.j41(4,"button",78),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.limpiarFiltros())}),e.nrm(5,"i",79),e.EFF(6," Limpiar filtros "),e.k0s()()()}if(2&s){const t=e.XpG();e.R7$(3),e.Lme(" Mostrando ",t.recetasFiltradas.length," de ",t.recetas.length," recetas ")}}function R(s,l){if(1&s&&(e.j41(0,"div",98)(1,"span",99),e.EFF(2),e.k0s(),e.j41(3,"span",100),e.EFF(4),e.k0s()()),2&s){const t=l.$implicit;e.R7$(2),e.JRh(t.nombre),e.R7$(2),e.Lme("",t.cantidad," ",t.unidad,"")}}function E(s,l){if(1&s){const t=e.RV6();e.j41(0,"div",80)(1,"div",10)(2,"div",18)(3,"div",81)(4,"div",82),e.nrm(5,"i",83),e.j41(6,"h5",46),e.EFF(7),e.k0s()(),e.j41(8,"div",84)(9,"button",85),e.bIt("click",function(){const o=e.eBV(t).$implicit,n=e.XpG();return e.Njj(n.verReceta(o))}),e.nrm(10,"i",86),e.k0s(),e.j41(11,"button",87),e.bIt("click",function(){const o=e.eBV(t).$implicit,n=e.XpG();return e.Njj(n.editarReceta(o))}),e.nrm(12,"i",88),e.k0s(),e.j41(13,"button",89),e.bIt("click",function(){const o=e.eBV(t).$implicit,n=e.XpG();return e.Njj(n.eliminarReceta(o))}),e.nrm(14,"i",90),e.k0s()()(),e.j41(15,"p",91),e.EFF(16),e.k0s(),e.j41(17,"div",48)(18,"span",92),e.EFF(19),e.k0s()(),e.j41(20,"div",55)(21,"div",93)(22,"small",5),e.EFF(23,"Precio Venta"),e.k0s(),e.j41(24,"div",94),e.EFF(25),e.nI1(26,"currency"),e.k0s()(),e.j41(27,"div",93)(28,"small",5),e.EFF(29,"Costo Receta"),e.k0s(),e.j41(30,"div",94),e.EFF(31),e.nI1(32,"currency"),e.k0s()(),e.j41(33,"div",93)(34,"small",5),e.EFF(35,"Margen"),e.k0s(),e.j41(36,"div",94),e.EFF(37),e.nI1(38,"number"),e.k0s()()(),e.j41(39,"div",48)(40,"small",95),e.EFF(41,"Ingredientes:"),e.k0s(),e.j41(42,"div",96),e.DNE(43,R,5,3,"div",97),e.k0s()(),e.j41(44,"div",3)(45,"small",5),e.EFF(46,"Disponibilidad"),e.k0s(),e.j41(47,"span",92),e.EFF(48),e.k0s()()()()()}if(2&s){const t=l.$implicit;e.R7$(7),e.JRh(t.nombre),e.R7$(9),e.JRh(t.descripcion),e.R7$(2),e.HbH("Cocteles"===t.tipo?"bg-warning text-dark":"bg-info"),e.R7$(1),e.SpI(" ",t.tipo," "),e.R7$(6),e.JRh(e.ii3(26,14,t.precioVenta,"EUR","symbol","1.0-0")),e.R7$(6),e.JRh(e.ii3(32,19,t.costoTotal,"EUR","symbol","1.0-0")),e.R7$(5),e.HbH((t.margen||0)>=0?"text-success":"text-danger"),e.R7$(1),e.SpI(" ",e.i5U(38,24,t.margen,"1.1-1"),"% "),e.R7$(6),e.Y8G("ngForOf",t.ingredientes),e.R7$(4),e.HbH(t.disponible?"bg-success":"bg-secondary"),e.R7$(1),e.SpI(" ",t.disponible?"Disponible":"No disponible"," ")}}function j(s,l){if(1&s){const t=e.RV6();e.j41(0,"div",2)(1,"div",101),e.nrm(2,"i",102),e.j41(3,"h5",103),e.EFF(4,"No se encontraron recetas"),e.k0s(),e.j41(5,"p",5),e.EFF(6,"Intenta ajustar los filtros de b\xfasqueda"),e.k0s(),e.j41(7,"button",104),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.limpiarFiltros())}),e.nrm(8,"i",105),e.EFF(9," Mostrar todas las recetas "),e.k0s()()()}}function C(s,l){if(1&s){const t=e.RV6();e.j41(0,"div",2)(1,"div",101),e.nrm(2,"i",106),e.j41(3,"h5",103),e.EFF(4,"No tienes recetas creadas"),e.k0s(),e.j41(5,"p",5),e.EFF(6,"Crea tu primera receta para comenzar"),e.k0s(),e.j41(7,"button",6),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.abrirModalReceta())}),e.nrm(8,"i",107),e.EFF(9," Nueva Receta "),e.k0s()()()}}function y(s,l){if(1&s&&e.nrm(0,"option",121),2&s){const t=l.$implicit;e.Y8G("value",t.nombre),e.BMQ("data-id",t.id)}}function P(s,l){if(1&s){const t=e.RV6();e.j41(0,"tr",108)(1,"td")(2,"input",109),e.bIt("input",function(i){const n=e.eBV(t).index,p=e.XpG();return e.Njj(p.onProductoInput(i,n))})("change",function(i){const n=e.eBV(t).index,p=e.XpG();return e.Njj(p.onProductoSeleccionado(i,n))}),e.k0s(),e.j41(3,"datalist",110),e.DNE(4,y,1,2,"option",111),e.k0s()(),e.j41(5,"td")(6,"input",112),e.bIt("input",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.calcularCostos())}),e.k0s()(),e.j41(7,"td")(8,"select",113)(9,"option",114),e.EFF(10,"ml"),e.k0s(),e.j41(11,"option",115),e.EFF(12,"gr"),e.k0s(),e.j41(13,"option",116),e.EFF(14,"kg"),e.k0s(),e.j41(15,"option",117),e.EFF(16,"l"),e.k0s(),e.j41(17,"option",118),e.EFF(18,"unidad"),e.k0s()()(),e.j41(19,"td",119)(20,"button",120),e.bIt("click",function(){const o=e.eBV(t).index,n=e.XpG();return e.Njj(n.eliminarIngrediente(o))}),e.nrm(21,"i",90),e.k0s()()()}if(2&s){const t=l.$implicit,r=l.index,i=e.XpG();let o;e.Y8G("formGroupName",r),e.R7$(2),e.Y8G("value",i.getProductoNombre(null==(o=t.get("productoId"))?null:o.value)),e.BMQ("list","productos-datalist-"+r),e.R7$(1),e.Y8G("id","productos-datalist-"+r),e.R7$(1),e.Y8G("ngForOf",i.productos)}}function x(s,l){1&s&&(e.j41(0,"tr")(1,"td",122),e.nrm(2,"i",123),e.EFF(3,' No hay ingredientes. Haz clic en "Agregar Ingrediente" para comenzar. '),e.k0s()())}const I=[{path:"",component:(()=>{class s{constructor(t,r){this.fb=t,this.firestore=r,this.recetas=[],this.recetasFiltradas=[],this.productos=[],this.estadisticas={totalRecetas:0,cocteles:0,platos:0,ingredientesTotales:0},this.filtros={busqueda:"",tipo:"",disponibilidad:""},this.modoEdicion=!1,this.recetaEditando=null,this.costoReceta=0,this.margenReceta=0,this.subscriptions=new h.yU,this.inicializarForm()}ngOnInit(){this.cargarDatos()}ngOnDestroy(){this.subscriptions.unsubscribe()}inicializarForm(){this.recetaForm=this.fb.group({nombre:["",[a.k0.required]],tipo:["Cocteles",[a.k0.required]],descripcion:[""],precioVenta:[null,[a.k0.required,a.k0.min(0)]],ingredientes:this.fb.array([])})}get ingredientesFormArray(){return this.recetaForm.get("ingredientes")}cargarDatos(){const t=(0,d.collection)(this.firestore,"recetas"),r=(0,d.collection)(this.firestore,"productos");this.subscriptions.add((0,v.z)([(0,d.collectionData)(t,{idField:"id"}),(0,d.collectionData)(r,{idField:"id"})]).subscribe(([i,o])=>{this.recetas=i.map(n=>({...n,costoTotal:this.calcularCostoReceta(n.ingredientes||[]),margen:this.calcularMargen(n.precioVenta,this.calcularCostoReceta(n.ingredientes||[])),disponible:this.verificarDisponibilidad(n.ingredientes||[])})),this.productos=o.filter(n=>!n.esCombinado),this.calcularEstadisticas(),this.actualizarNombresIngredientes(),this.aplicarFiltros()}))}calcularEstadisticas(){this.estadisticas={totalRecetas:this.recetas.length,cocteles:this.recetas.filter(t=>"Cocteles"===t.tipo).length,platos:this.recetas.filter(t=>"Platos"===t.tipo).length,ingredientesTotales:this.recetas.reduce((t,r)=>t+(r.ingredientes?.length||0),0)}}actualizarNombresIngredientes(){this.recetas.forEach(t=>{t.ingredientes&&t.ingredientes.forEach(r=>{const i=this.productos.find(o=>o.id===r.productoId);i&&(r.nombre=i.nombre)})})}calcularCostoReceta(t){return t.reduce((r,i)=>{const o=this.productos.find(n=>n.id===i.productoId);return o?r+this.calcularCostoPorUnidad(o,i.unidad)*i.cantidad:r},0)}calcularCostoPorUnidad(t,r){const i=t.costo,o=t.unidadMedida;if(o===r)return i;const n={kg:{gr:1e3,ml:1e3},l:{ml:1e3},unidad:{ml:1,gr:1}};return n[o]&&n[o][r]?i/n[o][r]:i}calcularMargen(t,r){return 0===t?0:(t-r)/t*100}verificarDisponibilidad(t){return!t||0===t.length||t.every(r=>{const i=this.productos.find(n=>n.id===r.productoId);return!!i&&(i.stock||0)>=(r.cantidad||0)})}abrirModalReceta(){this.modoEdicion=!1,this.recetaEditando=null,this.recetaForm.reset(),this.ingredientesFormArray.clear(),this.costoReceta=0,this.margenReceta=0,$("#modalReceta").modal("show")}editarReceta(t){this.modoEdicion=!0,this.recetaEditando=t,this.recetaForm.patchValue({nombre:t.nombre,tipo:t.tipo,descripcion:t.descripcion,precioVenta:t.precioVenta}),this.ingredientesFormArray.clear(),t.ingredientes&&t.ingredientes.forEach(r=>{this.ingredientesFormArray.push(this.fb.group({productoId:[r.productoId,a.k0.required],cantidad:[r.cantidad,[a.k0.required,a.k0.min(0)]],unidad:[r.unidad,a.k0.required]}))}),this.calcularCostos(),$("#modalReceta").modal("show")}verReceta(t){const r=t.ingredientes?.map(i=>`<li>${i.nombre}: ${i.cantidad} ${i.unidad}</li>`).join("")||"";u().fire({title:t.nombre,html:`\n        <div class="text-start">\n          <p><strong>Tipo:</strong> ${t.tipo}</p>\n          <p><strong>Descripci\xf3n:</strong> ${t.descripcion}</p>\n          <p><strong>Precio de Venta:</strong> \u20ac${t.precioVenta}</p>\n          <p><strong>Costo:</strong> \u20ac${t.costoTotal?.toFixed(2)}</p>\n          <p><strong>Margen:</strong> ${t.margen?.toFixed(1)}%</p>\n          <p><strong>Ingredientes:</strong></p>\n          <ul>${r}</ul>\n        </div>\n      `,width:600,confirmButtonText:"Cerrar"})}agregarIngrediente(){const t=this.fb.group({productoId:["",a.k0.required],cantidad:[null,[a.k0.required,a.k0.min(0)]],unidad:["ml",a.k0.required]});this.ingredientesFormArray.push(t)}eliminarIngrediente(t){this.ingredientesFormArray.removeAt(t),this.calcularCostos()}onProductoChange(t){this.calcularCostos()}calcularCostos(){this.costoReceta=this.calcularCostoReceta(this.ingredientesFormArray.value);const r=this.recetaForm.get("precioVenta")?.value||0;this.margenReceta=this.calcularMargen(r,this.costoReceta)}guardarReceta(){var t=this;return(0,f.A)(function*(){if(!t.recetaForm.valid)return void u().fire("Error","Por favor completa todos los campos requeridos","error");const r=t.recetaForm.value,i={...r,costoTotal:t.costoReceta,margen:t.margenReceta,disponible:t.verificarDisponibilidad(r.ingredientes),fechaActualizacion:new Date};try{if(t.modoEdicion&&t.recetaEditando?.id){const o=(0,d.doc)(t.firestore,"recetas",t.recetaEditando.id);yield(0,d.updateDoc)(o,t.cleanObjectForFirebase(i)),u().fire("\xa1\xc9xito!","Receta actualizada correctamente","success")}else{i.fechaCreacion=new Date;const o=(0,d.collection)(t.firestore,"recetas");yield(0,d.addDoc)(o,t.cleanObjectForFirebase(i)),u().fire("\xa1\xc9xito!","Receta creada correctamente","success")}t.cerrarModal()}catch(o){console.error("Error al guardar receta:",o),u().fire("Error","No se pudo guardar la receta","error")}})()}cerrarModal(){$("#modalReceta").modal("hide"),this.recetaForm.reset(),this.ingredientesFormArray.clear(),this.modoEdicion=!1,this.recetaEditando=null}aplicarFiltros(){let t=[...this.recetas];if(this.filtros.busqueda.trim()){const r=this.filtros.busqueda.toLowerCase().trim();t=t.filter(i=>i.nombre.toLowerCase().includes(r)||i.descripcion.toLowerCase().includes(r))}this.filtros.tipo&&(t=t.filter(r=>r.tipo===this.filtros.tipo)),this.filtros.disponibilidad&&("disponible"===this.filtros.disponibilidad?t=t.filter(r=>r.disponible):"no-disponible"===this.filtros.disponibilidad&&(t=t.filter(r=>!r.disponible))),this.recetasFiltradas=t}eliminarReceta(t){var r=this;return(0,f.A)(function*(){if((yield u().fire({title:"\xbfEliminar receta?",html:`\n        <div class="text-start">\n          <p>\xbfEst\xe1s seguro de que quieres eliminar la receta <strong>"${t.nombre}"</strong>?</p>\n          <div class="alert alert-warning">\n            <i class="bi bi-exclamation-triangle me-2"></i>\n            Esta acci\xf3n no se puede deshacer.\n          </div>\n        </div>\n      `,icon:"warning",showCancelButton:!0,confirmButtonColor:"#dc3545",cancelButtonColor:"#6c757d",confirmButtonText:"S\xed, eliminar",cancelButtonText:"Cancelar"})).isConfirmed&&t.id)try{const o=(0,d.doc)(r.firestore,"recetas",t.id);yield(0,d.deleteDoc)(o),u().fire({title:"\xa1Eliminada!",text:"La receta ha sido eliminada correctamente.",icon:"success",timer:2e3,showConfirmButton:!1})}catch(o){console.error("Error al eliminar receta:",o),u().fire("Error","No se pudo eliminar la receta","error")}})()}limpiarFiltros(){this.filtros={busqueda:"",tipo:"",disponibilidad:""},this.aplicarFiltros()}cleanObjectForFirebase(t){const r={};for(const i in t)null!=t[i]&&(r[i]=t[i]instanceof Date||"object"!=typeof t[i]||Array.isArray(t[i])?t[i]:this.cleanObjectForFirebase(t[i]));return r}getProductoNombre(t){if(!t)return"";const r=this.productos.find(i=>i.id===t);return r?r.nombre:""}onProductoInput(t,r){}onProductoSeleccionado(t,r){const i=t.target.value,o=this.productos.find(n=>n.nombre===i);o&&(this.ingredientesFormArray.at(r).patchValue({productoId:o.id}),this.calcularCostos())}static{this.\u0275fac=function(r){return new(r||s)(e.rXU(a.ok),e.rXU(d.Firestore))}}static{this.\u0275cmp=e.VBU({type:s,selectors:[["app-recetas-page"]],decls:179,vars:33,consts:[[1,"container-fluid"],[1,"row"],[1,"col-12"],[1,"d-flex","justify-content-between","align-items-center"],[1,"mb-1"],[1,"text-muted"],[1,"btn","btn-danger",3,"click"],[1,"bi","bi-plus"],[1,"row","mt-4"],[1,"col-12","col-md-6","col-xl-3","mb-4"],[1,"card","border-0","shadow-sm","h-100"],[1,"card-body","text-center"],[1,"text-primary","fw-bold","mb-1"],[1,"text-muted","mb-0"],[1,"text-warning","fw-bold","mb-1"],[1,"text-info","fw-bold","mb-1"],[1,"text-success","fw-bold","mb-1"],[1,"card","border-0","shadow-sm","mb-4"],[1,"card-body"],[1,"row","g-3"],[1,"col-12","col-md-6"],[1,"input-group"],[1,"input-group-text"],[1,"bi","bi-search"],["type","text","placeholder","Buscar recetas por nombre o descripci\xf3n...",1,"form-control",3,"ngModel","ngModelChange","input"],[1,"col-12","col-md-3"],[1,"form-select",3,"ngModel","ngModelChange","change"],["value",""],["value","Cocteles"],["value","Platos"],["value","disponible"],["value","no-disponible"],["class","mt-3",4,"ngIf"],["class","col-12 col-lg-6 mb-4",4,"ngFor","ngForOf"],["class","col-12",4,"ngIf"],["id","modalReceta","tabindex","-1","data-bs-backdrop","static",1,"modal","fade"],[1,"modal-dialog","modal-xl"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["type","button",1,"btn-close",3,"click"],[1,"modal-body"],[3,"formGroup","ngSubmit"],[1,"col-12","col-lg-6"],[1,"card","border-0","bg-light","mb-4"],[1,"card-header","bg-transparent","border-0"],[1,"mb-0"],[1,"bi","bi-info-circle","me-2"],[1,"mb-3"],[1,"form-label"],["type","text","formControlName","nombre","placeholder","Ej: Mojito Cl\xe1sico",1,"form-control"],["formControlName","tipo",1,"form-select"],["rows","3","formControlName","descripcion","placeholder","Descripci\xf3n de la receta (opcional)",1,"form-control"],["type","number","formControlName","precioVenta","min","0","step","0.01","placeholder","0.00",1,"form-control"],[1,"bi","bi-calculator","me-2"],[1,"row","mb-3"],[1,"col-6"],[1,"text-center","p-3","bg-warning","bg-opacity-10","rounded"],[1,"text-center","p-3","bg-success","bg-opacity-10","rounded"],[1,"mb-1","text-success"],[1,"alert","alert-info","py-2","px-3","mb-0"],[1,"bi","bi-info-circle","me-1"],[1,"card","border-0","bg-light"],[1,"card-header","bg-transparent","border-0","d-flex","justify-content-between","align-items-center"],["type","button",1,"btn","btn-sm","btn-info",3,"click"],[1,"table-responsive",2,"max-height","400px"],[1,"table","table-borderless","table-sm"],[1,"sticky-top","bg-light"],[2,"width","40%"],[2,"width","20%"],["formArrayName","ingredientes"],[3,"formGroupName",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"modal-footer"],["type","button",1,"btn","btn-secondary",3,"click"],["type","button",1,"btn","btn-danger",3,"disabled","click"],[1,"mt-3"],[1,"bi","bi-funnel","me-1"],[1,"btn","btn-sm","btn-link","p-0","ms-2",3,"click"],[1,"bi","bi-x-circle"],[1,"col-12","col-lg-6","mb-4"],[1,"d-flex","justify-content-between","align-items-start","mb-3"],[1,"d-flex","align-items-center"],[1,"bi","bi-funnel","text-muted","me-2"],[1,"d-flex","gap-2"],["title","Ver receta",1,"btn","btn-sm","btn-outline-primary",3,"click"],[1,"bi","bi-eye"],["title","Editar receta",1,"btn","btn-sm","btn-outline-secondary",3,"click"],[1,"bi","bi-pencil"],["title","Eliminar receta",1,"btn","btn-sm","btn-outline-danger",3,"click"],[1,"bi","bi-trash"],[1,"text-muted","small","mb-3"],[1,"badge"],[1,"col-4"],[1,"fw-bold"],[1,"text-muted","d-block","mb-2"],[1,"ingredient-list"],["class","d-flex justify-content-between align-items-center mb-1",4,"ngFor","ngForOf"],[1,"d-flex","justify-content-between","align-items-center","mb-1"],[1,"small"],[1,"small","text-muted"],[1,"text-center","py-5"],[1,"bi","bi-search","fs-1","text-muted"],[1,"mt-3","text-muted"],[1,"btn","btn-outline-primary",3,"click"],[1,"bi","bi-arrow-clockwise","me-1"],[1,"bi","bi-cup-straw","fs-1","text-muted"],[1,"bi","bi-plus","me-1"],[3,"formGroupName"],["type","text","placeholder","Escribe para buscar...",1,"form-control","form-control-sm",3,"value","input","change"],[3,"id"],[3,"value",4,"ngFor","ngForOf"],["type","number","formControlName","cantidad","min","0","step","0.01","placeholder","0",1,"form-control","form-control-sm",3,"input"],["formControlName","unidad",1,"form-select","form-select-sm"],["value","ml"],["value","gr"],["value","kg"],["value","l"],["value","unidad"],[1,"text-center"],["type","button",1,"btn","btn-sm","btn-outline-danger",3,"click"],[3,"value"],["colspan","4",1,"text-center","text-muted","py-3"],[1,"bi","bi-inbox","fs-3","d-block","mb-2"]],template:function(r,i){if(1&r&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div")(5,"h3",4),e.EFF(6,"Gesti\xf3n de Recetas"),e.k0s(),e.j41(7,"span",5),e.EFF(8,"Administra tus productos combinados y recetas"),e.k0s()(),e.j41(9,"button",6),e.bIt("click",function(){return i.abrirModalReceta()}),e.nrm(10,"i",7),e.EFF(11," Nueva Receta "),e.k0s()()()(),e.j41(12,"div",8)(13,"div",9)(14,"div",10)(15,"div",11)(16,"h2",12),e.EFF(17),e.k0s(),e.j41(18,"p",13),e.EFF(19,"Total Recetas"),e.k0s()()()(),e.j41(20,"div",9)(21,"div",10)(22,"div",11)(23,"h2",14),e.EFF(24),e.k0s(),e.j41(25,"p",13),e.EFF(26,"Cocteles"),e.k0s()()()(),e.j41(27,"div",9)(28,"div",10)(29,"div",11)(30,"h2",15),e.EFF(31),e.k0s(),e.j41(32,"p",13),e.EFF(33,"Platos"),e.k0s()()()(),e.j41(34,"div",9)(35,"div",10)(36,"div",11)(37,"h2",16),e.EFF(38),e.k0s(),e.j41(39,"p",13),e.EFF(40,"Ingredientes Totales"),e.k0s()()()()(),e.j41(41,"div",8)(42,"div",2)(43,"div",17)(44,"div",18)(45,"div",19)(46,"div",20)(47,"div",21)(48,"span",22),e.nrm(49,"i",23),e.k0s(),e.j41(50,"input",24),e.bIt("ngModelChange",function(n){return i.filtros.busqueda=n})("input",function(){return i.aplicarFiltros()}),e.k0s()()(),e.j41(51,"div",25)(52,"select",26),e.bIt("ngModelChange",function(n){return i.filtros.tipo=n})("change",function(){return i.aplicarFiltros()}),e.j41(53,"option",27),e.EFF(54,"Todos los tipos"),e.k0s(),e.j41(55,"option",28),e.EFF(56,"Cocteles"),e.k0s(),e.j41(57,"option",29),e.EFF(58,"Platos"),e.k0s()()(),e.j41(59,"div",25)(60,"select",26),e.bIt("ngModelChange",function(n){return i.filtros.disponibilidad=n})("change",function(){return i.aplicarFiltros()}),e.j41(61,"option",27),e.EFF(62,"Todas las recetas"),e.k0s(),e.j41(63,"option",30),e.EFF(64,"Solo disponibles"),e.k0s(),e.j41(65,"option",31),e.EFF(66,"No disponibles"),e.k0s()()()(),e.DNE(67,k,7,2,"div",32),e.k0s()()()(),e.j41(68,"div",1),e.DNE(69,E,49,27,"div",33),e.DNE(70,j,10,0,"div",34),e.DNE(71,C,10,0,"div",34),e.k0s()(),e.j41(72,"div",35)(73,"div",36)(74,"div",37)(75,"div",38)(76,"h5",39),e.EFF(77),e.k0s(),e.j41(78,"button",40),e.bIt("click",function(){return i.cerrarModal()}),e.k0s()(),e.j41(79,"div",41)(80,"form",42),e.bIt("ngSubmit",function(){return i.guardarReceta()}),e.j41(81,"div",1)(82,"div",43)(83,"div",44)(84,"div",45)(85,"h6",46),e.nrm(86,"i",47),e.EFF(87," Informaci\xf3n de la Receta "),e.k0s()(),e.j41(88,"div",18)(89,"div",48)(90,"label",49),e.EFF(91,"Nombre de la Receta *"),e.k0s(),e.nrm(92,"input",50),e.k0s(),e.j41(93,"div",48)(94,"label",49),e.EFF(95,"Tipo de Receta *"),e.k0s(),e.j41(96,"select",51)(97,"option",28),e.EFF(98,"Cocteles"),e.k0s(),e.j41(99,"option",29),e.EFF(100,"Platos"),e.k0s()()(),e.j41(101,"div",48)(102,"label",49),e.EFF(103,"Descripci\xf3n"),e.k0s(),e.nrm(104,"textarea",52),e.k0s(),e.j41(105,"div",48)(106,"label",49),e.EFF(107,"Precio de Venta *"),e.k0s(),e.nrm(108,"input",53),e.k0s()()()(),e.j41(109,"div",43)(110,"div",44)(111,"div",45)(112,"h6",46),e.nrm(113,"i",54),e.EFF(114," An\xe1lisis de Costos "),e.k0s()(),e.j41(115,"div",18)(116,"div",55)(117,"div",56)(118,"div",57)(119,"h4",4),e.EFF(120),e.nI1(121,"currency"),e.k0s(),e.j41(122,"small",5),e.EFF(123,"Costo de Receta"),e.k0s()()(),e.j41(124,"div",56)(125,"div",58)(126,"h4",59),e.EFF(127),e.nI1(128,"number"),e.k0s(),e.j41(129,"small",5),e.EFF(130,"Margen de Ganancia"),e.k0s()()()(),e.j41(131,"div",60)(132,"small")(133,"strong"),e.nrm(134,"i",61),e.EFF(135,"\xbfC\xf3mo se calcula?"),e.k0s(),e.nrm(136,"br"),e.EFF(137," \u2022 "),e.j41(138,"strong"),e.EFF(139,"Costo:"),e.k0s(),e.EFF(140," Suma del precio de todos los ingredientes seg\xfan su cantidad"),e.nrm(141,"br"),e.EFF(142," \u2022 "),e.j41(143,"strong"),e.EFF(144,"Margen:"),e.k0s(),e.EFF(145," Porcentaje de ganancia = ((Precio Venta - Costo) \xf7 Precio Venta) \xd7 100"),e.nrm(146,"br"),e.EFF(147," \u2022 "),e.j41(148,"strong"),e.EFF(149,"Ganancia:"),e.k0s(),e.EFF(150),e.nI1(151,"currency"),e.k0s()()()()()(),e.j41(152,"div",62)(153,"div",63)(154,"h6",46),e.EFF(155,"Ingredientes de la Receta"),e.k0s(),e.j41(156,"button",64),e.bIt("click",function(){return i.agregarIngrediente()}),e.nrm(157,"i",7),e.EFF(158," Agregar Ingrediente "),e.k0s()(),e.j41(159,"div",18)(160,"div",65)(161,"table",66)(162,"thead",67)(163,"tr")(164,"th",68),e.EFF(165,"Producto"),e.k0s(),e.j41(166,"th",69),e.EFF(167,"Cantidad"),e.k0s(),e.j41(168,"th",69),e.EFF(169,"Unidad"),e.k0s(),e.nrm(170,"th",69),e.k0s()(),e.j41(171,"tbody",70),e.DNE(172,P,22,5,"tr",71),e.DNE(173,x,4,0,"tr",72),e.k0s()()()()()()(),e.j41(174,"div",73)(175,"button",74),e.bIt("click",function(){return i.cerrarModal()}),e.EFF(176," Cancelar "),e.k0s(),e.j41(177,"button",75),e.bIt("click",function(){return i.guardarReceta()}),e.EFF(178),e.k0s()()()()()),2&r){let o;e.R7$(17),e.JRh(i.estadisticas.totalRecetas),e.R7$(7),e.JRh(i.estadisticas.cocteles),e.R7$(7),e.JRh(i.estadisticas.platos),e.R7$(7),e.JRh(i.estadisticas.ingredientesTotales),e.R7$(12),e.Y8G("ngModel",i.filtros.busqueda),e.R7$(2),e.Y8G("ngModel",i.filtros.tipo),e.R7$(8),e.Y8G("ngModel",i.filtros.disponibilidad),e.R7$(7),e.Y8G("ngIf",i.filtros.busqueda||i.filtros.tipo||i.filtros.disponibilidad),e.R7$(2),e.Y8G("ngForOf",i.recetasFiltradas),e.R7$(1),e.Y8G("ngIf",0===i.recetasFiltradas.length&&i.recetas.length>0),e.R7$(1),e.Y8G("ngIf",0===i.recetas.length),e.R7$(6),e.SpI("",i.modoEdicion?"Editar":"Nueva"," Receta"),e.R7$(3),e.Y8G("formGroup",i.recetaForm),e.R7$(40),e.JRh(e.ii3(121,20,i.costoReceta,"EUR","symbol","1.0-0")),e.R7$(7),e.SpI("",e.i5U(128,25,i.margenReceta,"1.1-1"),"%"),e.R7$(23),e.SpI(" ",e.ii3(151,28,((null==(o=i.recetaForm.get("precioVenta"))?null:o.value)||0)-i.costoReceta,"EUR","symbol","1.2-2")," por receta "),e.R7$(22),e.Y8G("ngForOf",i.ingredientesFormArray.controls),e.R7$(1),e.Y8G("ngIf",0===i.ingredientesFormArray.length),e.R7$(4),e.Y8G("disabled",!i.recetaForm.valid),e.R7$(1),e.SpI(" ",i.modoEdicion?"Actualizar":"Crear"," Receta ")}},dependencies:[m.Sq,m.bT,a.qT,a.xH,a.y7,a.me,a.Q0,a.wz,a.BC,a.cb,a.VZ,a.j4,a.JD,a.$R,a.v8,a.vS,m.QX,m.oe],styles:[".ingredient-list[_ngcontent-%COMP%]{max-height:120px;overflow-y:auto}.card[_ngcontent-%COMP%]{transition:transform .2s ease-in-out}.card[_ngcontent-%COMP%]:hover{transform:translateY(-2px)}.stat-card[_ngcontent-%COMP%]{border-left:4px solid var(--bs-primary)}.modal-xl[_ngcontent-%COMP%]{max-width:1200px}.table-responsive[_ngcontent-%COMP%]{max-height:300px;overflow-y:auto}.badge[_ngcontent-%COMP%]{font-size:.75em}.btn-sm[_ngcontent-%COMP%]{padding:.25rem .5rem;font-size:.875rem}.bg-opacity-10[_ngcontent-%COMP%]{background-color:rgba(var(--bs-success-rgb),.1)!important}.bg-warning.bg-opacity-10[_ngcontent-%COMP%]{background-color:rgba(var(--bs-warning-rgb),.1)!important}.ingredient-row[_ngcontent-%COMP%]{border-bottom:1px solid #eee;padding:.5rem 0}.ingredient-row[_ngcontent-%COMP%]:last-child{border-bottom:none}.cost-analysis[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f8f9fa 0%,#e9ecef 100%);border-radius:.5rem;padding:1rem}.recipe-card[_ngcontent-%COMP%]{border-left:4px solid #007bff;transition:all .3s ease}.recipe-card[_ngcontent-%COMP%]:hover{box-shadow:0 .5rem 1rem #00000026!important}.recipe-type-cocktail[_ngcontent-%COMP%]{border-left-color:#ffc107}.recipe-type-dish[_ngcontent-%COMP%]{border-left-color:#17a2b8}.hover-bg-light[_ngcontent-%COMP%]:hover{background-color:#f8f9fa}.cursor-pointer[_ngcontent-%COMP%]{cursor:pointer}.productos-dropdown-item[_ngcontent-%COMP%]{padding:.5rem .75rem;cursor:pointer;transition:background-color .15s ease-in-out}.productos-dropdown-item[_ngcontent-%COMP%]:hover{background-color:#f8f9fa}"]})}}return s})()}];let M=(()=>{class s{static{this.\u0275fac=function(r){return new(r||s)}}static{this.\u0275mod=e.$C({type:s})}static{this.\u0275inj=e.G2t({imports:[b.iI.forChild(I),b.iI]})}}return s})(),T=(()=>{class s{static{this.\u0275fac=function(r){return new(r||s)}}static{this.\u0275mod=e.$C({type:s})}static{this.\u0275inj=e.G2t({imports:[M,F.PrivateModule,m.MD,a.X1,a.YN]})}}return s})()}}]);