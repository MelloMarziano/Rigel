"use strict";(self.webpackChunkrigel=self.webpackChunkrigel||[]).push([[683],{3683:(ge,k,m)=>{m.r(k),m.d(k,{InventarioPageModule:()=>de});var E=m(2432),g=m(9417),h=m(177),y=m(8498),b=m(467),s=m(2418),w=m(8359),S=m(8032),d=m.n(S),e=m(7705),R=m(4441);function j(i,l){if(1&i&&(e.j41(0,"option",40),e.EFF(1),e.k0s()),2&i){const t=l.$implicit;e.Y8G("value",t.id),e.R7$(1),e.SpI(" ",t.nombre," ")}}function A(i,l){if(1&i&&(e.j41(0,"option",40),e.EFF(1),e.k0s()),2&i){const t=l.$implicit;e.Y8G("value",t.id),e.R7$(1),e.SpI(" ",t.nombre," ")}}function T(i,l){1&i&&e.nrm(0,"span",41)}function $(i,l){1&i&&e.nrm(0,"i",42)}function G(i,l){1&i&&(e.j41(0,"div",43)(1,"div",44),e.nrm(2,"i",45),e.k0s(),e.j41(3,"h4",46),e.EFF(4,"No hay inventario para esta fecha"),e.k0s(),e.j41(5,"p",47),e.EFF(6," Selecciona una fecha y crea un nuevo inventario o busca uno existente "),e.k0s()())}function D(i,l){1&i&&e.nrm(0,"span",41)}function z(i,l){1&i&&e.nrm(0,"i",93)}function N(i,l){if(1&i){const t=e.RV6();e.j41(0,"div",85),e.nrm(1,"i",86),e.j41(2,"div",87)(3,"strong"),e.EFF(4,"Inventario en borrador"),e.k0s(),e.EFF(5," - Este inventario no est\xe1 finalizado. Recuerda guardarlo o cancelarlo. "),e.k0s(),e.j41(6,"div",88)(7,"button",89),e.bIt("click",function(){e.eBV(t);const a=e.XpG(2);return e.Njj(a.cancelarInventario())}),e.nrm(8,"i",90),e.EFF(9," Cancelar "),e.k0s(),e.j41(10,"button",91),e.bIt("click",function(){e.eBV(t);const a=e.XpG(2);return e.Njj(a.guardarInventario())}),e.DNE(11,D,1,0,"span",18),e.DNE(12,z,1,0,"i",92),e.EFF(13),e.k0s()()()}if(2&i){const t=e.XpG(2);e.R7$(7),e.Y8G("disabled",t.isSaving),e.R7$(3),e.Y8G("disabled",t.isSaving),e.R7$(1),e.Y8G("ngIf",t.isSaving),e.R7$(1),e.Y8G("ngIf",!t.isSaving),e.R7$(1),e.SpI(" ",t.isSaving?"Guardando...":"Finalizar Inventario"," ")}}function Y(i,l){if(1&i&&(e.j41(0,"div",94)(1,"span",95),e.nrm(2,"i",96),e.EFF(3," Inventario Finalizado "),e.k0s(),e.j41(4,"small",97),e.EFF(5),e.nI1(6,"date"),e.k0s()()),2&i){const t=e.XpG(2);e.R7$(5),e.SpI(" Finalizado el ",e.i5U(6,1,t.inventarioActual.fechaActualizacion,"dd/MM/yyyy HH:mm")," ")}}function B(i,l){if(1&i&&(e.j41(0,"option",40),e.EFF(1),e.k0s()),2&i){const t=l.$implicit,n=e.XpG(3);e.Y8G("value",t.id),e.R7$(1),e.Lme(" ",t.nombre," (",n.getProductosPorFamilia(t.id||"").length,") ")}}function U(i,l){if(1&i){const t=e.RV6();e.j41(0,"div",98)(1,"div",99)(2,"div",7)(3,"div",100)(4,"div",101)(5,"label",102),e.nrm(6,"i",103),e.EFF(7," Filtrar por familia: "),e.k0s(),e.j41(8,"select",104),e.bIt("ngModelChange",function(a){e.eBV(t);const o=e.XpG(2);return e.Njj(o.familiaSeleccionada=a)})("ngModelChange",function(){e.eBV(t);const a=e.XpG(2);return e.Njj(a.aplicarFiltroFamilia())}),e.j41(9,"option",14),e.EFF(10),e.k0s(),e.DNE(11,B,2,3,"option",105),e.k0s()()()()()()}if(2&i){const t=e.XpG(2);e.R7$(8),e.Y8G("ngModel",t.familiaSeleccionada),e.R7$(2),e.SpI(" Todas las familias (",t.inventarioActual.productos.length,") "),e.R7$(1),e.Y8G("ngForOf",t.familiasDisponibles)("ngForTrackBy",t.trackByFamilia)}}function X(i,l){1&i&&(e.j41(0,"span",106),e.EFF(1,"Borrador"),e.k0s())}function V(i,l){1&i&&(e.j41(0,"span",107),e.EFF(1,"Finalizado"),e.k0s())}function J(i,l){if(1&i&&(e.j41(0,"span",108),e.EFF(1),e.k0s()),2&i){const t=e.XpG(2);e.R7$(1),e.JRh(t.getNombreFamiliaSeleccionada())}}function H(i,l){1&i&&e.nrm(0,"span",41)}function L(i,l){1&i&&e.nrm(0,"i",111)}function Z(i,l){if(1&i){const t=e.RV6();e.j41(0,"div")(1,"button",89),e.bIt("click",function(){e.eBV(t);const a=e.XpG(2);return e.Njj(a.cancelarInventario())}),e.nrm(2,"i",90),e.EFF(3," Cancelar "),e.k0s(),e.j41(4,"button",109),e.bIt("click",function(){e.eBV(t);const a=e.XpG(2);return e.Njj(a.guardarInventario())}),e.DNE(5,H,1,0,"span",18),e.DNE(6,L,1,0,"i",110),e.EFF(7),e.k0s()()}if(2&i){const t=e.XpG(2);e.R7$(1),e.Y8G("disabled",t.isSaving),e.R7$(3),e.Y8G("disabled",t.isSaving),e.R7$(1),e.Y8G("ngIf",t.isSaving),e.R7$(1),e.Y8G("ngIf",!t.isSaving),e.R7$(1),e.SpI(" ",t.isSaving?"Finalizando...":"Finalizar Inventario"," ")}}function Q(i,l){1&i&&(e.j41(0,"div")(1,"span",55),e.nrm(2,"i",112),e.EFF(3," Inventario finalizado - Solo lectura "),e.k0s()())}function K(i,l){if(1&i&&(e.j41(0,"small",132),e.EFF(1),e.nI1(2,"number"),e.k0s()),2&i){const t=e.XpG().$implicit;e.HbH(t.diferencia>0?"text-success":"text-danger"),e.R7$(1),e.Lme(" ",t.diferencia>0?"+":"","",e.i5U(2,4,t.diferencia,"1.1-1")," ")}}function W(i,l){if(1&i){const t=e.RV6();e.j41(0,"tr")(1,"td",113)(2,"div")(3,"strong",114),e.EFF(4),e.k0s(),e.j41(5,"small",115),e.EFF(6),e.k0s(),e.j41(7,"div",116)(8,"span",117),e.EFF(9),e.k0s(),e.j41(10,"small",118),e.EFF(11),e.k0s()()()(),e.j41(12,"td",119)(13,"span",120),e.EFF(14),e.k0s()(),e.j41(15,"td",121)(16,"span",122),e.EFF(17),e.k0s()(),e.j41(18,"td",123)(19,"span",124),e.EFF(20),e.nI1(21,"number"),e.k0s(),e.j41(22,"div",125)(23,"small",97),e.EFF(24),e.nI1(25,"currency"),e.k0s()()(),e.j41(26,"td",126)(27,"span",127),e.EFF(28),e.nI1(29,"currency"),e.k0s()(),e.j41(30,"td",123)(31,"div",128)(32,"input",129),e.bIt("ngModelChange",function(a){const c=e.eBV(t).$implicit;return e.Njj(c.stockContado=a)})("ngModelChange",function(){const o=e.eBV(t).$implicit,c=e.XpG(2);return e.Njj(c.calcularValorTotal(o))}),e.k0s(),e.DNE(33,K,3,7,"small",130),e.k0s()(),e.j41(34,"td",131)(35,"strong",127),e.EFF(36),e.nI1(37,"currency"),e.k0s()()()}if(2&i){const t=l.$implicit,n=e.XpG(2);e.R7$(4),e.JRh(t.nombre),e.R7$(2),e.JRh(t.unidadMedida),e.R7$(3),e.JRh(t.categoria),e.R7$(2),e.JRh(t.proveedor),e.R7$(3),e.JRh(t.categoria),e.R7$(2),e.Y8G("title",t.proveedor),e.R7$(1),e.SpI(" ",t.proveedor," "),e.R7$(2),e.HbH(n.getStockClass(t.stockActual)),e.R7$(1),e.SpI(" ",e.i5U(21,20,t.stockActual,"1.1-1")," "),e.R7$(4),e.SpI(" ",e.ii3(25,23,t.costoUnitario,"EUR","symbol","1.2-2")," "),e.R7$(4),e.SpI(" ",e.ii3(29,28,t.costoUnitario,"EUR","symbol","1.2-2")," "),e.R7$(4),e.AVh("is-invalid",0!==t.diferencia),e.Y8G("ngModel",t.stockContado)("disabled","finalizado"===n.inventarioActual.estado),e.R7$(1),e.Y8G("ngIf",0!==t.diferencia),e.R7$(2),e.HbH(0!==t.diferencia?"text-warning":"text-success"),e.R7$(1),e.SpI(" ",e.ii3(37,33,t.valorTotal,"EUR","symbol","1.0-0")," ")}}function q(i,l){if(1&i&&(e.j41(0,"div",48),e.DNE(1,N,14,5,"div",49),e.DNE(2,Y,7,4,"div",50),e.j41(3,"div",51)(4,"div",30)(5,"div",52)(6,"div",7)(7,"div",53)(8,"div",54)(9,"span",55),e.EFF(10,"Inversi\xf3n Total"),e.k0s(),e.nrm(11,"i",56),e.k0s(),e.j41(12,"h3",57),e.EFF(13),e.nI1(14,"currency"),e.k0s()()()(),e.j41(15,"div",52)(16,"div",7)(17,"div",53)(18,"div",54)(19,"span",55),e.EFF(20,"Total Productos"),e.k0s(),e.nrm(21,"i",58),e.k0s(),e.j41(22,"h3",59),e.EFF(23),e.k0s()()()(),e.j41(24,"div",52)(25,"div",7)(26,"div",53)(27,"div",54)(28,"span",55),e.EFF(29,"Total Unidades"),e.k0s(),e.nrm(30,"i",60),e.k0s(),e.j41(31,"h3",61),e.EFF(32),e.nI1(33,"number"),e.k0s()()()(),e.j41(34,"div",52)(35,"div",7)(36,"div",53)(37,"div",54)(38,"span",55),e.EFF(39,"Costo Promedio"),e.k0s(),e.nrm(40,"i",62),e.k0s(),e.j41(41,"h3",63),e.EFF(42),e.nI1(43,"currency"),e.k0s()()()()()(),e.DNE(44,U,12,4,"div",64),e.j41(45,"div",65)(46,"div",66)(47,"div",67)(48,"div",68)(49,"h5",69),e.EFF(50),e.DNE(51,X,2,0,"span",70),e.DNE(52,V,2,0,"span",71),e.DNE(53,J,2,1,"span",72),e.k0s(),e.DNE(54,Z,8,5,"div",73),e.DNE(55,Q,4,0,"div",73),e.k0s()(),e.j41(56,"div",74)(57,"div",75)(58,"table",76)(59,"thead",77)(60,"tr")(61,"th",78),e.EFF(62,"PRODUCTO"),e.k0s(),e.j41(63,"th",79),e.EFF(64," CATEGOR\xcdA "),e.k0s(),e.j41(65,"th",80),e.EFF(66," PROVEEDOR "),e.k0s(),e.j41(67,"th",81),e.EFF(68," STOCK ACTUAL "),e.k0s(),e.j41(69,"th",82),e.EFF(70," COSTO "),e.k0s(),e.j41(71,"th",81),e.EFF(72,"CONTADO"),e.k0s(),e.j41(73,"th",83),e.EFF(74,"TOTAL"),e.k0s()()(),e.j41(75,"tbody"),e.DNE(76,W,38,38,"tr",84),e.k0s()()()()()()()),2&i){const t=e.XpG();e.R7$(1),e.Y8G("ngIf","borrador"===t.inventarioActual.estado),e.R7$(1),e.Y8G("ngIf","finalizado"===t.inventarioActual.estado),e.R7$(11),e.SpI(" ",e.ii3(14,16,t.inventarioActual.inversionTotal,"EUR","symbol","1.0-0")," "),e.R7$(10),e.SpI(" ",t.inventarioActual.totalProductos," "),e.R7$(9),e.SpI(" ",e.i5U(33,21,t.inventarioActual.totalUnidades,"1.1-1")," "),e.R7$(10),e.SpI(" ",e.ii3(43,24,t.inventarioActual.costoPromedio,"EUR","symbol","1.0-0")," "),e.R7$(2),e.Y8G("ngIf",t.familiasDisponibles.length>0),e.R7$(6),e.Lme(" Productos del Inventario (",t.productosFiltrados.length," de ",t.inventarioActual.productos.length,") "),e.R7$(1),e.Y8G("ngIf","borrador"===t.inventarioActual.estado),e.R7$(1),e.Y8G("ngIf","finalizado"===t.inventarioActual.estado),e.R7$(1),e.Y8G("ngIf",t.familiaSeleccionada),e.R7$(1),e.Y8G("ngIf","borrador"===t.inventarioActual.estado),e.R7$(1),e.Y8G("ngIf","finalizado"===t.inventarioActual.estado),e.R7$(21),e.Y8G("ngForOf",t.productosFiltrados)("ngForTrackBy",t.trackByProducto)}}function ee(i,l){1&i&&(e.j41(0,"div",43)(1,"div",133)(2,"span",134),e.EFF(3,"Cargando..."),e.k0s()(),e.j41(4,"h4",46),e.EFF(5,"Creando inventario..."),e.k0s(),e.j41(6,"p",97),e.EFF(7," Cargando productos y preparando el inventario para la fecha seleccionada "),e.k0s()())}function te(i,l){if(1&i&&(e.j41(0,"div",142)(1,"small",143),e.EFF(2),e.k0s()()),2&i){const t=e.XpG().$implicit,n=e.XpG();e.R7$(2),e.Lme(" ",t.familias.length," familias: ",n.getFamiliasNombres(t.familias)," ")}}function ne(i,l){if(1&i){const t=e.RV6();e.j41(0,"div",135)(1,"div",136),e.bIt("click",function(){const o=e.eBV(t).$implicit,c=e.XpG();return e.Njj(c.seleccionarCategoria(o.id||""))}),e.j41(2,"div",8)(3,"div",101)(4,"div",137),e.nrm(5,"i"),e.k0s(),e.j41(6,"div",87)(7,"h6",138),e.EFF(8),e.k0s(),e.j41(9,"small",97),e.EFF(10),e.k0s(),e.DNE(11,te,3,2,"div",139),e.k0s(),e.j41(12,"div",140),e.nrm(13,"i",141),e.k0s()()()()()}if(2&i){const t=l.$implicit,n=e.XpG();e.R7$(1),e.AVh("selected",n.categoriaSeleccionada===t.id),e.R7$(3),e.xc7("background-color",t.colorFondo),e.R7$(1),e.HbH("bi "+t.icono+" text-white"),e.R7$(3),e.JRh(t.nombre),e.R7$(2),e.SpI("",n.getTotalProductosCategoria(t.id)," productos"),e.R7$(1),e.Y8G("ngIf",t.familias&&t.familias.length>0),e.R7$(2),e.HbH(n.categoriaSeleccionada===t.id?"bi-check-circle-fill text-success":"bi-circle text-muted")}}function ie(i,l){if(1&i&&(e.j41(0,"span",152),e.EFF(1),e.k0s()),2&i){const t=l.$implicit,n=e.XpG(3);e.R7$(1),e.Lme(" ",t.nombre," (",n.getProductosPorFamiliaEnCategoria(t.id||"").length," productos) ")}}function ae(i,l){if(1&i&&(e.j41(0,"div",149)(1,"h6",146),e.EFF(2,"Familias incluidas:"),e.k0s(),e.j41(3,"div",150),e.DNE(4,ie,2,2,"span",151),e.k0s()()),2&i){const t=e.XpG(2);e.R7$(4),e.Y8G("ngForOf",t.getFamiliasCategoria())}}function oe(i,l){if(1&i&&(e.j41(0,"div",144)(1,"div",145)(2,"h6",146),e.nrm(3,"i",147),e.EFF(4," Categor\xeda seleccionada: "),e.j41(5,"strong"),e.EFF(6),e.k0s()(),e.j41(7,"p",146),e.EFF(8," Se incluir\xe1n "),e.j41(9,"strong"),e.EFF(10),e.k0s(),e.EFF(11," productos de esta categor\xeda en el inventario. "),e.k0s(),e.DNE(12,ae,5,1,"div",148),e.k0s()()),2&i){const t=e.XpG();e.R7$(6),e.JRh(t.getNombreCategoriaSeleccionada()),e.R7$(4),e.JRh(t.getTotalProductosCategoria()),e.R7$(2),e.Y8G("ngIf",t.getFamiliasCategoria().length>0)}}function re(i,l){1&i&&e.nrm(0,"span",41)}function ce(i,l){1&i&&e.nrm(0,"i",153)}const le=[{path:"",component:(()=>{class i{constructor(t,n){this.firestore=t,this.authService=n,this.isLoading=!1,this.isCreatingInventory=!1,this.isSaving=!1,this.inventarioActual=null,this.productos=[],this.categorias=[],this.proveedores=[],this.fechaSeleccionada=new Date,this.fechaFiltro=new g.MJ((new Date).toISOString().split("T")[0]),this.categoriaFiltro=new g.MJ(""),this.proveedorFiltro=new g.MJ(""),this.categoriaSeleccionada="",this.familiasDisponibles=[],this.familiaSeleccionada="",this.productosFiltrados=[],this.subscriptions=new w.yU}convertirFecha(t){if(t){if(t instanceof Date)return t;if("object"==typeof t&&"toDate"in t)return t.toDate();if("string"==typeof t)return new Date(t)}}limpiarObjetoParaFirebase(t){const n={};for(const[a,o]of Object.entries(t))null!=o&&(n[a]=Array.isArray(o)?o.map(c=>"object"==typeof c?this.limpiarObjetoParaFirebase(c):c):"object"==typeof o&&null!==o?this.limpiarObjetoParaFirebase(o):o);return n}ngOnInit(){this.authService.getCurrentUser()?(this.cargarDatosIniciales(),this.setupFiltros(),this.buscarInventario()):d().fire("Error","Usuario no autenticado","error")}ngOnDestroy(){this.subscriptions.unsubscribe()}setupFiltros(){this.subscriptions.add(this.fechaFiltro.valueChanges.subscribe(t=>{if(t)try{this.fechaSeleccionada=new Date(t)}catch{this.fechaSeleccionada=new Date}}))}cargarDatosIniciales(){var t=this;return(0,b.A)(function*(){try{const n=(0,s.rJ)(t.firestore,"productos");t.subscriptions.add((0,s.xs)(n,{idField:"id"}).subscribe({next:c=>{t.productos=c.filter(u=>!u.esCombinado)},error:c=>{d().fire("Error","Error al cargar productos","error")}}));const a=(0,s.rJ)(t.firestore,"categorias");t.subscriptions.add((0,s.xs)(a,{idField:"id"}).subscribe({next:c=>{t.categorias=c,t.inventarioActual&&(t.configurarFamiliasDisponibles(),t.aplicarFiltroFamilia())},error:c=>{d().fire("Error","Error al cargar categor\xedas","error")}}));const o=(0,s.rJ)(t.firestore,"proveedores");t.subscriptions.add((0,s.xs)(o,{idField:"id"}).subscribe({next:c=>{t.proveedores=c},error:c=>{d().fire("Error","Error al cargar proveedores","error")}}))}catch{d().fire("Error","Error al cargar los datos iniciales","error")}})()}buscarInventario(){var t=this;return(0,b.A)(function*(){t.isLoading=!0;try{const n=t.fechaSeleccionada.toISOString().split("T")[0],a=(0,s.rJ)(t.firestore,"inventarios"),o=(0,s.P)(a,(0,s._M)("fecha","==",n)),c=yield(0,s.GG)(o);if(c.empty)t.inventarioActual=null;else{const u=c.docs.filter(f=>!f.data().eliminado);if(u.length>0){const f=u.filter(_=>"borrador"===_.data().estado),p=f.length>0?f[0]:u[0];t.inventarioActual={id:p.id,...p.data()},t.inventarioActual.fecha=t.convertirFecha(t.inventarioActual.fecha)||t.inventarioActual.fecha,t.inventarioActual.fechaActualizacion=t.convertirFecha(t.inventarioActual.fechaActualizacion),t.inventarioActual.fechaCreacion=t.convertirFecha(t.inventarioActual.fechaCreacion),"borrador"===t.inventarioActual.estado&&setTimeout(()=>{const C=t.categorias.find(F=>F.id===t.inventarioActual?.categoriaId)?.nombre||"Sin categor\xeda";d().fire({title:"Inventario en borrador encontrado",text:`Se ha cargado un inventario en borrador de ${C} para esta fecha. Puedes continuar edit\xe1ndolo.`,icon:"info",confirmButtonText:"Continuar",timer:3e3,timerProgressBar:!0})},1e3)}else t.inventarioActual=null}t.inventarioActual&&(t.configurarFamiliasDisponibles(),t.aplicarFiltroFamilia())}catch{t.inventarioActual=null}finally{t.isLoading=!1}})()}crearNuevoInventario(){var t=this;return(0,b.A)(function*(){if(!t.inventarioActual||(yield d().fire({title:"\xbfCrear nuevo inventario?",text:"Ya existe un inventario para esta fecha. \xbfDeseas reemplazarlo?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#dc3545",cancelButtonColor:"#6c757d",confirmButtonText:"S\xed, crear nuevo",cancelButtonText:"Cancelar"})).isConfirmed){t.isCreatingInventory=!0;try{let n=[...t.productos];const a=t.categoriaFiltro.value,o=t.proveedorFiltro.value;a&&(n=n.filter(r=>r.categoriaId===a)),o&&(n=n.filter(r=>r.proveedorId===o));const c=n.map(r=>{const v=t.categorias.find(P=>P.id===r.categoriaId),M=t.proveedores.find(P=>P.id===r.proveedorId);return{productoId:r.id,nombre:r.nombre,categoria:v?.nombre||"Sin categor\xeda",proveedor:M?.nombre||"Sin proveedor",stockActual:r.stock||0,stockContado:r.stock||0,costoUnitario:r.costo,valorTotal:(r.stock||0)*r.costo,unidadMedida:r.unidadMedida,diferencia:0}}),u=c.reduce((r,v)=>r+v.valorTotal,0),f=c.length,p=c.reduce((r,v)=>r+v.stockContado,0),_=p>0?u/p:0,C={fecha:t.fechaSeleccionada.toISOString().split("T")[0],categoriaId:a||void 0,proveedorId:o||void 0,productos:c,inversionTotal:u,totalProductos:f,totalUnidades:p,costoPromedio:_,fechaCreacion:(0,s.O5)(),usuarioId:t.authService.getCurrentUser()?.id,estado:"borrador"},F=t.limpiarObjetoParaFirebase(C),x=(0,s.rJ)(t.firestore,"inventarios"),I=yield(0,s.gS)(x,F);t.inventarioActual={id:I.id,fecha:t.fechaSeleccionada,categoriaId:a||void 0,proveedorId:o||void 0,productos:c,inversionTotal:u,totalProductos:f,totalUnidades:p,costoPromedio:_,fechaCreacion:new Date,usuarioId:t.authService.getCurrentUser()?.id,estado:"borrador"},d().fire("\xa1Creado!","Inventario creado como borrador. Puedes editarlo y luego finalizarlo.","success")}catch{d().fire("Error","Error al crear el inventario","error")}finally{t.isCreatingInventory=!1}}})()}recalcularTotales(){this.inventarioActual&&(this.inventarioActual.inversionTotal=this.inventarioActual.productos.reduce((t,n)=>t+n.valorTotal,0),this.inventarioActual.totalUnidades=this.inventarioActual.productos.reduce((t,n)=>t+n.stockContado,0),this.inventarioActual.costoPromedio=this.inventarioActual.totalUnidades>0?this.inventarioActual.inversionTotal/this.inventarioActual.totalUnidades:0)}guardarInventario(){var t=this;return(0,b.A)(function*(){if(t.inventarioActual&&("borrador"!==t.inventarioActual.estado||(yield d().fire({title:"\xbfFinalizar inventario?",text:"Una vez finalizado, no podr\xe1s editarlo. \xbfEst\xe1s seguro?",icon:"question",showCancelButton:!0,confirmButtonColor:"#dc3545",cancelButtonColor:"#6c757d",confirmButtonText:"S\xed, finalizar",cancelButtonText:"Cancelar"})).isConfirmed)){t.isSaving=!0;try{const n={...t.inventarioActual,fecha:t.fechaSeleccionada.toISOString().split("T")[0],fechaActualizacion:(0,s.O5)(),estado:"finalizado"},a=t.limpiarObjetoParaFirebase(n);if(t.inventarioActual.id){const o=(0,s.H9)(t.firestore,"inventarios",t.inventarioActual.id);yield(0,s.mZ)(o,a),t.inventarioActual.estado="finalizado",t.inventarioActual.fechaActualizacion=new Date}else{const o=(0,s.rJ)(t.firestore,"inventarios"),c=yield(0,s.gS)(o,a);t.inventarioActual.id=c.id,t.inventarioActual.estado="finalizado"}d().fire("\xa1Finalizado!","Inventario finalizado exitosamente","success")}catch{d().fire("Error","Error al finalizar el inventario","error")}finally{t.isSaving=!1}}})()}getStockClass(t){return t<=0?"text-danger fw-bold":t<=5?"text-warning fw-bold":"text-success fw-bold"}trackByProducto(t,n){return n.productoId}trackByFamilia(t,n){return n.id||n.nombre}cancelarInventario(){var t=this;return(0,b.A)(function*(){if(t.inventarioActual?.id){if((yield d().fire({title:"\xbfCancelar inventario?",text:"Se eliminar\xe1 completamente el inventario en borrador. Esta acci\xf3n no se puede deshacer.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#dc3545",cancelButtonColor:"#6c757d",confirmButtonText:"S\xed, eliminar",cancelButtonText:"No cancelar"})).isConfirmed){t.isSaving=!0;try{const a=(0,s.H9)(t.firestore,"inventarios",t.inventarioActual.id);yield(0,s.kd)(a),t.inventarioActual=null,t.familiasDisponibles=[],t.familiaSeleccionada="",t.productosFiltrados=[],d().fire({title:"\xa1Eliminado!",text:"El inventario ha sido eliminado completamente",icon:"success",timer:2e3,timerProgressBar:!0})}catch{d().fire("Error","Error al eliminar el inventario","error")}finally{t.isSaving=!1}}}else d().fire("Error","No hay inventario para cancelar","error")})()}calcularValorTotal(t){"finalizado"!==this.inventarioActual?.estado&&(t.diferencia=t.stockContado-t.stockActual,t.valorTotal=t.stockContado*t.costoUnitario,this.recalcularTotales(),"borrador"===this.inventarioActual?.estado&&this.autoGuardarBorrador())}autoGuardarBorrador(){this.autoSaveTimeout&&clearTimeout(this.autoSaveTimeout),this.autoSaveTimeout=setTimeout(()=>{this.guardarBorrador()},2e3)}guardarBorrador(){var t=this;return(0,b.A)(function*(){if(t.inventarioActual?.id&&"borrador"===t.inventarioActual.estado)try{const n=(0,s.H9)(t.firestore,"inventarios",t.inventarioActual.id);yield(0,s.mZ)(n,{productos:t.inventarioActual.productos,inversionTotal:t.inventarioActual.inversionTotal,totalUnidades:t.inventarioActual.totalUnidades,costoPromedio:t.inventarioActual.costoPromedio,fechaActualizacion:(0,s.O5)()})}catch{}})()}abrirModalNuevoInventario(){this.categoriaSeleccionada="";const t=document.getElementById("modalNuevoInventario");t&&(this.modal=new bootstrap.Modal(t),this.modal.show())}cerrarModalNuevoInventario(){this.modal&&this.modal.hide(),this.categoriaSeleccionada=""}seleccionarCategoria(t){this.categoriaSeleccionada=t}getNombreCategoriaSeleccionada(){return this.categorias.find(n=>n.id===this.categoriaSeleccionada)?.nombre||""}getTotalProductosCategoria(t){const n=t||this.categoriaSeleccionada;return n?this.productos.filter(a=>a.categoriaId===n&&!a.esCombinado).length:0}getFamiliasCategoria(){return this.categorias.find(n=>n.id===this.categoriaSeleccionada)?.familias||[]}getProductosPorFamiliaEnCategoria(t){return this.productos.filter(n=>n.categoriaId===this.categoriaSeleccionada&&n.familiaId===t&&!n.esCombinado)}getFamiliasNombres(t){return t&&0!==t.length?t.map(n=>n.nombre).join(", "):""}crearInventarioConSeleccion(){var t=this;return(0,b.A)(function*(){if(t.categoriaSeleccionada)if(0!==t.productos.length)if(0!==t.categorias.length){if(t.inventarioActual){const a="borrador"===t.inventarioActual.estado?"en borrador":"finalizado";if(!(yield d().fire({title:"\xbfCrear nuevo inventario?",text:`Ya existe un inventario ${a} para esta fecha. \xbfDeseas reemplazarlo?`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#dc3545",cancelButtonColor:"#6c757d",confirmButtonText:"S\xed, reemplazar",cancelButtonText:"Cancelar"})).isConfirmed)return;if(t.inventarioActual.id)try{const c=(0,s.H9)(t.firestore,"inventarios",t.inventarioActual.id);yield(0,s.kd)(c)}catch(c){console.error("Error eliminando inventario anterior:",c)}}t.isCreatingInventory=!0;try{const n=t.authService.getCurrentUser();if(!n?.id)return void d().fire("Error","Usuario no autenticado","error");const a=t.productos.filter(r=>r.categoriaId===t.categoriaSeleccionada&&!r.esCombinado);if(0===a.length)return void d().fire("Error","No hay productos disponibles en la categor\xeda seleccionada.","error");const o=a.map(r=>{const v=t.categorias.find(O=>O.id===r.categoriaId),M=t.proveedores.find(O=>O.id===r.proveedorId),P={productoId:r.id||"",nombre:r.nombre||"",categoria:v?.nombre||"Sin categor\xeda",proveedor:M?.nombre||"Sin proveedor",stockActual:r.stock||0,stockContado:r.stock||0,costoUnitario:r.costo||0,valorTotal:(r.stock||0)*(r.costo||0),unidadMedida:r.unidadMedida||"",diferencia:0};return r.familiaId&&(P.familiaId=r.familiaId),P}),c=o.reduce((r,v)=>r+v.valorTotal,0),u=o.length,f=o.reduce((r,v)=>r+v.stockContado,0),p=f>0?c/f:0,_={fecha:t.fechaSeleccionada.toISOString().split("T")[0],categoriaId:t.categoriaSeleccionada||"",productos:o,inversionTotal:c||0,totalProductos:u||0,totalUnidades:f||0,costoPromedio:p||0,fechaCreacion:(0,s.O5)(),usuarioId:n.id||"",estado:"borrador"},C=t.limpiarObjetoParaFirebase(_),F=(0,s.rJ)(t.firestore,"inventarios"),x=yield(0,s.gS)(F,C);t.inventarioActual={id:x.id,fecha:t.fechaSeleccionada,categoriaId:t.categoriaSeleccionada,productos:o,inversionTotal:c,totalProductos:u,totalUnidades:f,costoPromedio:p,fechaCreacion:new Date,usuarioId:n.id,estado:"borrador"},t.configurarFamiliasDisponibles(),t.aplicarFiltroFamilia(),t.cerrarModalNuevoInventario();const I=t.getNombreCategoriaSeleccionada();d().fire("\xa1Creado!",`Inventario de ${I} creado con ${u} productos. Puedes editarlo y luego finalizarlo.`,"success")}catch(n){let a="Error al crear el inventario";n?.message&&(a+=": "+n.message),d().fire("Error",a,"error")}finally{t.isCreatingInventory=!1}}else d().fire("Error","No se han cargado las categor\xedas. Intenta recargar la p\xe1gina.","error");else d().fire("Error","No se han cargado los productos. Intenta recargar la p\xe1gina.","error");else d().fire("Error","Selecciona una categor\xeda para el inventario","error")})()}configurarFamiliasDisponibles(){if(!this.inventarioActual)return;const t=new Set,n=new Map,a=this.categorias.find(o=>o.id===this.inventarioActual?.categoriaId);a?.familias&&a.familias.forEach(o=>{o.id&&!t.has(o.id)&&(t.add(o.id),n.set(o.id,o))}),this.familiasDisponibles=Array.from(n.values())}filtrarPorFamilia(t){this.familiaSeleccionada=t,this.aplicarFiltroFamilia()}aplicarFiltroFamilia(){this.inventarioActual&&(this.productosFiltrados=this.familiaSeleccionada?this.inventarioActual.productos.filter(t=>this.productos.find(a=>a.id===t.productoId)?.familiaId===this.familiaSeleccionada):[...this.inventarioActual.productos])}getProductosPorFamilia(t){return this.inventarioActual?this.inventarioActual.productos.filter(n=>this.productos.find(o=>o.id===n.productoId)?.familiaId===t):[]}getNombreFamiliaSeleccionada(){return this.familiasDisponibles.find(n=>n.id===this.familiaSeleccionada)?.nombre||""}static{this.\u0275fac=function(n){return new(n||i)(e.rXU(s._7),e.rXU(R.u))}}static{this.\u0275cmp=e.VBU({type:i,selectors:[["app-inventario-page"]],decls:67,vars:23,consts:[[1,"container-fluid"],[1,"row","mb-4"],[1,"col-8"],[1,"col","text-end"],[1,"btn","btn-danger",3,"disabled","click"],[1,"bi","bi-plus-lg","me-2"],[1,"col"],[1,"card","border-0","shadow-sm"],[1,"card-body"],[1,"row","align-items-center"],[1,"col-12","col-md-3","mb-2","mb-md-0"],[1,"form-label","small","text-muted"],["type","date",1,"form-control",3,"formControl","value"],[1,"form-select",3,"formControl"],["value",""],[3,"value",4,"ngFor","ngForOf"],[1,"col-12","col-md-3","text-end","mt-4"],[1,"btn","btn-outline-danger","w-100",3,"disabled","click"],["class","spinner-border spinner-border-sm me-2",4,"ngIf"],["class","bi bi-search me-2",4,"ngIf"],["class","text-center py-5",4,"ngIf"],["class","h-100 d-flex flex-column",4,"ngIf"],["id","modalNuevoInventario","tabindex","-1","data-bs-backdrop","static",1,"modal","fade"],[1,"modal-dialog","modal-lg"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],[1,"bi","bi-clipboard-check","me-2"],["type","button",1,"btn-close",3,"click"],[1,"modal-body"],[1,"row"],[1,"col-12","mb-4"],[1,"mb-3"],[1,"bi","bi-tags","me-2"],["class","col-md-6 mb-3",4,"ngFor","ngForOf"],["class","col-12",4,"ngIf"],[1,"modal-footer"],["type","button",1,"btn","btn-secondary",3,"click"],["type","button",1,"btn","btn-danger",3,"disabled","click"],["class","bi bi-plus me-2",4,"ngIf"],[3,"value"],[1,"spinner-border","spinner-border-sm","me-2"],[1,"bi","bi-search","me-2"],[1,"text-center","py-5"],[1,"mb-4"],[1,"bi","bi-archive","text-muted",2,"font-size","4rem"],[1,"text-muted","mb-3"],[1,"text-muted","mb-4"],[1,"h-100","d-flex","flex-column"],["class","alert alert-warning d-flex align-items-center mb-3","role","alert",4,"ngIf"],["class","d-flex justify-content-between align-items-center mb-3",4,"ngIf"],[1,"inventario-stats"],[1,"col-12","col-md-3","mb-3"],[1,"card-body","text-center"],[1,"d-flex","justify-content-between","align-items-center","mb-2"],[1,"text-muted","small"],[1,"bi","bi-currency-euro","text-danger"],[1,"text-danger","fw-bold","mb-0"],[1,"bi","bi-box","text-info"],[1,"text-info","fw-bold","mb-0"],[1,"bi","bi-graph-up","text-success"],[1,"text-success","fw-bold","mb-0"],[1,"bi","bi-calculator","text-warning"],[1,"text-warning","fw-bold","mb-0"],["class","row mb-3",4,"ngIf"],[1,"inventario-table-container"],[1,"card","border-0","shadow-sm","h-100","d-flex","flex-column"],[1,"card-header","bg-white","border-0","py-3","flex-shrink-0"],[1,"d-flex","justify-content-between","align-items-center"],[1,"mb-0"],["class","badge bg-warning ms-2",4,"ngIf"],["class","badge bg-success ms-2",4,"ngIf"],["class","badge bg-info ms-2",4,"ngIf"],[4,"ngIf"],[1,"inventario-table-wrapper"],[1,"table-responsive","table-responsive-sm","h-100"],[1,"table","table-hover","table-striped","table-sm","mb-0"],[1,"table-dark","sticky-top"],["scope","col",1,"text-nowrap"],["scope","col",1,"text-nowrap","d-none","d-md-table-cell"],["scope","col",1,"text-nowrap","d-none","d-lg-table-cell"],["scope","col",1,"text-nowrap","text-center"],["scope","col",1,"text-nowrap","d-none","d-sm-table-cell","text-end"],["scope","col",1,"text-nowrap","text-end"],[4,"ngFor","ngForOf","ngForTrackBy"],["role","alert",1,"alert","alert-warning","d-flex","align-items-center","mb-3"],[1,"bi","bi-exclamation-triangle-fill","me-2"],[1,"flex-grow-1"],[1,"ms-3"],[1,"btn","btn-outline-secondary","btn-sm","me-2",3,"disabled","click"],[1,"bi","bi-x-lg","me-1"],[1,"btn","btn-warning","btn-sm",3,"disabled","click"],["class","bi bi-save me-1",4,"ngIf"],[1,"bi","bi-save","me-1"],[1,"d-flex","justify-content-between","align-items-center","mb-3"],[1,"badge","bg-success","fs-6"],[1,"bi","bi-check-circle","me-1"],[1,"text-muted"],[1,"row","mb-3"],[1,"col-12","col-md-6"],[1,"card-body","py-2"],[1,"d-flex","align-items-center"],[1,"form-label","small","text-muted","mb-0","me-3"],[1,"bi","bi-funnel","me-1"],[1,"form-select","form-select-sm",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf","ngForTrackBy"],[1,"badge","bg-warning","ms-2"],[1,"badge","bg-success","ms-2"],[1,"badge","bg-info","ms-2"],[1,"btn","btn-danger","btn-sm",3,"disabled","click"],["class","bi bi-save me-2",4,"ngIf"],[1,"bi","bi-save","me-2"],[1,"bi","bi-lock","me-1"],[1,"align-middle"],[1,"d-block"],[1,"text-muted","d-block"],[1,"d-md-none","mt-1"],[1,"badge","bg-primary","rounded-pill","me-1"],[1,"text-muted","d-lg-none","d-block","mt-1"],[1,"align-middle","d-none","d-md-table-cell"],[1,"badge","bg-primary","rounded-pill"],[1,"align-middle","d-none","d-lg-table-cell"],[1,"text-truncate",2,"max-width","120px",3,"title"],[1,"align-middle","text-center"],[1,"fw-bold"],[1,"d-sm-none"],[1,"align-middle","text-end","d-none","d-sm-table-cell"],[1,"text-nowrap"],[1,"d-flex","flex-column","align-items-center"],["type","number","step","0.1","min","0",1,"form-control","form-control-sm","text-center",2,"width","80px","max-width","100%",3,"ngModel","disabled","ngModelChange"],["class","fw-bold mt-1",3,"class",4,"ngIf"],[1,"align-middle","text-end"],[1,"fw-bold","mt-1"],["role","status",1,"spinner-border","text-danger","mb-3"],[1,"visually-hidden"],[1,"col-md-6","mb-3"],[1,"card","h-100","cursor-pointer","categoria-card",3,"click"],[1,"rounded-circle","p-2","me-3"],[1,"mb-1"],["class","mt-1",4,"ngIf"],[1,"ms-2"],[1,"bi","fs-5"],[1,"mt-1"],[1,"text-info"],[1,"col-12"],[1,"alert","alert-success"],[1,"mb-2"],[1,"bi","bi-check-circle","me-2"],["class","mt-3",4,"ngIf"],[1,"mt-3"],[1,"d-flex","flex-wrap","gap-2"],["class","badge bg-primary","style","font-size: 0.85rem; padding: 6px 12px",4,"ngFor","ngForOf"],[1,"badge","bg-primary",2,"font-size","0.85rem","padding","6px 12px"],[1,"bi","bi-plus","me-2"]],template:function(n,a){1&n&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3"),e.EFF(4,"Gesti\xf3n de Inventario"),e.k0s(),e.j41(5,"span"),e.EFF(6,"Control y conteo de stock por fechas"),e.k0s()(),e.j41(7,"div",3)(8,"button",4),e.bIt("click",function(){return a.abrirModalNuevoInventario()}),e.nrm(9,"i",5),e.EFF(10," Nuevo Inventario "),e.k0s()()(),e.j41(11,"div",1)(12,"div",6)(13,"div",7)(14,"div",8)(15,"div",9)(16,"div",10)(17,"label",11),e.EFF(18,"Fecha del Inventario"),e.k0s(),e.nrm(19,"input",12),e.nI1(20,"date"),e.k0s(),e.j41(21,"div",10)(22,"label",11),e.EFF(23,"Categor\xeda"),e.k0s(),e.j41(24,"select",13)(25,"option",14),e.EFF(26,"Todas las categor\xedas"),e.k0s(),e.DNE(27,j,2,2,"option",15),e.k0s()(),e.j41(28,"div",10)(29,"label",11),e.EFF(30,"Proveedor"),e.k0s(),e.j41(31,"select",13)(32,"option",14),e.EFF(33,"Todos los proveedores"),e.k0s(),e.DNE(34,A,2,2,"option",15),e.k0s()(),e.j41(35,"div",16)(36,"button",17),e.bIt("click",function(){return a.buscarInventario()}),e.DNE(37,T,1,0,"span",18),e.DNE(38,$,1,0,"i",19),e.EFF(39),e.k0s()()()()()()(),e.DNE(40,G,7,0,"div",20),e.DNE(41,q,77,29,"div",21),e.DNE(42,ee,8,0,"div",20),e.k0s(),e.j41(43,"div",22)(44,"div",23)(45,"div",24)(46,"div",25)(47,"h5",26),e.nrm(48,"i",27),e.EFF(49," Crear Nuevo Inventario "),e.k0s(),e.j41(50,"button",28),e.bIt("click",function(){return a.cerrarModalNuevoInventario()}),e.k0s()(),e.j41(51,"div",29)(52,"div",30)(53,"div",31)(54,"h6",32),e.nrm(55,"i",33),e.EFF(56," Selecciona la categor\xeda para el inventario: "),e.k0s(),e.j41(57,"div",30),e.DNE(58,ne,14,11,"div",34),e.k0s()(),e.DNE(59,oe,13,3,"div",35),e.k0s()(),e.j41(60,"div",36)(61,"button",37),e.bIt("click",function(){return a.cerrarModalNuevoInventario()}),e.EFF(62," Cancelar "),e.k0s(),e.j41(63,"button",38),e.bIt("click",function(){return a.crearInventarioConSeleccion()}),e.DNE(64,re,1,0,"span",18),e.DNE(65,ce,1,0,"i",39),e.EFF(66),e.k0s()()()()()),2&n&&(e.R7$(8),e.Y8G("disabled",a.isLoading),e.R7$(11),e.Y8G("formControl",a.fechaFiltro)("value",e.i5U(20,20,a.fechaSeleccionada,"yyyy-MM-dd")),e.R7$(5),e.Y8G("formControl",a.categoriaFiltro),e.R7$(3),e.Y8G("ngForOf",a.categorias),e.R7$(4),e.Y8G("formControl",a.proveedorFiltro),e.R7$(3),e.Y8G("ngForOf",a.proveedores),e.R7$(2),e.Y8G("disabled",a.isLoading),e.R7$(1),e.Y8G("ngIf",a.isLoading),e.R7$(1),e.Y8G("ngIf",!a.isLoading),e.R7$(1),e.SpI(" ",a.isLoading?"Buscando...":"Buscar"," "),e.R7$(1),e.Y8G("ngIf",!a.inventarioActual&&!a.isLoading),e.R7$(1),e.Y8G("ngIf",a.inventarioActual&&!a.isCreatingInventory),e.R7$(1),e.Y8G("ngIf",a.isCreatingInventory),e.R7$(16),e.Y8G("ngForOf",a.categorias),e.R7$(1),e.Y8G("ngIf",a.categoriaSeleccionada),e.R7$(4),e.Y8G("disabled",!a.categoriaSeleccionada||a.isCreatingInventory),e.R7$(1),e.Y8G("ngIf",a.isCreatingInventory),e.R7$(1),e.Y8G("ngIf",!a.isCreatingInventory),e.R7$(1),e.SpI(" ",a.isCreatingInventory?"Creando...":"Crear Inventario"," "))},dependencies:[h.Sq,h.bT,g.xH,g.y7,g.me,g.Q0,g.wz,g.BC,g.VZ,g.l_,g.vS,h.QX,h.oe,h.vh],styles:[".table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-size:.75rem;font-weight:600;text-transform:uppercase;letter-spacing:.5px;color:#6c757d;border-bottom:2px solid #dee2e6}.table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{vertical-align:middle;font-size:.875rem}.form-control-sm[_ngcontent-%COMP%]{font-size:.875rem}.badge[_ngcontent-%COMP%]{font-size:.75rem}.text-danger.fw-bold[_ngcontent-%COMP%]{color:#dc3545!important}.text-warning.fw-bold[_ngcontent-%COMP%]{color:#ffc107!important}.text-success.fw-bold[_ngcontent-%COMP%]{color:#198754!important}.card[_ngcontent-%COMP%]{transition:transform .2s ease-in-out}.card[_ngcontent-%COMP%]:hover{transform:translateY(-2px)}.spinner-border[_ngcontent-%COMP%]{width:2rem;height:2rem}@media (max-width: 768px){.inventario-layout[_ngcontent-%COMP%]{height:100vh}.inventario-header[_ngcontent-%COMP%]{padding:.75rem}.inventario-filters[_ngcontent-%COMP%], .inventario-content[_ngcontent-%COMP%]{padding:0 .75rem}.table-responsive[_ngcontent-%COMP%]{font-size:.8rem;border-radius:.5rem;box-shadow:0 2px 8px #0000001a}.form-control-sm[_ngcontent-%COMP%]{width:70px!important;font-size:.75rem}.table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-size:.65rem;padding:.5rem .25rem}.table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-size:.75rem;padding:.5rem .25rem}.card-header[_ngcontent-%COMP%]{padding:.75rem 1rem}.card-header[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{font-size:1rem}.card-header[_ngcontent-%COMP%]   .btn-sm[_ngcontent-%COMP%]{font-size:.75rem;padding:.25rem .5rem}}.is-invalid[_ngcontent-%COMP%]{border-color:#dc3545;box-shadow:0 0 0 .2rem #dc354540}input[type=number][_ngcontent-%COMP%]{text-align:center}input[type=number][_ngcontent-%COMP%]:focus{border-color:#dc3545;box-shadow:0 0 0 .2rem #dc354540}.bi-archive[_ngcontent-%COMP%]{opacity:.5}.btn-outline-danger[_ngcontent-%COMP%]:hover{background-color:#dc3545;border-color:#dc3545}.cursor-pointer[_ngcontent-%COMP%]{cursor:pointer}.area-card[_ngcontent-%COMP%], .categoria-card[_ngcontent-%COMP%]{transition:all .3s ease;border:2px solid transparent}.area-card[_ngcontent-%COMP%]:hover, .categoria-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 4px 12px #00000026}.area-card.selected[_ngcontent-%COMP%], .categoria-card.selected[_ngcontent-%COMP%]{border-color:var(--bs-primary);background-color:#0d6efd0d}.area-card.selected[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%], .categoria-card.selected[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]{background-color:transparent}.area-card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]{padding:2rem}.area-card[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{transition:transform .3s ease}.area-card[_ngcontent-%COMP%]:hover   i[_ngcontent-%COMP%]{transform:scale(1.1)}.categoria-card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]{padding:1rem}.btn-group[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{transition:all .2s ease}.btn-group[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:hover{transform:translateY(-1px)}@media (max-width: 768px){.area-card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]{padding:1.5rem}.btn-group[_ngcontent-%COMP%]{flex-wrap:wrap}.btn-group[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{margin-bottom:.5rem}}@media (max-width: 576px){.area-card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]{padding:1rem}.area-card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:2rem!important}.categoria-card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]{padding:.75rem}}.familia-pill[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;padding:.5rem 1rem;background:white;border:2px solid #e9ecef;border-radius:25px;cursor:pointer;transition:all .3s ease;white-space:nowrap;flex-shrink:0;min-height:40px;-webkit-user-select:none;user-select:none;box-shadow:0 2px 4px #0000000d}.familia-pill[_ngcontent-%COMP%]   .pill-text[_ngcontent-%COMP%]{font-size:.875rem;font-weight:500;color:#495057}.familia-pill[_ngcontent-%COMP%]   .pill-count[_ngcontent-%COMP%]{background:#6c757d;color:#fff;font-size:.75rem;font-weight:600;padding:.2rem .5rem;border-radius:12px;min-width:24px;text-align:center;line-height:1}.familia-pill[_ngcontent-%COMP%]:hover{background:#e9ecef;border-color:#adb5bd;transform:translateY(-1px);box-shadow:0 2px 8px #0000001a}.familia-pill.active[_ngcontent-%COMP%]{background:var(--bs-primary, #0d6efd);border-color:var(--bs-primary, #0d6efd);box-shadow:0 2px 12px #0d6efd4d}.familia-pill.active[_ngcontent-%COMP%]   .pill-text[_ngcontent-%COMP%]{color:#fff;font-weight:600}.familia-pill.active[_ngcontent-%COMP%]   .pill-count[_ngcontent-%COMP%]{background:rgba(255,255,255,.2);color:#fff;font-weight:700}.familia-pill.active[_ngcontent-%COMP%]:hover{transform:translateY(-1px);box-shadow:0 4px 16px #0d6efd66}.familia-pill[_ngcontent-%COMP%]:active{transform:scale(.98)}@media (max-width: 768px){.familia-pills-container[_ngcontent-%COMP%]:before, .familia-pills-container[_ngcontent-%COMP%]:after{width:15px}.familia-pills-scroll[_ngcontent-%COMP%]{padding:.5rem 0 .75rem}.familia-pills-scroll[_ngcontent-%COMP%]::-webkit-scrollbar{height:5px}.familia-pills-scroll[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:rgba(13,110,253,.5)}.familia-pill[_ngcontent-%COMP%]{padding:.4rem .8rem;min-height:36px}.familia-pill[_ngcontent-%COMP%]   .pill-text[_ngcontent-%COMP%]{font-size:.8rem}.familia-pill[_ngcontent-%COMP%]   .pill-count[_ngcontent-%COMP%]{font-size:.7rem;padding:.15rem .4rem;min-width:20px}}@media (max-width: 576px){.familia-pills-container[_ngcontent-%COMP%]:before, .familia-pills-container[_ngcontent-%COMP%]:after{width:12px}.familia-pills-scroll[_ngcontent-%COMP%]{gap:.5rem;padding:.4rem 0 .7rem}.familia-pills-scroll[_ngcontent-%COMP%]::-webkit-scrollbar{height:4px;display:block!important}.familia-pills-scroll[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:rgba(0,0,0,.15);margin:0 5px}.familia-pills-scroll[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:rgba(13,110,253,.7)}.familia-pills-scroll[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:active{background:rgba(13,110,253,.9)}.familia-pill[_ngcontent-%COMP%]{padding:.35rem .7rem;min-height:32px}.familia-pill[_ngcontent-%COMP%]   .pill-text[_ngcontent-%COMP%]{font-size:.75rem}.familia-pill[_ngcontent-%COMP%]   .pill-count[_ngcontent-%COMP%]{font-size:.65rem;padding:.1rem .35rem;min-width:18px}}.inventario-layout[_ngcontent-%COMP%]{height:100vh;display:flex;flex-direction:column;overflow:hidden}.inventario-header[_ngcontent-%COMP%]{flex-shrink:0;padding:1rem;background:white;border-bottom:1px solid #dee2e6}.inventario-filters[_ngcontent-%COMP%]{flex-shrink:0;padding:0 1rem;background:white}.inventario-content[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;overflow:hidden;padding:0 1rem}.inventario-stats[_ngcontent-%COMP%]{flex-shrink:0;padding:1rem 0}.inventario-pills[_ngcontent-%COMP%]{padding:.5rem 0;width:100%}.inventario-table-container[_ngcontent-%COMP%]{flex:1;overflow:hidden;display:flex;flex-direction:column}.inventario-table-wrapper[_ngcontent-%COMP%]{flex:1;overflow-y:auto;overflow-x:hidden}.inventario-table-wrapper[_ngcontent-%COMP%]   .table-responsive[_ngcontent-%COMP%]{height:100%;overflow-y:auto;overflow-x:auto}.container-fluid[_ngcontent-%COMP%]{padding:0!important}@media (min-width: 769px){.container-fluid[_ngcontent-%COMP%]{height:100vh;overflow:hidden}}*[_ngcontent-%COMP%]{-webkit-tap-highlight-color:transparent}@media (max-width: 576px){.inventario-layout[_ngcontent-%COMP%]{height:100vh}.inventario-header[_ngcontent-%COMP%]{padding:.5rem}.inventario-filters[_ngcontent-%COMP%], .inventario-content[_ngcontent-%COMP%]{padding:0 .5rem}.btn[_ngcontent-%COMP%]{touch-action:manipulation}h3[_ngcontent-%COMP%]{font-size:1.5rem;margin-bottom:.25rem}span[_ngcontent-%COMP%]{font-size:.875rem;color:#6c757d}.card-body[_ngcontent-%COMP%]{padding:.75rem}.form-label[_ngcontent-%COMP%]{font-size:.8rem;margin-bottom:.25rem}.form-control[_ngcontent-%COMP%], .form-select[_ngcontent-%COMP%]{font-size:.875rem;padding:.375rem .5rem}}input[type=number][_ngcontent-%COMP%]{-moz-appearance:textfield}input[type=number][_ngcontent-%COMP%]::-webkit-outer-spin-button, input[type=number][_ngcontent-%COMP%]::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}.familia-pill[_ngcontent-%COMP%]{-webkit-user-select:none;user-select:none}.familia-pill[_ngcontent-%COMP%]:focus{outline:2px solid var(--bs-primary, #0d6efd);outline-offset:2px}@media (max-width: 480px){.familia-pill[_ngcontent-%COMP%]{padding:.3rem .6rem;min-height:30px;gap:.4rem}.familia-pill[_ngcontent-%COMP%]   .pill-text[_ngcontent-%COMP%]{font-size:.7rem}.familia-pill[_ngcontent-%COMP%]   .pill-count[_ngcontent-%COMP%]{font-size:.6rem;padding:.1rem .3rem;min-width:16px}.container-fluid[_ngcontent-%COMP%]{padding-left:.75rem;padding-right:.75rem}}@media screen and (max-width: 768px){input[type=number][_ngcontent-%COMP%], input[type=date][_ngcontent-%COMP%], select[_ngcontent-%COMP%]{font-size:16px!important}}.familia-pills-scroll[_ngcontent-%COMP%]{-webkit-overflow-scrolling:touch;scroll-snap-type:x proximity}.familia-pills-scroll[_ngcontent-%COMP%]   .familia-pill[_ngcontent-%COMP%]{scroll-snap-align:start}.table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th.sticky-top[_ngcontent-%COMP%]{position:sticky;top:0;z-index:10;background:#212529!important;border-bottom:2px solid #dee2e6}.inventario-table-wrapper[_ngcontent-%COMP%]{position:relative}.inventario-table-wrapper[_ngcontent-%COMP%]   .table-responsive[_ngcontent-%COMP%]{border-radius:.375rem}@media (max-width: 576px){.table[_ngcontent-%COMP%]{font-size:.8rem}.table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.5rem .25rem;vertical-align:middle}.table[_ngcontent-%COMP%]   .form-control-sm[_ngcontent-%COMP%]{font-size:.8rem;padding:.25rem .5rem}}@media (max-width: 768px){.table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.6rem .4rem}}.table[_ngcontent-%COMP%]   .text-truncate[_ngcontent-%COMP%]{display:inline-block;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}@media (max-width: 576px){.table[_ngcontent-%COMP%]   input[type=number][_ngcontent-%COMP%]{width:70px!important;min-width:70px}}"]})}}return i})()}];let se=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275mod=e.$C({type:i})}static{this.\u0275inj=e.G2t({imports:[y.iI.forChild(le),y.iI]})}}return i})(),de=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275mod=e.$C({type:i})}static{this.\u0275inj=e.G2t({imports:[se,E.PrivateModule,h.MD,g.X1,g.YN]})}}return i})()}}]);