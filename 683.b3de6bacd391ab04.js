"use strict";(self.webpackChunkrigel=self.webpackChunkrigel||[]).push([[683],{3683:(At,y,v)=>{v.r(y),v.d(y,{InventarioPageModule:()=>Et});var A=v(7412),f=v(9417),C=v(177),E=v(5743),_=v(467),s=v(9173),j=v(8359),S=v(8032),l=v.n(S),t=v(7705),R=v(4441);function w(i,c){if(1&i&&(t.j41(0,"option",64),t.EFF(1),t.k0s()),2&i){const n=c.$implicit;t.Y8G("value",n.id),t.R7$(1),t.SpI(" ",n.nombre," ")}}function T(i,c){if(1&i&&(t.j41(0,"option",64),t.EFF(1),t.k0s()),2&i){const n=c.$implicit;t.Y8G("value",n.id),t.R7$(1),t.SpI(" ",n.nombre," ")}}function $(i,c){1&i&&t.nrm(0,"span",65)}function z(i,c){1&i&&t.nrm(0,"i",66)}function D(i,c){1&i&&(t.j41(0,"div",11)(1,"div",67)(2,"div",68)(3,"div",69),t.nrm(4,"i",70),t.k0s(),t.j41(5,"h4",71),t.EFF(6,"No hay inventario para esta fecha"),t.k0s(),t.j41(7,"p",72),t.EFF(8," Selecciona una fecha y crea un nuevo inventario o busca uno existente "),t.k0s()()()())}function G(i,c){1&i&&t.nrm(0,"span",65)}function N(i,c){1&i&&t.nrm(0,"i",114)}function B(i,c){if(1&i){const n=t.RV6();t.j41(0,"div",11)(1,"div",67)(2,"div",106),t.nrm(3,"i",107),t.j41(4,"div",108)(5,"strong"),t.EFF(6,"Inventario en borrador"),t.k0s(),t.EFF(7," - Este inventario no est\xe1 finalizado. Recuerda guardarlo o cancelarlo. "),t.k0s(),t.j41(8,"div",109)(9,"button",110),t.bIt("click",function(){t.eBV(n);const o=t.XpG(2);return t.Njj(o.cancelarInventario())}),t.nrm(10,"i",111),t.EFF(11," Cancelar "),t.k0s(),t.j41(12,"button",112),t.bIt("click",function(){t.eBV(n);const o=t.XpG(2);return t.Njj(o.guardarInventario())}),t.DNE(13,G,1,0,"span",24),t.DNE(14,N,1,0,"i",113),t.EFF(15),t.k0s()()()()()}if(2&i){const n=t.XpG(2);t.R7$(9),t.Y8G("disabled",n.isSaving),t.R7$(3),t.Y8G("disabled",n.isSaving),t.R7$(1),t.Y8G("ngIf",n.isSaving),t.R7$(1),t.Y8G("ngIf",!n.isSaving),t.R7$(1),t.SpI(" ",n.isSaving?"Guardando...":"Finalizar Inventario"," ")}}function Y(i,c){1&i&&t.nrm(0,"span",65)}function U(i,c){1&i&&t.nrm(0,"i",123)}function H(i,c){if(1&i){const n=t.RV6();t.j41(0,"div",115)(1,"div",67)(2,"div",116)(3,"div",117)(4,"span",118),t.nrm(5,"i",119),t.EFF(6," Inventario Finalizado "),t.k0s(),t.j41(7,"button",120),t.bIt("click",function(){t.eBV(n);const o=t.XpG(2);return t.Njj(o.actualizarProductosInventario())}),t.DNE(8,Y,1,0,"span",24),t.DNE(9,U,1,0,"i",121),t.EFF(10),t.k0s()(),t.j41(11,"small",122),t.EFF(12),t.nI1(13,"date"),t.k0s()()()()}if(2&i){const n=t.XpG(2);t.R7$(7),t.Y8G("disabled",n.isSaving),t.R7$(1),t.Y8G("ngIf",n.isSaving),t.R7$(1),t.Y8G("ngIf",!n.isSaving),t.R7$(1),t.SpI(" ",n.isSaving?"Actualizando...":"Actualizar Productos"," "),t.R7$(2),t.SpI(" Finalizado el ",t.i5U(13,5,n.inventarioActual.fechaActualizacion,"dd/MM/yyyy HH:mm")," ")}}function L(i,c){if(1&i){const n=t.RV6();t.j41(0,"div",126)(1,"div",127),t.bIt("click",function(){const r=t.eBV(n).$implicit,a=t.XpG(3);return t.Njj(a.filtrarPorFamilia(r.id||""))}),t.j41(2,"div",128)(3,"div",129)(4,"div",137),t.nrm(5,"i",138),t.k0s(),t.j41(6,"h6",132),t.EFF(7),t.k0s(),t.j41(8,"div",133)(9,"span",139),t.EFF(10),t.k0s(),t.j41(11,"small",122),t.EFF(12),t.k0s(),t.j41(13,"small",140),t.EFF(14),t.k0s()()()()()()}if(2&i){const n=c.$implicit,e=t.XpG(3);t.R7$(1),t.AVh("selected",e.familiaSeleccionada===n.id),t.R7$(6),t.JRh(n.nombre),t.R7$(3),t.SpI(" ",e.getProductosPorFamilia(n.id||"").length," productos "),t.R7$(2),t.SpI(" Sin contar: ",e.getProductosSinContarPorFamilia(n.id||"")," "),t.R7$(2),t.SpI(" COSTO FAMILIA: ",e.formatearMoneda(e.getCostoTotalPorFamilia(n.id||""))," ")}}function X(i,c){if(1&i){const n=t.RV6();t.j41(0,"div",115)(1,"div",67)(2,"h6",71),t.nrm(3,"i",124),t.EFF(4,"Filtrar por Familia "),t.k0s(),t.j41(5,"div",125)(6,"div",126)(7,"div",127),t.bIt("click",function(){t.eBV(n);const o=t.XpG(2);return t.Njj(o.filtrarPorFamilia(""))}),t.j41(8,"div",128)(9,"div",129)(10,"div",130),t.nrm(11,"i",131),t.k0s(),t.j41(12,"h6",132),t.EFF(13,"Todas las familias"),t.k0s(),t.j41(14,"div",133)(15,"span",134),t.EFF(16),t.k0s(),t.j41(17,"small",122),t.EFF(18),t.k0s(),t.j41(19,"small",135),t.EFF(20),t.k0s()()()()()(),t.DNE(21,L,15,6,"div",136),t.k0s()()()}if(2&i){const n=t.XpG(2);t.R7$(7),t.AVh("selected",""===n.familiaSeleccionada),t.R7$(9),t.SpI(" ",n.inventarioActual.productos.length," productos "),t.R7$(2),t.SpI(" Sin contar: ",n.getTotalProductosSinContar()," "),t.R7$(2),t.SpI(" COSTO TOTAL: ",n.formatearMoneda(n.getCostoTotalInventario())," "),t.R7$(1),t.Y8G("ngForOf",n.getFamiliasConProductos())("ngForTrackBy",n.trackByFamilia)}}function V(i,c){1&i&&(t.j41(0,"span",141),t.EFF(1,"Borrador"),t.k0s())}function q(i,c){1&i&&(t.j41(0,"span",142),t.EFF(1,"Finalizado"),t.k0s())}function J(i,c){if(1&i&&(t.j41(0,"span",143),t.EFF(1),t.k0s()),2&i){const n=t.XpG(2);t.R7$(1),t.JRh(n.getNombreFamiliaSeleccionada())}}function K(i,c){if(1&i&&(t.j41(0,"span",149),t.nrm(1,"i",150),t.EFF(2),t.k0s()),2&i){const n=t.XpG(3);t.R7$(2),t.SpI(' "',n.busquedaProducto,'" ')}}function Q(i,c){if(1&i&&(t.j41(0,"span",151),t.nrm(1,"i",152),t.EFF(2),t.k0s()),2&i){const n=t.XpG(3);t.R7$(2),t.SpI(" ",n.getNombreFamiliaSeleccionada()," ")}}function Z(i,c){if(1&i){const n=t.RV6();t.j41(0,"div",144)(1,"div",145)(2,"small",122),t.EFF(3,"Filtros activos:"),t.k0s(),t.DNE(4,K,3,1,"span",146),t.DNE(5,Q,3,1,"span",147),t.j41(6,"button",148),t.bIt("click",function(){t.eBV(n);const o=t.XpG(2);return t.Njj(o.limpiarTodosFiltros())}),t.j41(7,"small"),t.EFF(8,"Limpiar todos"),t.k0s()()()()}if(2&i){const n=t.XpG(2);t.R7$(4),t.Y8G("ngIf",n.busquedaProducto),t.R7$(1),t.Y8G("ngIf",n.familiaSeleccionada)}}function W(i,c){if(1&i&&(t.j41(0,"small"),t.EFF(1),t.nI1(2,"number"),t.k0s()),2&i){const n=t.XpG().$implicit;t.HbH(n.diferencia>0?"text-success":"text-danger"),t.R7$(1),t.Lme(" ",n.diferencia>0?"+":"","",t.i5U(2,4,n.diferencia,"1.1-1")," ")}}function tt(i,c){if(1&i){const n=t.RV6();t.j41(0,"tr")(1,"td")(2,"div")(3,"strong"),t.EFF(4),t.k0s(),t.nrm(5,"br"),t.j41(6,"small",122),t.EFF(7),t.k0s(),t.nrm(8,"br"),t.j41(9,"span",153),t.EFF(10),t.k0s(),t.nrm(11,"br"),t.j41(12,"small",154),t.EFF(13),t.k0s()()(),t.j41(14,"td")(15,"span"),t.EFF(16),t.nI1(17,"number"),t.k0s()(),t.j41(18,"td"),t.EFF(19),t.nI1(20,"currency"),t.k0s(),t.j41(21,"td")(22,"input",155),t.bIt("ngModelChange",function(o){const a=t.eBV(n).$implicit;return t.Njj(a.stockContado=o)})("ngModelChange",function(){const r=t.eBV(n).$implicit,a=t.XpG(2);return t.Njj(a.calcularValorTotal(r))}),t.k0s(),t.DNE(23,W,3,7,"small",156),t.k0s(),t.j41(24,"td")(25,"strong"),t.EFF(26),t.nI1(27,"currency"),t.k0s()()()}if(2&i){const n=c.$implicit,e=t.XpG(2);t.R7$(4),t.JRh(n.nombre),t.R7$(3),t.JRh(n.unidadMedida),t.R7$(3),t.JRh(n.categoria),t.R7$(3),t.JRh(n.proveedor),t.R7$(2),t.HbH(e.getStockClass(n.stockActual)),t.R7$(1),t.SpI(" ",t.i5U(17,16,n.stockActual,"1.1-1")," "),t.R7$(3),t.SpI(" ",t.ii3(20,19,n.costoUnitario,"EUR","symbol","1.2-2")," "),t.R7$(3),t.AVh("is-invalid",0!==n.diferencia),t.Y8G("ngModel",n.stockContado)("disabled","finalizado"===e.inventarioActual.estado),t.R7$(1),t.Y8G("ngIf",0!==n.diferencia),t.R7$(2),t.HbH(0!==n.diferencia?"text-danger":"text-success"),t.R7$(1),t.SpI(" ",t.ii3(27,24,n.valorTotal,"EUR","symbol","1.0-0")," ")}}function nt(i,c){if(1&i&&(t.j41(0,"small",171),t.EFF(1),t.nI1(2,"number"),t.k0s()),2&i){const n=t.XpG().$implicit;t.HbH(n.diferencia>0?"text-success":"text-danger"),t.R7$(1),t.Lme(" Diferencia: ",n.diferencia>0?"+":"","",t.i5U(2,4,n.diferencia,"1.1-1")," ")}}function et(i,c){if(1&i){const n=t.RV6();t.j41(0,"div",157)(1,"div",13)(2,"div",158)(3,"div",159)(4,"div",108)(5,"h6",132),t.EFF(6),t.k0s(),t.j41(7,"small",122),t.EFF(8),t.k0s()(),t.j41(9,"span",134),t.EFF(10),t.k0s()(),t.j41(11,"div",37)(12,"small",160),t.nrm(13,"i",161),t.EFF(14),t.k0s()(),t.j41(15,"div",162)(16,"div",163)(17,"div",164)(18,"small",165),t.EFF(19,"Stock Actual"),t.k0s(),t.j41(20,"span",166),t.EFF(21),t.nI1(22,"number"),t.k0s()()(),t.j41(23,"div",163)(24,"div",164)(25,"small",165),t.EFF(26,"Costo Unitario"),t.k0s(),t.j41(27,"span",166),t.EFF(28),t.nI1(29,"currency"),t.k0s()()()(),t.j41(30,"div",37)(31,"label",167),t.EFF(32,"Stock Contado"),t.k0s(),t.j41(33,"input",168),t.bIt("ngModelChange",function(o){const a=t.eBV(n).$implicit;return t.Njj(a.stockContado=o)})("ngModelChange",function(){const r=t.eBV(n).$implicit,a=t.XpG(2);return t.Njj(a.calcularValorTotal(r))}),t.k0s(),t.DNE(34,nt,3,7,"small",169),t.k0s(),t.j41(35,"div",116)(36,"span",122),t.EFF(37,"Valor Total:"),t.k0s(),t.j41(38,"strong",170),t.EFF(39),t.nI1(40,"currency"),t.k0s()()()()()}if(2&i){const n=c.$implicit,e=t.XpG(2);t.R7$(6),t.SpI(" ",n.nombre," "),t.R7$(2),t.JRh(n.unidadMedida),t.R7$(2),t.JRh(n.categoria),t.R7$(4),t.SpI("",n.proveedor," "),t.R7$(6),t.HbH(e.getStockClass(n.stockActual)),t.R7$(1),t.SpI(" ",t.i5U(22,16,n.stockActual,"1.1-1")," "),t.R7$(7),t.SpI(" ",t.ii3(29,19,n.costoUnitario,"EUR","symbol","1.2-2")," "),t.R7$(5),t.AVh("is-invalid",0!==n.diferencia),t.Y8G("ngModel",n.stockContado)("disabled","finalizado"===e.inventarioActual.estado),t.R7$(1),t.Y8G("ngIf",0!==n.diferencia),t.R7$(4),t.HbH(0!==n.diferencia?"text-danger":"text-success"),t.R7$(1),t.SpI(" ",t.ii3(40,24,n.valorTotal,"EUR","symbol","1.0-0")," ")}}function ot(i,c){if(1&i){const n=t.RV6();t.j41(0,"div"),t.DNE(1,B,16,5,"div",26),t.DNE(2,H,14,8,"div",73),t.j41(3,"div",11)(4,"div",74)(5,"div",13)(6,"div",75)(7,"div",76)(8,"span",77),t.EFF(9,"Inversi\xf3n Total"),t.k0s(),t.nrm(10,"i",78),t.k0s(),t.j41(11,"h3",79),t.EFF(12),t.nI1(13,"currency"),t.k0s()()()(),t.j41(14,"div",74)(15,"div",13)(16,"div",75)(17,"div",76)(18,"span",77),t.EFF(19,"Total Productos"),t.k0s(),t.nrm(20,"i",80),t.k0s(),t.j41(21,"h3",81),t.EFF(22),t.k0s()()()(),t.j41(23,"div",74)(24,"div",13)(25,"div",75)(26,"div",76)(27,"span",77),t.EFF(28,"Total Unidades"),t.k0s(),t.nrm(29,"i",82),t.k0s(),t.j41(30,"h3",83),t.EFF(31),t.nI1(32,"number"),t.k0s()()()(),t.j41(33,"div",74)(34,"div",13)(35,"div",75)(36,"div",76)(37,"span",77),t.EFF(38,"Costo Promedio"),t.k0s(),t.nrm(39,"i",84),t.k0s(),t.j41(40,"h3",85),t.EFF(41),t.nI1(42,"currency"),t.k0s()()()()(),t.DNE(43,X,22,7,"div",73),t.j41(44,"div",11)(45,"div",67)(46,"div",13)(47,"div",86)(48,"div",87)(49,"div")(50,"h5",88),t.EFF(51),t.DNE(52,V,2,0,"span",89),t.DNE(53,q,2,0,"span",90),t.DNE(54,J,2,1,"span",91),t.k0s()(),t.j41(55,"div",92)(56,"div",93)(57,"input",94),t.bIt("ngModelChange",function(o){t.eBV(n);const r=t.XpG();return t.Njj(r.busquedaProducto=o)})("input",function(){t.eBV(n);const o=t.XpG();return t.Njj(o.filtrarProductosPorBusqueda())}),t.k0s(),t.nrm(58,"i",95),t.k0s(),t.j41(59,"button",96),t.bIt("click",function(){t.eBV(n);const o=t.XpG();return t.Njj(o.limpiarBusqueda())}),t.nrm(60,"i",97),t.k0s()()(),t.DNE(61,Z,9,2,"div",98),t.k0s(),t.j41(62,"div",99)(63,"div",100)(64,"table",101)(65,"thead",102)(66,"tr")(67,"th"),t.EFF(68,"PRODUCTO"),t.k0s(),t.j41(69,"th"),t.EFF(70,"STOCK ACTUAL"),t.k0s(),t.j41(71,"th"),t.EFF(72,"COSTO UNITARIO"),t.k0s(),t.j41(73,"th"),t.EFF(74,"STOCK CONTADO"),t.k0s(),t.j41(75,"th"),t.EFF(76,"VALOR TOTAL"),t.k0s()()(),t.j41(77,"tbody"),t.DNE(78,tt,28,29,"tr",103),t.k0s()()(),t.j41(79,"div",104),t.DNE(80,et,41,29,"div",105),t.k0s()()()()()()}if(2&i){const n=t.XpG();t.R7$(1),t.Y8G("ngIf","borrador"===n.inventarioActual.estado),t.R7$(1),t.Y8G("ngIf","finalizado"===n.inventarioActual.estado),t.R7$(10),t.SpI(" ",t.ii3(13,19,n.inventarioActual.inversionTotal,"EUR","symbol","1.0-0")," "),t.R7$(10),t.SpI(" ",n.inventarioActual.totalProductos," "),t.R7$(9),t.SpI(" ",t.i5U(32,24,n.inventarioActual.totalUnidades,"1.1-1")," "),t.R7$(10),t.SpI(" ",t.ii3(42,27,n.inventarioActual.costoPromedio,"EUR","symbol","1.0-0")," "),t.R7$(2),t.Y8G("ngIf",n.familiasDisponibles.length>0),t.R7$(8),t.Lme(" Productos del Inventario (",n.productosFiltrados.length," de ",n.inventarioActual.productos.length,") "),t.R7$(1),t.Y8G("ngIf","borrador"===n.inventarioActual.estado),t.R7$(1),t.Y8G("ngIf","finalizado"===n.inventarioActual.estado),t.R7$(1),t.Y8G("ngIf",n.familiaSeleccionada),t.R7$(3),t.Y8G("ngModel",n.busquedaProducto),t.R7$(2),t.Y8G("disabled",!n.busquedaProducto),t.R7$(2),t.Y8G("ngIf",n.busquedaProducto||n.familiaSeleccionada),t.R7$(17),t.Y8G("ngForOf",n.productosFiltrados)("ngForTrackBy",n.trackByProducto),t.R7$(2),t.Y8G("ngForOf",n.productosFiltrados)("ngForTrackBy",n.trackByProducto)}}function it(i,c){1&i&&(t.j41(0,"div",11)(1,"div",67)(2,"div",68)(3,"div",172)(4,"span",173),t.EFF(5,"Cargando..."),t.k0s()(),t.j41(6,"h4",71),t.EFF(7,"Creando inventario..."),t.k0s(),t.j41(8,"p",122),t.EFF(9," Cargando productos y preparando el inventario para la fecha seleccionada "),t.k0s()()()())}function rt(i,c){if(1&i&&(t.j41(0,"div",182)(1,"small",160),t.EFF(2),t.k0s()()),2&i){const n=t.XpG().$implicit,e=t.XpG();t.R7$(2),t.Lme(" ",n.familias.length," familias: ",e.getFamiliasNombres(n.familias)," ")}}function at(i,c){if(1&i){const n=t.RV6();t.j41(0,"div",174)(1,"div",175),t.bIt("click",function(){const r=t.eBV(n).$implicit,a=t.XpG();return t.Njj(a.seleccionarCategoria(r.id||""))}),t.j41(2,"div",14)(3,"div",176)(4,"div",177),t.nrm(5,"i"),t.k0s(),t.j41(6,"div",108)(7,"h6",178),t.EFF(8),t.k0s(),t.j41(9,"small",122),t.EFF(10),t.k0s(),t.DNE(11,rt,3,2,"div",179),t.k0s(),t.j41(12,"div",180),t.nrm(13,"i",181),t.k0s()()()()()}if(2&i){const n=c.$implicit,e=t.XpG();t.R7$(1),t.AVh("selected",e.categoriaSeleccionada===n.id),t.R7$(3),t.xc7("background-color",n.colorFondo),t.R7$(1),t.HbH("bi "+n.icono+" text-white"),t.R7$(3),t.JRh(n.nombre),t.R7$(2),t.SpI("",e.getTotalProductosCategoria(n.id)," productos"),t.R7$(1),t.Y8G("ngIf",n.familias&&n.familias.length>0),t.R7$(2),t.HbH(e.categoriaSeleccionada===n.id?"bi-check-circle-fill text-success":"bi-circle text-muted")}}function ct(i,c){if(1&i&&(t.j41(0,"span",190),t.EFF(1),t.k0s()),2&i){const n=c.$implicit,e=t.XpG(3);t.R7$(1),t.Lme(" ",n.nombre," (",e.getProductosPorFamiliaEnCategoria(n.id||"").length," productos) ")}}function st(i,c){if(1&i&&(t.j41(0,"div",187)(1,"h6",184),t.EFF(2,"Familias incluidas:"),t.k0s(),t.j41(3,"div",188),t.DNE(4,ct,2,2,"span",189),t.k0s()()),2&i){const n=t.XpG(2);t.R7$(4),t.Y8G("ngForOf",n.getFamiliasCategoria())}}function lt(i,c){if(1&i&&(t.j41(0,"div",67)(1,"div",183)(2,"h6",184),t.nrm(3,"i",185),t.EFF(4," Categor\xeda seleccionada: "),t.j41(5,"strong"),t.EFF(6),t.k0s()(),t.j41(7,"p",184),t.EFF(8," Se incluir\xe1n "),t.j41(9,"strong"),t.EFF(10),t.k0s(),t.EFF(11," productos de esta categor\xeda en el inventario. "),t.k0s(),t.DNE(12,st,5,1,"div",186),t.k0s()()),2&i){const n=t.XpG();t.R7$(6),t.JRh(n.getNombreCategoriaSeleccionada()),t.R7$(4),t.JRh(n.getTotalProductosCategoria()),t.R7$(2),t.Y8G("ngIf",n.getFamiliasCategoria().length>0)}}function dt(i,c){1&i&&t.nrm(0,"span",65)}function gt(i,c){1&i&&t.nrm(0,"i",191)}function ut(i,c){if(1&i&&(t.j41(0,"option",64),t.EFF(1),t.k0s()),2&i){const n=c.$implicit;t.Y8G("value",n.id),t.R7$(1),t.SpI(" ",n.nombre," ")}}function mt(i,c){1&i&&(t.j41(0,"div",192)(1,"div",193)(2,"span",173),t.EFF(3,"Cargando historial..."),t.k0s()(),t.j41(4,"p",194),t.EFF(5,"Cargando historial de inventarios..."),t.k0s()())}function pt(i,c){if(1&i){const n=t.RV6();t.j41(0,"tr")(1,"td")(2,"strong"),t.EFF(3),t.nI1(4,"date"),t.k0s(),t.nrm(5,"br"),t.j41(6,"small",122),t.EFF(7),t.nI1(8,"date"),t.k0s()(),t.j41(9,"td")(10,"span",149),t.EFF(11),t.k0s()(),t.j41(12,"td")(13,"span",198),t.nrm(14,"i",199),t.EFF(15),t.k0s()(),t.j41(16,"td"),t.EFF(17),t.k0s(),t.j41(18,"td"),t.EFF(19),t.nI1(20,"currency"),t.k0s(),t.j41(21,"td")(22,"div",200)(23,"button",201),t.bIt("click",function(){const r=t.eBV(n).$implicit,a=t.XpG(2);return t.Njj(a.cargarInventarioDesdeHistorial(r))}),t.nrm(24,"i",202),t.k0s(),t.j41(25,"button",203),t.bIt("click",function(){const r=t.eBV(n).$implicit,a=t.XpG(2);return t.Njj(a.eliminarInventarioHistorial(r))}),t.nrm(26,"i",204),t.k0s()()()()}if(2&i){const n=c.$implicit,e=t.XpG(2);t.R7$(3),t.JRh(t.i5U(4,11,n.fecha,"dd/MM/yyyy")),t.R7$(4),t.SpI(" ",t.i5U(8,14,n.fechaCreacion,"dd/MM/yyyy HH:mm")," "),t.R7$(4),t.SpI(" ",e.getCategoriaNombre(n.categoriaId)," "),t.R7$(2),t.HbH("finalizado"===n.estado?"bg-success":"bg-warning"),t.R7$(1),t.HbH("finalizado"===n.estado?"bi-check-circle":"bi-clock"),t.R7$(1),t.SpI(" ","finalizado"===n.estado?"Finalizado":"Borrador"," "),t.R7$(2),t.JRh(n.totalProductos),t.R7$(2),t.JRh(t.ii3(20,17,n.inversionTotal,"EUR","symbol","1.0-0")),t.R7$(6),t.Y8G("disabled","finalizado"===n.estado)}}function ft(i,c){if(1&i&&(t.j41(0,"div")(1,"div",195)(2,"table",196)(3,"thead",102)(4,"tr")(5,"th"),t.EFF(6,"Fecha"),t.k0s(),t.j41(7,"th"),t.EFF(8,"Categor\xeda"),t.k0s(),t.j41(9,"th"),t.EFF(10,"Estado"),t.k0s(),t.j41(11,"th"),t.EFF(12,"Productos"),t.k0s(),t.j41(13,"th"),t.EFF(14,"Inversi\xf3n Total"),t.k0s(),t.j41(15,"th"),t.EFF(16,"Acciones"),t.k0s()()(),t.j41(17,"tbody"),t.DNE(18,pt,27,22,"tr",197),t.k0s()()()()),2&i){const n=t.XpG();t.R7$(18),t.Y8G("ngForOf",n.historialFiltrado)}}function _t(i,c){1&i&&(t.j41(0,"div",192),t.nrm(1,"i",205),t.j41(2,"h5",206),t.EFF(3,"No hay inventarios registrados"),t.k0s(),t.j41(4,"p",122),t.EFF(5,"Crea tu primer inventario para comenzar"),t.k0s()())}function vt(i,c){if(1&i&&(t.j41(0,"div",207)(1,"h6",184),t.nrm(2,"i",208),t.EFF(3),t.k0s(),t.j41(4,"p",88),t.EFF(5),t.nI1(6,"date"),t.k0s()()),2&i){const n=t.XpG();t.R7$(3),t.SpI(" Inventario actual: ",n.getCategoriaNombre(n.inventarioActual.categoriaId)," "),t.R7$(2),t.Lme(" Fecha: ",t.i5U(6,3,n.inventarioActual.fecha,"dd/MM/yyyy")," | Productos actuales: ",n.inventarioActual.totalProductos," ")}}function bt(i,c){if(1&i){const n=t.RV6();t.j41(0,"tr")(1,"td")(2,"input",213),t.bIt("change",function(o){const a=t.eBV(n).$implicit,g=t.XpG(2);return t.Njj(g.toggleProductoSeleccionado(a.id,o))}),t.k0s()(),t.j41(3,"td")(4,"strong"),t.EFF(5),t.k0s(),t.nrm(6,"br"),t.j41(7,"small",122),t.EFF(8),t.k0s(),t.nrm(9,"br"),t.j41(10,"span",214),t.EFF(11),t.k0s()(),t.j41(12,"td")(13,"span"),t.EFF(14),t.nI1(15,"number"),t.k0s()(),t.j41(16,"td"),t.EFF(17),t.nI1(18,"currency"),t.k0s()()}if(2&i){const n=c.$implicit,e=t.XpG(2);t.R7$(2),t.Y8G("checked",e.productosSeleccionadosParaAgregar.has(n.id)),t.R7$(3),t.JRh(n.nombre),t.R7$(3),t.JRh(n.unidadMedida),t.R7$(3),t.JRh(e.getCategoriaNombre(n.categoriaId)),t.R7$(2),t.HbH(e.getStockClass(n.stock||0)),t.R7$(1),t.SpI(" ",t.i5U(15,8,n.stock,"1.1-1")," "),t.R7$(3),t.JRh(t.ii3(18,11,n.costo,"EUR","symbol","1.2-2"))}}function ht(i,c){if(1&i){const n=t.RV6();t.j41(0,"div",37)(1,"div",116)(2,"h6",88),t.EFF(3,"Productos disponibles"),t.k0s(),t.j41(4,"span",149),t.EFF(5),t.k0s()(),t.j41(6,"div",209)(7,"table",210)(8,"thead",211)(9,"tr")(10,"th",212)(11,"input",213),t.bIt("change",function(o){t.eBV(n);const r=t.XpG();return t.Njj(r.toggleTodosProductos(o))}),t.k0s()(),t.j41(12,"th"),t.EFF(13,"Producto"),t.k0s(),t.j41(14,"th"),t.EFF(15,"Stock"),t.k0s(),t.j41(16,"th"),t.EFF(17,"Costo"),t.k0s()()(),t.j41(18,"tbody"),t.DNE(19,bt,19,16,"tr",197),t.k0s()()()()}if(2&i){const n=t.XpG();t.R7$(5),t.SpI("",n.productosDisponiblesParaAgregar.length," productos"),t.R7$(6),t.Y8G("checked",n.todosProductosSeleccionados()),t.R7$(8),t.Y8G("ngForOf",n.productosDisponiblesParaAgregar)}}function Pt(i,c){1&i&&(t.j41(0,"div",192)(1,"div",215)(2,"span",173),t.EFF(3,"Cargando productos..."),t.k0s()(),t.j41(4,"p",194),t.EFF(5,"Cargando productos disponibles..."),t.k0s()())}function Ct(i,c){if(1&i&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&i){const n=t.XpG(2);t.R7$(1),t.SpI('No se encontraron productos con "',n.busquedaProductosNuevos,'"')}}function Mt(i,c){1&i&&(t.j41(0,"span"),t.EFF(1,"Todos los productos de esta categor\xeda ya est\xe1n en el inventario"),t.k0s())}function Ot(i,c){if(1&i&&(t.j41(0,"div",192),t.nrm(1,"i",216),t.j41(2,"h6",206),t.EFF(3,"No hay productos disponibles"),t.k0s(),t.j41(4,"p",122),t.DNE(5,Ct,2,1,"span",27),t.DNE(6,Mt,2,0,"span",27),t.k0s()()),2&i){const n=t.XpG();t.R7$(5),t.Y8G("ngIf",n.busquedaProductosNuevos),t.R7$(1),t.Y8G("ngIf",!n.busquedaProductosNuevos)}}function Ft(i,c){if(1&i&&(t.j41(0,"div",183)(1,"h6",184),t.nrm(2,"i",185),t.EFF(3),t.k0s(),t.j41(4,"p",88),t.EFF(5,"Se agregar\xe1n estos productos al inventario actual"),t.k0s()()),2&i){const n=t.XpG();t.R7$(3),t.SpI(" Productos seleccionados: ",n.productosSeleccionadosParaAgregar.size," ")}}function kt(i,c){1&i&&t.nrm(0,"span",65)}function It(i,c){1&i&&t.nrm(0,"i",191)}const xt=[{path:"",component:(()=>{class i{constructor(n,e){this.firestore=n,this.authService=e,this.isLoading=!1,this.isCreatingInventory=!1,this.isSaving=!1,this.inventarioActual=null,this.productos=[],this.categorias=[],this.proveedores=[],this.fechaSeleccionada=new Date,this.fechaFiltro=new f.MJ((new Date).toISOString().split("T")[0]),this.categoriaFiltro=new f.MJ(""),this.proveedorFiltro=new f.MJ(""),this.categoriaSeleccionada="",this.familiasDisponibles=[],this.familiaSeleccionada="",this.productosFiltrados=[],this.busquedaProducto="",this.productosSinFiltrar=[],this.historialInventarios=[],this.historialFiltrado=[],this.historialFiltroCategoria="",this.historialFiltroEstado="",this.historialLimite="25",this.isLoadingHistorial=!1,this.productosDisponiblesParaAgregar=[],this.productosSeleccionadosParaAgregar=new Set,this.busquedaProductosNuevos="",this.isLoadingProductosNuevos=!1,this.isAgregarProductos=!1,this.subscriptions=new j.yU}convertirFecha(n){if(n){if(n instanceof Date)return n;if("object"==typeof n&&"toDate"in n)return n.toDate();if("string"==typeof n)return new Date(n)}}limpiarObjetoParaFirebase(n){const e={};for(const[o,r]of Object.entries(n))null!=r&&(e[o]=Array.isArray(r)?r.map(a=>"object"==typeof a?this.limpiarObjetoParaFirebase(a):a):"object"==typeof r&&null!==r?this.limpiarObjetoParaFirebase(r):r);return e}ngOnInit(){this.authService.getCurrentUser()?(this.cargarDatosIniciales(),this.setupFiltros(),this.buscarInventario()):l().fire("Error","Usuario no autenticado","error")}ngOnDestroy(){this.subscriptions.unsubscribe()}setupFiltros(){this.subscriptions.add(this.fechaFiltro.valueChanges.subscribe(n=>{if(n)try{this.fechaSeleccionada=new Date(n)}catch{this.fechaSeleccionada=new Date}}))}cargarDatosIniciales(){var n=this;return(0,_.A)(function*(){try{const e=(0,s.collection)(n.firestore,"productos");n.subscriptions.add((0,s.collectionData)(e,{idField:"id"}).subscribe({next:a=>{n.productos=a.filter(g=>!g.esCombinado)},error:a=>{l().fire("Error","Error al cargar productos","error")}}));const o=(0,s.collection)(n.firestore,"categorias");n.subscriptions.add((0,s.collectionData)(o,{idField:"id"}).subscribe({next:a=>{n.categorias=a,n.inventarioActual&&(n.configurarFamiliasDisponibles(),n.aplicarFiltroFamilia())},error:a=>{l().fire("Error","Error al cargar categor\xedas","error")}}));const r=(0,s.collection)(n.firestore,"proveedores");n.subscriptions.add((0,s.collectionData)(r,{idField:"id"}).subscribe({next:a=>{n.proveedores=a},error:a=>{l().fire("Error","Error al cargar proveedores","error")}}))}catch{l().fire("Error","Error al cargar los datos iniciales","error")}})()}buscarInventario(){var n=this;return(0,_.A)(function*(){n.isLoading=!0;try{const e=n.fechaSeleccionada.toISOString().split("T")[0],o=(0,s.collection)(n.firestore,"inventarios"),r=(0,s.query)(o,(0,s.where)("fecha","==",e)),a=yield(0,s.getDocs)(r);if(a.empty)n.inventarioActual=null;else{const g=a.docs.filter(d=>!d.data().eliminado);if(g.length>0){const d=g.filter(h=>"borrador"===h.data().estado),u=d.length>0?d[0]:g[0];n.inventarioActual={id:u.id,...u.data()},n.inventarioActual.fecha=n.convertirFecha(n.inventarioActual.fecha)||n.inventarioActual.fecha,n.inventarioActual.fechaActualizacion=n.convertirFecha(n.inventarioActual.fechaActualizacion),n.inventarioActual.fechaCreacion=n.convertirFecha(n.inventarioActual.fechaCreacion),"borrador"===n.inventarioActual.estado&&setTimeout(()=>{const b=n.categorias.find(O=>O.id===n.inventarioActual?.categoriaId)?.nombre||"Sin categor\xeda";l().fire({title:"Inventario en borrador encontrado",text:`Se ha cargado un inventario en borrador de ${b} para esta fecha. Puedes continuar edit\xe1ndolo.`,icon:"info",confirmButtonText:"Continuar",timer:3e3,timerProgressBar:!0})},1e3)}else n.inventarioActual=null}n.inventarioActual&&(n.configurarFamiliasDisponibles(),n.aplicarFiltroFamilia())}catch{n.inventarioActual=null}finally{n.isLoading=!1}})()}crearNuevoInventario(){var n=this;return(0,_.A)(function*(){if(!n.inventarioActual||(yield l().fire({title:"\xbfCrear nuevo inventario?",text:"Ya existe un inventario para esta fecha. \xbfDeseas reemplazarlo?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#dc3545",cancelButtonColor:"#6c757d",confirmButtonText:"S\xed, crear nuevo",cancelButtonText:"Cancelar"})).isConfirmed){n.isCreatingInventory=!0;try{let e=[...n.productos];const o=n.categoriaFiltro.value,r=n.proveedorFiltro.value;o&&(e=e.filter(p=>p.categoriaId===o)),r&&(e=e.filter(p=>p.proveedorId===r));const a=e.map(p=>{const P=n.categorias.find(x=>x.id===p.categoriaId),F=n.proveedores.find(x=>x.id===p.proveedorId);return{productoId:p.id,nombre:p.nombre,categoria:P?.nombre||"Sin categor\xeda",proveedor:F?.nombre||"Sin proveedor",stockActual:p.stock||0,stockContado:null,costoUnitario:p.costo,valorTotal:(p.stock||0)*p.costo,unidadMedida:p.unidadMedida,diferencia:0}}),g=a.reduce((p,P)=>p+P.valorTotal,0),d=a.length,u=a.reduce((p,P)=>p+(P.stockContado??0),0),h=u>0?g/u:0,b={fecha:n.fechaSeleccionada.toISOString().split("T")[0],categoriaId:o||void 0,proveedorId:r||void 0,productos:a,inversionTotal:g,totalProductos:d,totalUnidades:u,costoPromedio:h,fechaCreacion:(0,s.serverTimestamp)(),usuarioId:n.authService.getCurrentUser()?.id,estado:"borrador"},O=n.limpiarObjetoParaFirebase(b),k=(0,s.collection)(n.firestore,"inventarios"),I=yield(0,s.addDoc)(k,O);n.inventarioActual={id:I.id,fecha:n.fechaSeleccionada,categoriaId:o||void 0,proveedorId:r||void 0,productos:a,inversionTotal:g,totalProductos:d,totalUnidades:u,costoPromedio:h,fechaCreacion:new Date,usuarioId:n.authService.getCurrentUser()?.id,estado:"borrador"},o&&n.categorias.find(p=>p.id===o),l().fire("\xa1Creado!",`Inventario creado con ${d} productos. Puedes editarlo y luego finalizarlo.`,"success")}catch{l().fire("Error","Error al crear el inventario","error")}finally{n.isCreatingInventory=!1}}})()}recalcularTotales(){this.inventarioActual&&(this.inventarioActual.inversionTotal=this.inventarioActual.productos.reduce((n,e)=>n+e.valorTotal,0),this.inventarioActual.totalUnidades=this.inventarioActual.productos.reduce((n,e)=>n+(e.stockContado??0),0),this.inventarioActual.costoPromedio=this.inventarioActual.totalUnidades>0?this.inventarioActual.inversionTotal/this.inventarioActual.totalUnidades:0)}guardarInventario(){var n=this;return(0,_.A)(function*(){if(n.inventarioActual&&("borrador"!==n.inventarioActual.estado||(yield l().fire({title:"\xbfFinalizar inventario?",html:'\n          <p>Una vez finalizado, no podr\xe1s editarlo.</p>\n          <div class="alert alert-warning mt-3">\n            <strong>Nota:</strong> Los stocks de los productos NO se actualizar\xe1n autom\xe1ticamente.\n            Usa el bot\xf3n "Actualizar Productos" cuando est\xe9s listo.\n          </div>\n          <p>\xbfEst\xe1s seguro?</p>\n        ',icon:"question",showCancelButton:!0,confirmButtonColor:"#dc3545",cancelButtonColor:"#6c757d",confirmButtonText:"S\xed, finalizar inventario",cancelButtonText:"Cancelar"})).isConfirmed)){n.isSaving=!0;try{const e={...n.inventarioActual,fecha:n.fechaSeleccionada.toISOString().split("T")[0],fechaActualizacion:(0,s.serverTimestamp)(),estado:"finalizado"},o=n.limpiarObjetoParaFirebase(e);if(n.inventarioActual.id){const r=(0,s.doc)(n.firestore,"inventarios",n.inventarioActual.id);yield(0,s.updateDoc)(r,o),n.inventarioActual.estado="finalizado",n.inventarioActual.fechaActualizacion=new Date}else{const r=(0,s.collection)(n.firestore,"inventarios"),a=yield(0,s.addDoc)(r,o);n.inventarioActual.id=a.id,n.inventarioActual.estado="finalizado"}l().fire({title:"\xa1Inventario Finalizado!",html:'\n          <p>El inventario ha sido finalizado exitosamente.</p>\n          <div class="alert alert-info mt-3">\n            <strong>Recuerda:</strong> Usa el bot\xf3n "Actualizar Productos" para aplicar los cambios de stock.\n          </div>\n        ',icon:"success",timer:4e3,timerProgressBar:!0})}catch(e){console.error("Error al finalizar inventario:",e),l().fire("Error","Error al finalizar el inventario","error")}finally{n.isSaving=!1}}})()}actualizarProductosInventario(){var n=this;return(0,_.A)(function*(){if(!n.inventarioActual)return;const e=n.inventarioActual.productos.filter(r=>null!=r.stockContado);if(0!==e.length){if((yield l().fire({title:"\xbfActualizar stocks de productos?",html:`\n        <p>Se actualizar\xe1n los stocks de <strong>${e.length} productos</strong> con los valores contados en el inventario.</p>\n        <div class="alert alert-warning mt-3">\n          <strong>\xa1Atenci\xf3n!</strong> Esta acci\xf3n modificar\xe1 permanentemente los stocks en tu inventario de productos.\n        </div>\n        <p>\xbfEst\xe1s seguro de continuar?</p>\n      `,icon:"warning",showCancelButton:!0,confirmButtonColor:"#28a745",cancelButtonColor:"#6c757d",confirmButtonText:"S\xed, actualizar stocks",cancelButtonText:"Cancelar"})).isConfirmed){n.isSaving=!0;try{yield n.actualizarStocksProductos(),l().fire({title:"\xa1Productos Actualizados!",html:`\n          <p>Los stocks han sido actualizados exitosamente.</p>\n          <div class="alert alert-success mt-3">\n            <strong>${e.length} productos</strong> han sido actualizados con el nuevo stock.\n          </div>\n        `,icon:"success",timer:4e3,timerProgressBar:!0})}catch(r){console.error("Error al actualizar productos:",r),l().fire("Error","Error al actualizar los stocks de productos","error")}finally{n.isSaving=!1}}}else l().fire("Informaci\xf3n","No hay productos con stock contado para actualizar","info")})()}actualizarStocksProductos(){var n=this;return(0,_.A)(function*(){if(!n.inventarioActual)return;const e=n.inventarioActual.productos.filter(r=>null!=r.stockContado);if(0===e.length)return void console.log("No hay productos con stock contado para actualizar");console.log(`Actualizando stock de ${e.length} productos...`);const o=e.map(function(){var r=(0,_.A)(function*(a){try{const g=(0,s.doc)(n.firestore,"productos",a.productoId);yield(0,s.updateDoc)(g,{stock:a.stockContado,fechaActualizacion:(0,s.serverTimestamp)(),ultimoInventario:n.fechaSeleccionada.toISOString().split("T")[0]});const d=n.productos.find(u=>u.id===a.productoId);d&&(d.stock=a.stockContado),console.log(`Stock actualizado para ${a.nombre}: ${a.stockContado}`)}catch(g){throw console.error(`Error actualizando producto ${a.nombre}:`,g),g}});return function(a){return r.apply(this,arguments)}}());yield Promise.all(o),console.log("Todos los stocks han sido actualizados exitosamente")})()}getStockClass(n){return n<=0?"text-danger fw-bold":n<=5?"text-warning fw-bold":"text-success fw-bold"}trackByProducto(n,e){return e.productoId}cancelarInventario(){var n=this;return(0,_.A)(function*(){if(n.inventarioActual?.id){if((yield l().fire({title:"\xbfCancelar inventario?",text:"Se eliminar\xe1 completamente el inventario en borrador. Esta acci\xf3n no se puede deshacer.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#dc3545",cancelButtonColor:"#6c757d",confirmButtonText:"S\xed, eliminar",cancelButtonText:"No cancelar"})).isConfirmed){n.isSaving=!0;try{const o=(0,s.doc)(n.firestore,"inventarios",n.inventarioActual.id);yield(0,s.deleteDoc)(o),n.inventarioActual=null,n.familiasDisponibles=[],n.familiaSeleccionada="",n.productosFiltrados=[],l().fire({title:"\xa1Eliminado!",text:"El inventario ha sido eliminado completamente",icon:"success",timer:2e3,timerProgressBar:!0})}catch{l().fire("Error","Error al eliminar el inventario","error")}finally{n.isSaving=!1}}}else l().fire("Error","No hay inventario para cancelar","error")})()}calcularValorTotal(n){if("finalizado"===this.inventarioActual?.estado)return;const e=n.stockContado??0;n.diferencia=e-n.stockActual,n.valorTotal=e*n.costoUnitario,this.recalcularTotales(),"borrador"===this.inventarioActual?.estado&&this.autoGuardarBorrador()}autoGuardarBorrador(){this.autoSaveTimeout&&clearTimeout(this.autoSaveTimeout),this.autoSaveTimeout=setTimeout(()=>{this.guardarBorrador()},2e3)}guardarBorrador(){var n=this;return(0,_.A)(function*(){if(n.inventarioActual?.id&&"borrador"===n.inventarioActual.estado)try{const e=(0,s.doc)(n.firestore,"inventarios",n.inventarioActual.id);yield(0,s.updateDoc)(e,{productos:n.inventarioActual.productos,inversionTotal:n.inventarioActual.inversionTotal,totalUnidades:n.inventarioActual.totalUnidades,costoPromedio:n.inventarioActual.costoPromedio,fechaActualizacion:(0,s.serverTimestamp)()})}catch{}})()}abrirModalNuevoInventario(){this.categoriaSeleccionada="";const n=document.getElementById("modalNuevoInventario");n&&(this.modal=new bootstrap.Modal(n),this.modal.show())}cerrarModalNuevoInventario(){this.modal&&this.modal.hide(),this.categoriaSeleccionada=""}seleccionarCategoria(n){this.categoriaSeleccionada=n}getNombreCategoriaSeleccionada(){return this.categorias.find(e=>e.id===this.categoriaSeleccionada)?.nombre||""}getTotalProductosCategoria(n){const e=n||this.categoriaSeleccionada;return e?this.productos.filter(o=>o.categoriaId===e&&!o.esCombinado).length:0}getFamiliasCategoria(){return this.categorias.find(e=>e.id===this.categoriaSeleccionada)?.familias||[]}getProductosPorFamiliaEnCategoria(n){return this.productos.filter(e=>e.categoriaId===this.categoriaSeleccionada&&e.familiaId===n&&!e.esCombinado)}getFamiliasNombres(n){return n&&0!==n.length?n.map(e=>e.nombre).join(", "):""}crearInventarioConSeleccion(){var n=this;return(0,_.A)(function*(){if(n.categoriaSeleccionada)if(0!==n.productos.length)if(0!==n.categorias.length){if(n.inventarioActual){const o="borrador"===n.inventarioActual.estado?"en borrador":"finalizado";if(!(yield l().fire({title:"\xbfCrear nuevo inventario?",text:`Ya existe un inventario ${o} para esta fecha. \xbfDeseas reemplazarlo?`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#dc3545",cancelButtonColor:"#6c757d",confirmButtonText:"S\xed, reemplazar",cancelButtonText:"Cancelar"})).isConfirmed)return;if(n.inventarioActual.id)try{const a=(0,s.doc)(n.firestore,"inventarios",n.inventarioActual.id);yield(0,s.deleteDoc)(a)}catch(a){console.error("Error eliminando inventario anterior:",a)}}n.isCreatingInventory=!0;try{const e=n.authService.getCurrentUser();if(!e?.id)return void l().fire("Error","Usuario no autenticado","error");const o=n.productos.filter(m=>m.categoriaId===n.categoriaSeleccionada&&!m.esCombinado);if(0===o.length)return void l().fire("Error","No hay productos disponibles en la categor\xeda seleccionada.","error");const r=o.map(m=>{const M=n.categorias.find(F=>F.id===m.categoriaId),p=n.proveedores.find(F=>F.id===m.proveedorId),P={productoId:m.id||"",nombre:m.nombre||"",categoria:M?.nombre||"Sin categor\xeda",proveedor:p?.nombre||"Sin proveedor",stockActual:m.stock||0,stockContado:null,costoUnitario:m.costo||0,valorTotal:(m.stock||0)*(m.costo||0),unidadMedida:m.unidadMedida||"",diferencia:0};return m.familiaId&&(P.familiaId=m.familiaId),P}),a=r.reduce((m,M)=>m+M.valorTotal,0),g=r.length,d=r.reduce((m,M)=>m+(M.stockContado??0),0),u=d>0?a/d:0,h={fecha:n.fechaSeleccionada.toISOString().split("T")[0],categoriaId:n.categoriaSeleccionada||"",productos:r,inversionTotal:a||0,totalProductos:g||0,totalUnidades:d||0,costoPromedio:u||0,fechaCreacion:(0,s.serverTimestamp)(),usuarioId:e.id||"",estado:"borrador"},b=n.limpiarObjetoParaFirebase(h),O=(0,s.collection)(n.firestore,"inventarios"),k=yield(0,s.addDoc)(O,b);n.inventarioActual={id:k.id,fecha:n.fechaSeleccionada,categoriaId:n.categoriaSeleccionada,productos:r,inversionTotal:a,totalProductos:g,totalUnidades:d,costoPromedio:u,fechaCreacion:new Date,usuarioId:e.id,estado:"borrador"},n.configurarFamiliasDisponibles(),n.aplicarFiltroFamilia(),n.cerrarModalNuevoInventario();const I=n.getNombreCategoriaSeleccionada();l().fire("\xa1Creado!",`Inventario de ${I} creado con ${g} productos. Puedes editarlo y luego finalizarlo.`,"success")}catch(e){let o="Error al crear el inventario";e?.message&&(o+=": "+e.message),l().fire("Error",o,"error")}finally{n.isCreatingInventory=!1}}else l().fire("Error","No se han cargado las categor\xedas. Intenta recargar la p\xe1gina.","error");else l().fire("Error","No se han cargado los productos. Intenta recargar la p\xe1gina.","error");else l().fire("Error","Selecciona una categor\xeda para el inventario","error")})()}configurarFamiliasDisponibles(){if(!this.inventarioActual)return;const n=new Set,e=new Map,o=this.categorias.find(r=>r.id===this.inventarioActual?.categoriaId);o?.familias&&o.familias.forEach(r=>{r.id&&!n.has(r.id)&&(n.add(r.id),e.set(r.id,r))}),this.familiasDisponibles=Array.from(e.values())}filtrarPorFamilia(n){this.familiaSeleccionada=n,this.aplicarFiltroFamilia()}aplicarFiltroFamilia(){this.inventarioActual&&(this.productosSinFiltrar=[...this.inventarioActual.productos],this.productosFiltrados=this.familiaSeleccionada?this.inventarioActual.productos.filter(n=>this.productos.find(o=>o.id===n.productoId)?.familiaId===this.familiaSeleccionada):[...this.inventarioActual.productos],this.busquedaProducto.trim()&&this.filtrarProductosPorBusqueda())}getProductosPorFamilia(n){return this.inventarioActual?this.inventarioActual.productos.filter(e=>this.productos.find(r=>r.id===e.productoId)?.familiaId===n):[]}getNombreFamiliaSeleccionada(){return this.familiasDisponibles.find(e=>e.id===this.familiaSeleccionada)?.nombre||""}trackByFamilia(n,e){return e.id||""}getProductosSinContarPorFamilia(n){return this.inventarioActual?this.getProductosPorFamilia(n).filter(o=>null==o.stockContado).length:0}getCostoTotalPorFamilia(n){return this.inventarioActual?this.getProductosPorFamilia(n).reduce((o,r)=>o+(r.stockContado??0)*r.costoUnitario,0):0}formatearMoneda(n){return n.toLocaleString("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:0})}getTotalProductosSinContar(){return this.inventarioActual?this.inventarioActual.productos.filter(n=>null==n.stockContado).length:0}getCostoTotalInventario(){return this.inventarioActual?this.inventarioActual.productos.reduce((n,e)=>n+(e.stockContado??0)*e.costoUnitario,0):0}getFamiliasConProductos(){return this.familiasDisponibles?this.familiasDisponibles.filter(n=>this.getProductosPorFamilia(n.id||"").length>0):[]}filtrarProductosPorBusqueda(){if(!this.inventarioActual)return;0===this.productosSinFiltrar.length&&(this.productosSinFiltrar=[...this.inventarioActual.productos]);let n=this.productosSinFiltrar;if(this.familiaSeleccionada&&(n=this.productosSinFiltrar.filter(o=>this.productos.find(a=>a.id===o.productoId)?.familiaId===this.familiaSeleccionada)),!this.busquedaProducto.trim())return void(this.productosFiltrados=[...n]);const e=this.busquedaProducto.toLowerCase().trim();this.productosFiltrados=n.filter(o=>{const r=this.productos.find(b=>b.id===o.productoId);if(!r)return!1;const a=r.nombre.toLowerCase().includes(e),d=this.categorias.find(b=>b.id===r.categoriaId)?.nombre.toLowerCase().includes(e)||!1,h=this.proveedores.find(b=>b.id===r.proveedorId)?.nombre.toLowerCase().includes(e)||!1;return a||d||h})}limpiarBusqueda(){this.busquedaProducto="",this.filtrarProductosPorBusqueda()}limpiarTodosFiltros(){this.busquedaProducto="",this.familiaSeleccionada="",this.aplicarFiltroFamilia()}abrirModalHistorial(){var n=this;return(0,_.A)(function*(){const e=document.getElementById("modalHistorial");e&&(n.modalHistorial=new bootstrap.Modal(e),n.modalHistorial.show(),yield n.cargarHistorial())})()}cerrarModalHistorial(){this.modalHistorial&&this.modalHistorial.hide()}cargarHistorial(){var n=this;return(0,_.A)(function*(){n.isLoadingHistorial=!0;try{const e=(0,s.collection)(n.firestore,"inventarios"),o=parseInt(n.historialLimite),r=yield(0,s.getDocs)(e);n.historialInventarios=[];const a=[];r.forEach(g=>{const d=g.data();if(!d.eliminado){const u={id:g.id,...d,fecha:n.convertirFecha(d.fecha)||d.fecha,fechaCreacion:n.convertirFecha(d.fechaCreacion),fechaActualizacion:n.convertirFecha(d.fechaActualizacion)};a.push(u)}}),a.sort((g,d)=>{const u=g.fechaCreacion||new Date(0);return(d.fechaCreacion||new Date(0)).getTime()-u.getTime()}),n.historialInventarios=a.slice(0,o),n.filtrarHistorial(),console.log(`Historial cargado: ${n.historialInventarios.length} inventarios`)}catch(e){console.error("Error cargando historial:",e),l().fire("Error","Error al cargar el historial de inventarios","error")}finally{n.isLoadingHistorial=!1}})()}filtrarHistorial(){this.historialFiltrado=this.historialInventarios.filter(n=>!(this.historialFiltroCategoria&&n.categoriaId!==this.historialFiltroCategoria||this.historialFiltroEstado&&n.estado!==this.historialFiltroEstado))}cargarInventarioDesdeHistorial(n){this.fechaSeleccionada=new Date(n.fecha),this.fechaFiltro.setValue(this.fechaSeleccionada.toISOString().split("T")[0]),this.inventarioActual={...n},this.configurarFamiliasDisponibles(),this.aplicarFiltroFamilia(),this.cerrarModalHistorial(),l().fire({title:"Inventario cargado",text:`Se ha cargado el inventario del ${n.fecha}`,icon:"success",timer:2e3,timerProgressBar:!0})}eliminarInventarioHistorial(n){var e=this;return(0,_.A)(function*(){if("finalizado"!==n.estado){if((yield l().fire({title:"\xbfEliminar inventario?",text:`Se eliminar\xe1 el inventario del ${n.fecha}. Esta acci\xf3n no se puede deshacer.`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#dc3545",cancelButtonColor:"#6c757d",confirmButtonText:"S\xed, eliminar",cancelButtonText:"Cancelar"})).isConfirmed)try{if(n.id){const r=(0,s.doc)(e.firestore,"inventarios",n.id);yield(0,s.deleteDoc)(r),yield e.cargarHistorial(),e.inventarioActual?.id===n.id&&(e.inventarioActual=null,e.familiasDisponibles=[],e.familiaSeleccionada="",e.productosFiltrados=[]),l().fire("\xa1Eliminado!","El inventario ha sido eliminado","success")}}catch(r){console.error("Error eliminando inventario:",r),l().fire("Error","Error al eliminar el inventario","error")}}else l().fire("Error","No se pueden eliminar inventarios finalizados","error")})()}getCategoriaNombre(n){return n&&this.categorias.find(o=>o.id===n)?.nombre||"Sin categor\xeda"}abrirModalAgregarProductos(){if(!this.inventarioActual||"finalizado"===this.inventarioActual.estado)return void l().fire("Error","No hay inventario activo o est\xe1 finalizado","error");this.cargarProductosDisponibles();const n=document.getElementById("modalAgregarProductos");n&&(this.modalAgregarProductos=new bootstrap.Modal(n),this.modalAgregarProductos.show())}cerrarModalAgregarProductos(){this.modalAgregarProductos&&this.modalAgregarProductos.hide(),this.limpiarSeleccionProductos()}cargarProductosDisponibles(){if(!this.inventarioActual)return void(this.productosDisponiblesParaAgregar=[]);const n=new Set(this.inventarioActual.productos.map(e=>e.productoId));this.productosDisponiblesParaAgregar=this.productos.filter(e=>!(!e.id||e.esCombinado||e.categoriaId!==this.inventarioActual?.categoriaId||n.has(e.id))),this.busquedaProductosNuevos="",console.log(`Productos disponibles para agregar: ${this.productosDisponiblesParaAgregar.length}`)}filtrarProductosNuevos(){if(!this.busquedaProductosNuevos.trim())return void this.cargarProductosDisponibles();const n=this.busquedaProductosNuevos.toLowerCase(),e=new Set(this.inventarioActual?.productos.map(o=>o.productoId)||[]);this.productosDisponiblesParaAgregar=this.productos.filter(o=>o.categoriaId===this.inventarioActual?.categoriaId&&!o.esCombinado&&!e.has(o.id)&&o.nombre.toLowerCase().includes(n))}toggleProductoSeleccionado(n,e){e.target.checked?this.productosSeleccionadosParaAgregar.add(n):this.productosSeleccionadosParaAgregar.delete(n)}toggleTodosProductos(n){n.target.checked?this.productosDisponiblesParaAgregar.forEach(e=>{e.id&&this.productosSeleccionadosParaAgregar.add(e.id)}):this.productosSeleccionadosParaAgregar.clear()}todosProductosSeleccionados(){return this.productosDisponiblesParaAgregar.length>0&&this.productosDisponiblesParaAgregar.every(n=>n.id&&this.productosSeleccionadosParaAgregar.has(n.id))}agregarProductosSeleccionados(){var n=this;return(0,_.A)(function*(){if(0!==n.productosSeleccionadosParaAgregar.size&&n.inventarioActual){n.isAgregarProductos=!0;try{const e=[];if(n.productosSeleccionadosParaAgregar.forEach(o=>{const r=n.productos.find(a=>a.id===o);if(r){const a=n.categorias.find(u=>u.id===r.categoriaId),g=n.proveedores.find(u=>u.id===r.proveedorId),d={productoId:r.id,nombre:r.nombre,categoria:a?.nombre||"Sin categor\xeda",proveedor:g?.nombre||"Sin proveedor",stockActual:r.stock||0,stockContado:null,costoUnitario:r.costo,valorTotal:(r.stock||0)*r.costo,unidadMedida:r.unidadMedida,diferencia:0};r.familiaId&&(d.familiaId=r.familiaId),e.push(d)}}),n.inventarioActual.productos.push(...e),n.inventarioActual.totalProductos=n.inventarioActual.productos.length,n.recalcularTotales(),n.inventarioActual.id){const o=(0,s.doc)(n.firestore,"inventarios",n.inventarioActual.id);yield(0,s.updateDoc)(o,{productos:n.inventarioActual.productos,totalProductos:n.inventarioActual.totalProductos,inversionTotal:n.inventarioActual.inversionTotal,totalUnidades:n.inventarioActual.totalUnidades,costoPromedio:n.inventarioActual.costoPromedio,fechaActualizacion:(0,s.serverTimestamp)()})}n.configurarFamiliasDisponibles(),n.aplicarFiltroFamilia(),n.cerrarModalAgregarProductos(),l().fire("\xa1Productos agregados!",`Se agregaron ${e.length} productos al inventario`,"success")}catch(e){console.error("Error agregando productos:",e),l().fire("Error","Error al agregar productos al inventario","error")}finally{n.isAgregarProductos=!1}}})()}limpiarSeleccionProductos(){this.productosSeleccionadosParaAgregar.clear(),this.busquedaProductosNuevos="",this.productosDisponiblesParaAgregar=[]}static{this.\u0275fac=function(e){return new(e||i)(t.rXU(s.Firestore),t.rXU(R.u))}}static{this.\u0275cmp=t.VBU({type:i,selectors:[["app-inventario-page"]],decls:144,vars:42,consts:[[1,"container-fluid"],[1,"row"],[1,"col-8"],[1,"col","text-end"],["role","group",1,"btn-group"],[1,"btn","btn-outline-info",3,"disabled","click"],[1,"bi","bi-clock-history","me-2"],["title","Agregar productos nuevos al inventario actual",1,"btn","btn-warning",3,"disabled","click"],[1,"bi","bi-plus-circle","me-2"],[1,"btn","btn-danger",3,"disabled","click"],[1,"bi","bi-plus-lg","me-2"],[1,"row","mt-4"],[1,"col"],[1,"card","border-0","shadow-sm"],[1,"card-body"],[1,"row","align-items-center"],[1,"col-12","col-md-3","mb-2","mb-md-0"],[1,"form-label","small","text-muted"],["type","date",1,"form-control",3,"formControl","value"],[1,"form-select",3,"formControl"],["value",""],[3,"value",4,"ngFor","ngForOf"],[1,"col-12","col-md-3","text-end","mt-4"],[1,"btn","btn-outline-danger","w-100",3,"disabled","click"],["class","spinner-border spinner-border-sm me-2",4,"ngIf"],["class","bi bi-search me-2",4,"ngIf"],["class","row mt-4",4,"ngIf"],[4,"ngIf"],["id","modalNuevoInventario","tabindex","-1","data-bs-backdrop","static",1,"modal","fade"],[1,"modal-dialog","modal-lg"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],[1,"bi","bi-clipboard-check","me-2"],["type","button",1,"btn-close",3,"click"],[1,"modal-body"],[1,"col-12","mb-4"],[1,"mb-3"],[1,"bi","bi-tags","me-2"],["class","col-md-6 mb-3",4,"ngFor","ngForOf"],["class","col-12",4,"ngIf"],[1,"modal-footer"],["type","button",1,"btn","btn-secondary",3,"click"],["type","button",1,"btn","btn-danger",3,"disabled","click"],["class","bi bi-plus me-2",4,"ngIf"],["id","modalHistorial","tabindex","-1","data-bs-backdrop","static",1,"modal","fade"],[1,"modal-dialog","modal-xl"],[1,"row","mb-4"],[1,"col-md-4"],[1,"form-select",3,"ngModel","ngModelChange","change"],["value","borrador"],["value","finalizado"],["value","10"],["value","25"],["value","50"],["value","100"],["class","text-center py-4",4,"ngIf"],["id","modalAgregarProductos","tabindex","-1","data-bs-backdrop","static",1,"modal","fade"],["class","alert alert-info",4,"ngIf"],[1,"form-label"],["type","text","placeholder","Escribe el nombre del producto...",1,"form-control",3,"ngModel","ngModelChange","input"],["class","mb-3",4,"ngIf"],["class","alert alert-success",4,"ngIf"],["type","button",1,"btn","btn-success",3,"disabled","click"],[3,"value"],[1,"spinner-border","spinner-border-sm","me-2"],[1,"bi","bi-search","me-2"],[1,"col-12"],[1,"text-center","py-5"],[1,"mb-4"],[1,"bi","bi-archive","text-muted",2,"font-size","4rem"],[1,"text-muted","mb-3"],[1,"text-muted","mb-4"],["class","row mt-3",4,"ngIf"],[1,"col-12","col-md-3","mb-3"],[1,"card-body","text-center"],[1,"d-flex","justify-content-between","align-items-center","mb-2"],[1,"text-muted","small"],[1,"bi","bi-currency-euro","text-danger"],[1,"text-danger","fw-bold","mb-0"],[1,"bi","bi-box","text-info"],[1,"text-info","fw-bold","mb-0"],[1,"bi","bi-graph-up","text-success"],[1,"text-success","fw-bold","mb-0"],[1,"bi","bi-calculator","text-warning"],[1,"text-warning","fw-bold","mb-0"],[1,"card-header","bg-white","border-0","py-3"],[1,"d-flex","flex-column","flex-md-row","justify-content-between","align-items-start","align-items-md-center","gap-3"],[1,"mb-0"],["class","badge bg-warning ms-2",4,"ngIf"],["class","badge bg-success ms-2",4,"ngIf"],["class","badge bg-info ms-2",4,"ngIf"],[1,"d-flex","align-items-center","gap-2"],[1,"position-relative",2,"min-width","300px"],["type","text","placeholder","Buscar producto por nombre...","autocomplete","off",1,"form-control","form-control-sm",3,"ngModel","ngModelChange","input"],[1,"bi","bi-search","position-absolute","top-50","end-0","translate-middle-y","me-3","text-muted"],["type","button","title","Limpiar b\xfasqueda",1,"btn","btn-outline-secondary","btn-sm",3,"disabled","click"],[1,"bi","bi-x-lg"],["class","mt-2",4,"ngIf"],[1,"card-body","p-0"],[1,"table-responsive","d-none","d-md-block"],[1,"table","table-hover","mb-0"],[1,"table-light"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"mobile-cards-container","d-block","d-md-none","p-3"],["class","product-card mb-3",4,"ngFor","ngForOf","ngForTrackBy"],["role","alert",1,"alert","alert-warning","d-flex","align-items-center"],[1,"bi","bi-exclamation-triangle-fill","me-2"],[1,"flex-grow-1"],[1,"ms-3"],[1,"btn","btn-outline-secondary","btn-sm","me-2",3,"disabled","click"],[1,"bi","bi-x-lg","me-1"],[1,"btn","btn-danger","btn-sm",3,"disabled","click"],["class","bi bi-save me-1",4,"ngIf"],[1,"bi","bi-save","me-1"],[1,"row","mt-3"],[1,"d-flex","justify-content-between","align-items-center"],[1,"d-flex","align-items-center","gap-3"],[1,"badge","bg-success","fs-6"],[1,"bi","bi-check-circle","me-1"],["title","Actualizar stocks de productos con los valores contados",1,"btn","btn-warning","btn-sm",3,"disabled","click"],["class","bi bi-arrow-repeat me-1",4,"ngIf"],[1,"text-muted"],[1,"bi","bi-arrow-repeat","me-1"],[1,"bi","bi-funnel","me-2"],[1,"row","g-3"],[1,"col-12","col-sm-6","col-md-4","col-lg-3"],[1,"card","familia-filter-card","cursor-pointer","h-100",3,"click"],[1,"card-body","text-center","p-3"],[1,"d-flex","flex-column","align-items-center"],[1,"rounded-circle","bg-primary","bg-opacity-10","p-3","mb-2"],[1,"bi","bi-grid-3x3-gap","text-primary","fs-4"],[1,"card-title","mb-1","fw-bold"],[1,"d-flex","flex-column","gap-1"],[1,"badge","bg-primary","rounded-pill"],[1,"text-success","fw-bold"],["class","col-12 col-sm-6 col-md-4 col-lg-3",4,"ngFor","ngForOf","ngForTrackBy"],[1,"rounded-circle","bg-info","bg-opacity-10","p-3","mb-2"],[1,"bi","bi-collection","text-info","fs-4"],[1,"badge","bg-info","rounded-pill"],[1,"text-success"],[1,"badge","bg-warning","ms-2"],[1,"badge","bg-success","ms-2"],[1,"badge","bg-info","ms-2"],[1,"mt-2"],[1,"d-flex","flex-wrap","gap-2","align-items-center"],["class","badge bg-primary",4,"ngIf"],["class","badge bg-info",4,"ngIf"],["type","button",1,"btn","btn-link","btn-sm","p-0","text-decoration-none",3,"click"],[1,"badge","bg-primary"],[1,"bi","bi-search","me-1"],[1,"badge","bg-info"],[1,"bi","bi-collection","me-1"],[1,"badge","bg-primary","rounded-pill","mt-1"],[1,"text-info","mt-1"],["type","number","step","0.1","min","0","placeholder","Ingrese cantidad contada",1,"form-control","form-control-sm",3,"ngModel","disabled","ngModelChange"],[3,"class",4,"ngIf"],[1,"product-card","mb-3"],[1,"card-body","p-3"],[1,"d-flex","justify-content-between","align-items-start","mb-2"],[1,"text-info"],[1,"bi","bi-building","me-1"],[1,"row","g-2","mb-3"],[1,"col-6"],[1,"bg-light","rounded","p-2","text-center"],[1,"text-muted","d-block"],[1,"fw-bold"],[1,"form-label","small","text-muted","mb-1"],["type","number","step","0.1","min","0","placeholder","Ingrese cantidad contada",1,"form-control",3,"ngModel","disabled","ngModelChange"],["class","d-block mt-1",3,"class",4,"ngIf"],[1,"fs-5"],[1,"d-block","mt-1"],["role","status",1,"spinner-border","text-danger","mb-3"],[1,"visually-hidden"],[1,"col-md-6","mb-3"],[1,"card","h-100","cursor-pointer","categoria-card",3,"click"],[1,"d-flex","align-items-center"],[1,"rounded-circle","p-2","me-3"],[1,"mb-1"],["class","mt-1",4,"ngIf"],[1,"ms-2"],[1,"bi","fs-5"],[1,"mt-1"],[1,"alert","alert-success"],[1,"mb-2"],[1,"bi","bi-check-circle","me-2"],["class","mt-3",4,"ngIf"],[1,"mt-3"],[1,"d-flex","flex-wrap","gap-2"],["class","badge bg-primary","style","font-size: 0.85rem; padding: 6px 12px",4,"ngFor","ngForOf"],[1,"badge","bg-primary",2,"font-size","0.85rem","padding","6px 12px"],[1,"bi","bi-plus","me-2"],[1,"text-center","py-4"],["role","status",1,"spinner-border","text-danger"],[1,"text-muted","mt-2"],[1,"table-responsive"],[1,"table","table-hover"],[4,"ngFor","ngForOf"],[1,"badge"],[1,"bi"],[1,"btn-group","btn-group-sm"],["title","Cargar este inventario",1,"btn","btn-outline-primary",3,"click"],[1,"bi","bi-eye"],["title","Eliminar inventario",1,"btn","btn-outline-danger",3,"disabled","click"],[1,"bi","bi-trash"],[1,"bi","bi-archive","text-muted",2,"font-size","3rem"],[1,"text-muted","mt-3"],[1,"alert","alert-info"],[1,"bi","bi-info-circle","me-2"],[1,"table-responsive",2,"max-height","400px","overflow-y","auto"],[1,"table","table-sm","table-hover"],[1,"table-light","sticky-top"],["width","50"],["type","checkbox",1,"form-check-input",3,"checked","change"],[1,"badge","bg-secondary"],["role","status",1,"spinner-border","text-primary"],[1,"bi","bi-search","text-muted",2,"font-size","3rem"]],template:function(e,o){1&e&&(t.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3"),t.EFF(4,"Gesti\xf3n de Inventario"),t.k0s(),t.j41(5,"span"),t.EFF(6,"Control y conteo de stock por fechas"),t.k0s()(),t.j41(7,"div",3)(8,"div",4)(9,"button",5),t.bIt("click",function(){return o.abrirModalHistorial()}),t.nrm(10,"i",6),t.EFF(11," Historial "),t.k0s(),t.j41(12,"button",7),t.bIt("click",function(){return o.abrirModalAgregarProductos()}),t.nrm(13,"i",8),t.EFF(14," Agregar Productos "),t.k0s(),t.j41(15,"button",9),t.bIt("click",function(){return o.abrirModalNuevoInventario()}),t.nrm(16,"i",10),t.EFF(17," Nuevo Inventario "),t.k0s()()()(),t.j41(18,"div",11)(19,"div",12)(20,"div",13)(21,"div",14)(22,"div",15)(23,"div",16)(24,"label",17),t.EFF(25,"Fecha del Inventario"),t.k0s(),t.nrm(26,"input",18),t.nI1(27,"date"),t.k0s(),t.j41(28,"div",16)(29,"label",17),t.EFF(30,"Categor\xeda"),t.k0s(),t.j41(31,"select",19)(32,"option",20),t.EFF(33,"Todas las categor\xedas"),t.k0s(),t.DNE(34,w,2,2,"option",21),t.k0s()(),t.j41(35,"div",16)(36,"label",17),t.EFF(37,"Proveedor"),t.k0s(),t.j41(38,"select",19)(39,"option",20),t.EFF(40,"Todos los proveedores"),t.k0s(),t.DNE(41,T,2,2,"option",21),t.k0s()(),t.j41(42,"div",22)(43,"button",23),t.bIt("click",function(){return o.buscarInventario()}),t.DNE(44,$,1,0,"span",24),t.DNE(45,z,1,0,"i",25),t.EFF(46),t.k0s()()()()()()(),t.DNE(47,D,9,0,"div",26),t.DNE(48,ot,81,32,"div",27),t.DNE(49,it,10,0,"div",26),t.k0s(),t.j41(50,"div",28)(51,"div",29)(52,"div",30)(53,"div",31)(54,"h5",32),t.nrm(55,"i",33),t.EFF(56," Crear Nuevo Inventario "),t.k0s(),t.j41(57,"button",34),t.bIt("click",function(){return o.cerrarModalNuevoInventario()}),t.k0s()(),t.j41(58,"div",35)(59,"div",1)(60,"div",36)(61,"h6",37),t.nrm(62,"i",38),t.EFF(63," Selecciona la categor\xeda para el inventario: "),t.k0s(),t.j41(64,"div",1),t.DNE(65,at,14,11,"div",39),t.k0s()(),t.DNE(66,lt,13,3,"div",40),t.k0s()(),t.j41(67,"div",41)(68,"button",42),t.bIt("click",function(){return o.cerrarModalNuevoInventario()}),t.EFF(69," Cancelar "),t.k0s(),t.j41(70,"button",43),t.bIt("click",function(){return o.crearInventarioConSeleccion()}),t.DNE(71,dt,1,0,"span",24),t.DNE(72,gt,1,0,"i",44),t.EFF(73),t.k0s()()()()(),t.j41(74,"div",45)(75,"div",46)(76,"div",30)(77,"div",31)(78,"h5",32),t.nrm(79,"i",6),t.EFF(80," Historial de Inventarios "),t.k0s(),t.j41(81,"button",34),t.bIt("click",function(){return o.cerrarModalHistorial()}),t.k0s()(),t.j41(82,"div",35)(83,"div",47)(84,"div",48)(85,"label",17),t.EFF(86,"Categor\xeda"),t.k0s(),t.j41(87,"select",49),t.bIt("ngModelChange",function(a){return o.historialFiltroCategoria=a})("change",function(){return o.filtrarHistorial()}),t.j41(88,"option",20),t.EFF(89,"Todas las categor\xedas"),t.k0s(),t.DNE(90,ut,2,2,"option",21),t.k0s()(),t.j41(91,"div",48)(92,"label",17),t.EFF(93,"Estado"),t.k0s(),t.j41(94,"select",49),t.bIt("ngModelChange",function(a){return o.historialFiltroEstado=a})("change",function(){return o.filtrarHistorial()}),t.j41(95,"option",20),t.EFF(96,"Todos los estados"),t.k0s(),t.j41(97,"option",50),t.EFF(98,"Borrador"),t.k0s(),t.j41(99,"option",51),t.EFF(100,"Finalizado"),t.k0s()()(),t.j41(101,"div",48)(102,"label",17),t.EFF(103,"\xdaltimos"),t.k0s(),t.j41(104,"select",49),t.bIt("ngModelChange",function(a){return o.historialLimite=a})("change",function(){return o.cargarHistorial()}),t.j41(105,"option",52),t.EFF(106,"10 inventarios"),t.k0s(),t.j41(107,"option",53),t.EFF(108,"25 inventarios"),t.k0s(),t.j41(109,"option",54),t.EFF(110,"50 inventarios"),t.k0s(),t.j41(111,"option",55),t.EFF(112,"100 inventarios"),t.k0s()()()(),t.DNE(113,mt,6,0,"div",56),t.DNE(114,ft,19,1,"div",27),t.DNE(115,_t,6,0,"div",56),t.k0s(),t.j41(116,"div",41)(117,"button",42),t.bIt("click",function(){return o.cerrarModalHistorial()}),t.EFF(118," Cerrar "),t.k0s()()()()(),t.j41(119,"div",57)(120,"div",29)(121,"div",30)(122,"div",31)(123,"h5",32),t.nrm(124,"i",8),t.EFF(125," Agregar Productos al Inventario "),t.k0s(),t.j41(126,"button",34),t.bIt("click",function(){return o.cerrarModalAgregarProductos()}),t.k0s()(),t.j41(127,"div",35),t.DNE(128,vt,7,6,"div",58),t.j41(129,"div",37)(130,"label",59),t.EFF(131,"Buscar productos para agregar"),t.k0s(),t.j41(132,"input",60),t.bIt("ngModelChange",function(a){return o.busquedaProductosNuevos=a})("input",function(){return o.filtrarProductosNuevos()}),t.k0s()(),t.DNE(133,ht,20,3,"div",61),t.DNE(134,Pt,6,0,"div",56),t.DNE(135,Ot,7,2,"div",56),t.DNE(136,Ft,6,1,"div",62),t.k0s(),t.j41(137,"div",41)(138,"button",42),t.bIt("click",function(){return o.cerrarModalAgregarProductos()}),t.EFF(139," Cancelar "),t.k0s(),t.j41(140,"button",63),t.bIt("click",function(){return o.agregarProductosSeleccionados()}),t.DNE(141,kt,1,0,"span",24),t.DNE(142,It,1,0,"i",44),t.EFF(143),t.k0s()()()()()),2&e&&(t.R7$(9),t.Y8G("disabled",o.isLoading),t.R7$(3),t.Y8G("disabled",o.isLoading||!o.inventarioActual||"finalizado"===o.inventarioActual.estado),t.R7$(3),t.Y8G("disabled",o.isLoading),t.R7$(11),t.Y8G("formControl",o.fechaFiltro)("value",t.i5U(27,39,o.fechaSeleccionada,"yyyy-MM-dd")),t.R7$(5),t.Y8G("formControl",o.categoriaFiltro),t.R7$(3),t.Y8G("ngForOf",o.categorias),t.R7$(4),t.Y8G("formControl",o.proveedorFiltro),t.R7$(3),t.Y8G("ngForOf",o.proveedores),t.R7$(2),t.Y8G("disabled",o.isLoading),t.R7$(1),t.Y8G("ngIf",o.isLoading),t.R7$(1),t.Y8G("ngIf",!o.isLoading),t.R7$(1),t.SpI(" ",o.isLoading?"Buscando...":"Buscar"," "),t.R7$(1),t.Y8G("ngIf",!o.inventarioActual&&!o.isLoading),t.R7$(1),t.Y8G("ngIf",o.inventarioActual&&!o.isCreatingInventory),t.R7$(1),t.Y8G("ngIf",o.isCreatingInventory),t.R7$(16),t.Y8G("ngForOf",o.categorias),t.R7$(1),t.Y8G("ngIf",o.categoriaSeleccionada),t.R7$(4),t.Y8G("disabled",!o.categoriaSeleccionada||o.isCreatingInventory),t.R7$(1),t.Y8G("ngIf",o.isCreatingInventory),t.R7$(1),t.Y8G("ngIf",!o.isCreatingInventory),t.R7$(1),t.SpI(" ",o.isCreatingInventory?"Creando...":"Crear Inventario"," "),t.R7$(14),t.Y8G("ngModel",o.historialFiltroCategoria),t.R7$(3),t.Y8G("ngForOf",o.categorias),t.R7$(4),t.Y8G("ngModel",o.historialFiltroEstado),t.R7$(10),t.Y8G("ngModel",o.historialLimite),t.R7$(9),t.Y8G("ngIf",o.isLoadingHistorial),t.R7$(1),t.Y8G("ngIf",!o.isLoadingHistorial&&o.historialInventarios.length>0),t.R7$(1),t.Y8G("ngIf",!o.isLoadingHistorial&&0===o.historialInventarios.length),t.R7$(13),t.Y8G("ngIf",o.inventarioActual),t.R7$(4),t.Y8G("ngModel",o.busquedaProductosNuevos),t.R7$(1),t.Y8G("ngIf",o.productosDisponiblesParaAgregar.length>0),t.R7$(1),t.Y8G("ngIf",o.isLoadingProductosNuevos),t.R7$(1),t.Y8G("ngIf",0===o.productosDisponiblesParaAgregar.length&&!o.isLoadingProductosNuevos),t.R7$(1),t.Y8G("ngIf",o.productosSeleccionadosParaAgregar.size>0),t.R7$(4),t.Y8G("disabled",0===o.productosSeleccionadosParaAgregar.size||o.isAgregarProductos),t.R7$(1),t.Y8G("ngIf",o.isAgregarProductos),t.R7$(1),t.Y8G("ngIf",!o.isAgregarProductos),t.R7$(1),t.SpI(" ",o.isAgregarProductos?"Agregando...":"Agregar "+o.productosSeleccionadosParaAgregar.size+" Productos"," "))},dependencies:[C.Sq,C.bT,f.xH,f.y7,f.me,f.Q0,f.wz,f.BC,f.VZ,f.l_,f.vS,C.QX,C.oe,C.vh],styles:['.table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-size:.75rem;font-weight:600;text-transform:uppercase;letter-spacing:.5px;color:#6c757d;border-bottom:2px solid #dee2e6}.table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{vertical-align:middle;font-size:.875rem}.form-control-sm[_ngcontent-%COMP%]{font-size:.875rem}.badge[_ngcontent-%COMP%]{font-size:.75rem}.text-danger.fw-bold[_ngcontent-%COMP%]{color:#dc3545!important}.text-warning.fw-bold[_ngcontent-%COMP%]{color:#ffc107!important}.text-success.fw-bold[_ngcontent-%COMP%]{color:#198754!important}.card[_ngcontent-%COMP%]{transition:transform .2s ease-in-out}.card[_ngcontent-%COMP%]:hover{transform:translateY(-2px)}.spinner-border[_ngcontent-%COMP%]{width:2rem;height:2rem}@media (max-width: 768px){.form-control-sm[_ngcontent-%COMP%]{width:80px;font-size:.75rem}.table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-size:.65rem;padding:.5rem .25rem}.table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-size:.75rem;padding:.5rem .25rem}.card-header[_ngcontent-%COMP%]{padding:.75rem 1rem}.card-header[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{font-size:1rem}.card-header[_ngcontent-%COMP%]   .btn-sm[_ngcontent-%COMP%]{font-size:.75rem;padding:.25rem .5rem}}@media (max-width: 576px){.form-control-sm[_ngcontent-%COMP%]{width:60px;font-size:.7rem}.table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.25rem .1rem;font-size:.7rem}}.is-invalid[_ngcontent-%COMP%]{border-color:#dc3545;box-shadow:0 0 0 .2rem #dc354540}.family-filter-cards[_ngcontent-%COMP%]{margin-bottom:1.5rem}.family-filter-cards[_ngcontent-%COMP%]   .filter-title[_ngcontent-%COMP%]{color:var(--ion-color-dark);font-weight:600;margin-bottom:1rem;font-size:1.1rem}.family-filter-cards[_ngcontent-%COMP%]   .cards-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:1rem}@media (max-width: 768px){.family-filter-cards[_ngcontent-%COMP%]   .cards-container[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:.75rem}}@media (min-width: 1200px){.family-filter-cards[_ngcontent-%COMP%]   .cards-container[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fill,minmax(320px,1fr))}}.family-filter-cards[_ngcontent-%COMP%]   .family-card[_ngcontent-%COMP%]{background:white;border:2px solid #e9ecef;border-radius:12px;padding:1rem;cursor:pointer;transition:all .3s ease;box-shadow:0 2px 4px #0000000d}.family-filter-cards[_ngcontent-%COMP%]   .family-card[_ngcontent-%COMP%]:hover{border-color:var(--ion-color-primary);box-shadow:0 4px 12px #0000001a;transform:translateY(-2px)}.family-filter-cards[_ngcontent-%COMP%]   .family-card.active[_ngcontent-%COMP%]{border-color:var(--ion-color-primary);background:linear-gradient(135deg,var(--ion-color-primary-tint) 0%,white 100%);box-shadow:0 4px 16px rgba(var(--ion-color-primary-rgb),.2)}.family-filter-cards[_ngcontent-%COMP%]   .family-card.active[_ngcontent-%COMP%]   .family-icon[_ngcontent-%COMP%]{color:var(--ion-color-primary)}.family-filter-cards[_ngcontent-%COMP%]   .family-card.active[_ngcontent-%COMP%]   .family-name[_ngcontent-%COMP%]{color:var(--ion-color-primary);font-weight:600}.family-filter-cards[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;margin-bottom:.75rem}.family-filter-cards[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .family-icon[_ngcontent-%COMP%]{font-size:1.5rem;color:var(--ion-color-medium);transition:color .3s ease}.family-filter-cards[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .family-name[_ngcontent-%COMP%]{font-weight:500;color:var(--ion-color-dark);font-size:1rem;transition:all .3s ease;flex:1}.family-filter-cards[_ngcontent-%COMP%]   .card-stats[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}.family-filter-cards[_ngcontent-%COMP%]   .card-stats[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;font-size:.875rem}.family-filter-cards[_ngcontent-%COMP%]   .card-stats[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]   .stat-label[_ngcontent-%COMP%]{color:var(--ion-color-medium-shade);font-weight:500}.family-filter-cards[_ngcontent-%COMP%]   .card-stats[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]   .stat-value[_ngcontent-%COMP%]{font-weight:600}.family-filter-cards[_ngcontent-%COMP%]   .card-stats[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]   .stat-value.uncounted[_ngcontent-%COMP%]{color:var(--ion-color-warning);background:var(--ion-color-warning-tint);padding:.25rem .5rem;border-radius:12px;font-size:.75rem}.family-filter-cards[_ngcontent-%COMP%]   .card-stats[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]   .stat-value.cost[_ngcontent-%COMP%]{color:var(--ion-color-success);font-weight:700}.familia-filter-card[_ngcontent-%COMP%]{width:100%;max-width:100%}.familia-filter-card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]{padding:1rem;min-height:180px;display:flex;flex-direction:column;justify-content:center}@media (max-width: 768px){.familia-filter-card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]{padding:1rem;min-height:160px}.familia-filter-card[_ngcontent-%COMP%]   .rounded-circle[_ngcontent-%COMP%]{padding:.75rem}.familia-filter-card[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1.2rem}.familia-filter-card[_ngcontent-%COMP%]   .card-title[_ngcontent-%COMP%]{font-size:.9rem}.familia-filter-card[_ngcontent-%COMP%]   small.text-success[_ngcontent-%COMP%]{font-size:.7rem;line-height:1.2;word-break:break-word}}@media (max-width: 576px){.familia-filter-card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]{padding:.75rem;min-height:140px}.familia-filter-card[_ngcontent-%COMP%]   .rounded-circle[_ngcontent-%COMP%]{padding:.5rem}.familia-filter-card[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1rem}.familia-filter-card[_ngcontent-%COMP%]   .card-title[_ngcontent-%COMP%]{font-size:.85rem}.familia-filter-card[_ngcontent-%COMP%]   .badge[_ngcontent-%COMP%]{font-size:.7rem;padding:.3rem .6rem}.familia-filter-card[_ngcontent-%COMP%]   small.text-success[_ngcontent-%COMP%]{font-size:.65rem;line-height:1.1;word-break:break-word}.familia-filter-card[_ngcontent-%COMP%]   .d-flex.flex-column.gap-1[_ngcontent-%COMP%]{gap:.25rem}}input[type=number][_ngcontent-%COMP%]{text-align:center}input[type=number][_ngcontent-%COMP%]:focus{border-color:#dc3545;box-shadow:0 0 0 .2rem #dc354540}.bi-archive[_ngcontent-%COMP%]{opacity:.5}.btn-outline-danger[_ngcontent-%COMP%]:hover{background-color:#dc3545;border-color:#dc3545}.cursor-pointer[_ngcontent-%COMP%]{cursor:pointer}.area-card[_ngcontent-%COMP%], .categoria-card[_ngcontent-%COMP%], .familia-filter-card[_ngcontent-%COMP%]{transition:all .3s ease;border:2px solid transparent}.area-card[_ngcontent-%COMP%]:hover, .categoria-card[_ngcontent-%COMP%]:hover, .familia-filter-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 4px 12px #00000026}.area-card.selected[_ngcontent-%COMP%], .categoria-card.selected[_ngcontent-%COMP%], .familia-filter-card.selected[_ngcontent-%COMP%]{border-color:var(--bs-primary);background-color:#0d6efd0d;transform:translateY(-2px);box-shadow:0 8px 25px #0d6efd33}.area-card.selected[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%], .categoria-card.selected[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%], .familia-filter-card.selected[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]{background-color:transparent}.area-card.selected[_ngcontent-%COMP%]   .rounded-circle[_ngcontent-%COMP%], .categoria-card.selected[_ngcontent-%COMP%]   .rounded-circle[_ngcontent-%COMP%], .familia-filter-card.selected[_ngcontent-%COMP%]   .rounded-circle[_ngcontent-%COMP%]{background-color:#0d6efd26!important}.area-card.selected[_ngcontent-%COMP%]   i[_ngcontent-%COMP%], .categoria-card.selected[_ngcontent-%COMP%]   i[_ngcontent-%COMP%], .familia-filter-card.selected[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:var(--bs-primary)!important}.area-card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]{padding:2rem}.area-card[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{transition:transform .3s ease}.area-card[_ngcontent-%COMP%]:hover   i[_ngcontent-%COMP%]{transform:scale(1.1)}.categoria-card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]{padding:1rem}.btn-group[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{transition:all .2s ease}.btn-group[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:hover{transform:translateY(-1px)}@media (max-width: 768px){.area-card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]{padding:1.5rem}.btn-group[_ngcontent-%COMP%]{flex-wrap:wrap}.btn-group[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{margin-bottom:.5rem}}@media (max-width: 576px){.area-card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]{padding:1rem}.area-card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:2rem!important}.categoria-card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]{padding:.75rem}}.familia-pills-container[_ngcontent-%COMP%]{position:relative;margin-bottom:1rem;padding:0 .5rem}.familia-pills-scroll[_ngcontent-%COMP%]{display:flex;gap:.75rem;overflow-x:auto;padding:.75rem 0;scroll-behavior:smooth;-webkit-overflow-scrolling:touch;scrollbar-width:none;-ms-overflow-style:none}.familia-pills-scroll[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}.familia-pills-scroll[_ngcontent-%COMP%]:before, .familia-pills-scroll[_ngcontent-%COMP%]:after{content:"";position:absolute;top:0;bottom:0;width:20px;pointer-events:none;z-index:1}.familia-pills-scroll[_ngcontent-%COMP%]:before{left:0;background:linear-gradient(to right,rgb(255,255,255),rgba(255,255,255,0))}.familia-pills-scroll[_ngcontent-%COMP%]:after{right:0;background:linear-gradient(to left,rgb(255,255,255),rgba(255,255,255,0))}.familia-pill[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;padding:.5rem 1rem;background:#f8f9fa;border:1.5px solid #e9ecef;border-radius:25px;cursor:pointer;transition:all .3s ease;white-space:nowrap;flex-shrink:0;min-height:40px;-webkit-user-select:none;user-select:none}.familia-pill[_ngcontent-%COMP%]   .pill-text[_ngcontent-%COMP%]{font-size:.875rem;font-weight:500;color:#495057}.familia-pill[_ngcontent-%COMP%]   .pill-count[_ngcontent-%COMP%]{background:#6c757d;color:#fff;font-size:.75rem;font-weight:600;padding:.2rem .5rem;border-radius:12px;min-width:24px;text-align:center;line-height:1}.familia-pill[_ngcontent-%COMP%]:hover{background:#e9ecef;border-color:#adb5bd;transform:translateY(-1px);box-shadow:0 2px 8px #0000001a}.familia-pill.active[_ngcontent-%COMP%]{background:var(--bs-primary, #0d6efd);border-color:var(--bs-primary, #0d6efd);box-shadow:0 2px 12px #0d6efd4d}.familia-pill.active[_ngcontent-%COMP%]   .pill-text[_ngcontent-%COMP%]{color:#fff;font-weight:600}.familia-pill.active[_ngcontent-%COMP%]   .pill-count[_ngcontent-%COMP%]{background:rgba(255,255,255,.2);color:#fff;font-weight:700}.familia-pill.active[_ngcontent-%COMP%]:hover{transform:translateY(-1px);box-shadow:0 4px 16px #0d6efd66}.familia-pill[_ngcontent-%COMP%]:active{transform:scale(.98)}@media (max-width: 768px){.familia-pills-container[_ngcontent-%COMP%]{margin:0 -1rem 1rem;padding:0 1rem}.familia-pill[_ngcontent-%COMP%]{padding:.4rem .8rem;min-height:36px}.familia-pill[_ngcontent-%COMP%]   .pill-text[_ngcontent-%COMP%]{font-size:.8rem}.familia-pill[_ngcontent-%COMP%]   .pill-count[_ngcontent-%COMP%]{font-size:.7rem;padding:.15rem .4rem;min-width:20px}}@media (max-width: 576px){.familia-pills-scroll[_ngcontent-%COMP%]{gap:.5rem;padding:.5rem 0}.familia-pill[_ngcontent-%COMP%]{padding:.35rem .7rem;min-height:32px}.familia-pill[_ngcontent-%COMP%]   .pill-text[_ngcontent-%COMP%]{font-size:.75rem}.familia-pill[_ngcontent-%COMP%]   .pill-count[_ngcontent-%COMP%]{font-size:.65rem;padding:.1rem .35rem;min-width:18px}}.container-fluid[_ngcontent-%COMP%]{padding-left:.75rem;padding-right:.75rem;max-width:100%;overflow-x:hidden}*[_ngcontent-%COMP%]{-webkit-tap-highlight-color:transparent}@media (max-width: 576px){.btn[_ngcontent-%COMP%]{touch-action:manipulation}.row[_ngcontent-%COMP%]:first-child{margin-bottom:1rem}.row[_ngcontent-%COMP%]:first-child   h3[_ngcontent-%COMP%]{font-size:1.5rem;margin-bottom:.25rem}.row[_ngcontent-%COMP%]:first-child   span[_ngcontent-%COMP%]{font-size:.875rem;color:#6c757d}.card-body[_ngcontent-%COMP%]{padding:.75rem}.form-label[_ngcontent-%COMP%]{font-size:.8rem;margin-bottom:.25rem}.form-control[_ngcontent-%COMP%], .form-select[_ngcontent-%COMP%]{font-size:.875rem;padding:.375rem .5rem}}input[type=number][_ngcontent-%COMP%]{-moz-appearance:textfield}input[type=number][_ngcontent-%COMP%]::-webkit-outer-spin-button, input[type=number][_ngcontent-%COMP%]::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}.scroll-indicator[_ngcontent-%COMP%]{position:absolute;right:0;top:50%;transform:translateY(-50%);background:linear-gradient(to left,rgba(255,255,255,.9),rgba(255,255,255,0));padding:.5rem .75rem .5rem 1.5rem;pointer-events:none;z-index:2}.scroll-indicator[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#6c757d;font-size:.875rem;animation:_ngcontent-%COMP%_bounce-horizontal 2s infinite}@keyframes _ngcontent-%COMP%_bounce-horizontal{0%,20%,50%,80%,to{transform:translate(0)}40%{transform:translate(3px)}60%{transform:translate(1px)}}.table-responsive[_ngcontent-%COMP%]{overflow-x:auto;-webkit-overflow-scrolling:touch;border-radius:.5rem}.table-responsive[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{min-width:100%;margin-bottom:0}.table-responsive[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .table-responsive[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{vertical-align:middle;white-space:nowrap}.table-responsive[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:first-child, .table-responsive[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:first-child{min-width:200px;white-space:normal}.table-responsive[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:nth-child(2), .table-responsive[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-child(2){min-width:100px}.table-responsive[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:nth-child(3), .table-responsive[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-child(3){min-width:120px}.table-responsive[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:nth-child(4), .table-responsive[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-child(4){min-width:150px}.table-responsive[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:nth-child(5), .table-responsive[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-child(5){min-width:120px}@media (max-width: 768px){.table-responsive[_ngcontent-%COMP%]{font-size:.875rem}.table-responsive[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .table-responsive[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.5rem .25rem;font-size:.875rem}.table-responsive[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:first-child, .table-responsive[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:first-child{min-width:180px}.table-responsive[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:nth-child(2), .table-responsive[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:nth-child(3), .table-responsive[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:nth-child(4), .table-responsive[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:nth-child(5), .table-responsive[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-child(2), .table-responsive[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-child(3), .table-responsive[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-child(4), .table-responsive[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-child(5){min-width:90px}}@media (max-width: 576px){.table-responsive[_ngcontent-%COMP%]{font-size:.8rem}.table-responsive[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .table-responsive[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.375rem .2rem;font-size:.8rem}.table-responsive[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:first-child, .table-responsive[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:first-child{min-width:160px}.table-responsive[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:nth-child(2), .table-responsive[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:nth-child(3), .table-responsive[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:nth-child(4), .table-responsive[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:nth-child(5), .table-responsive[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-child(2), .table-responsive[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-child(3), .table-responsive[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-child(4), .table-responsive[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-child(5){min-width:80px}}.mobile-cards-container[_ngcontent-%COMP%]{background-color:var(--bg-body)}.mobile-cards-container[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]{background-color:var(--bg-card);border:1px solid var(--border-color);border-radius:12px;transition:transform .2s ease,box-shadow .2s ease;color:var(--text-primary)}.mobile-cards-container[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 4px 12px #00000026!important}.mobile-cards-container[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]{background-color:var(--bg-card)}.mobile-cards-container[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .card-title[_ngcontent-%COMP%]{color:var(--text-primary);font-size:1.1rem}.mobile-cards-container[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .badge[_ngcontent-%COMP%]{font-size:.75rem;padding:.4rem .8rem}.mobile-cards-container[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .bg-light[_ngcontent-%COMP%]{background-color:var(--bg-surface)!important;border:1px solid var(--border-color)}.mobile-cards-container[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .bg-light[_ngcontent-%COMP%]   .text-muted[_ngcontent-%COMP%]{color:var(--text-secondary)!important;font-size:.7rem;font-weight:600;text-transform:uppercase;letter-spacing:.5px}.mobile-cards-container[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .bg-light[_ngcontent-%COMP%]   .fw-bold[_ngcontent-%COMP%]{font-size:.95rem;color:var(--text-primary)}.mobile-cards-container[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{background-color:var(--input-bg);border:2px solid var(--input-border);color:var(--text-primary);border-radius:8px;padding:.75rem;font-size:1rem}.mobile-cards-container[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]:focus{background-color:var(--input-bg);border-color:var(--color-principal);color:var(--text-primary);box-shadow:0 0 0 .2rem rgba(var(--color-principal),.25)}.mobile-cards-container[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]::placeholder{color:var(--text-secondary)}.mobile-cards-container[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .form-control.is-invalid[_ngcontent-%COMP%]{border-color:#dc3545}.mobile-cards-container[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .form-control.is-invalid[_ngcontent-%COMP%]:focus{border-color:#dc3545;box-shadow:0 0 0 .2rem #dc354540}.mobile-cards-container[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .form-label[_ngcontent-%COMP%]{color:var(--text-primary);font-weight:600;margin-bottom:.5rem}.mobile-cards-container[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .mobile-cards-container[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], .mobile-cards-container[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{color:var(--text-primary)}.mobile-cards-container[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .text-muted[_ngcontent-%COMP%]{color:var(--text-secondary)!important}body.dark-mode[_ngcontent-%COMP%]   .mobile-cards-container[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]:hover{box-shadow:0 4px 12px #ffffff1a!important}@media (min-width: 768px){.table-responsive[_ngcontent-%COMP%]{border-radius:12px;overflow:hidden;box-shadow:0 2px 8px #0000001a;background-color:var(--bg-card);border:1px solid var(--border-color)}.table-responsive[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]{margin-bottom:0;background-color:var(--bg-card);color:var(--text-primary)}.table-responsive[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:var(--bg-surface);color:var(--text-primary);border-bottom:2px solid var(--border-color);font-weight:600;text-transform:uppercase;font-size:.8rem;letter-spacing:.5px;padding:1rem .75rem}.table-responsive[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:first-child{min-width:200px;white-space:normal}.table-responsive[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:nth-child(2){min-width:120px}.table-responsive[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:nth-child(3){min-width:100px}.table-responsive[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:nth-child(4){min-width:120px}.table-responsive[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:nth-child(5){min-width:150px}.table-responsive[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{color:var(--text-primary);border-bottom:1px solid var(--border-color);padding:.75rem;vertical-align:middle}.table-responsive[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{background-color:var(--input-bg);border:1px solid var(--input-border);color:var(--text-primary)}.table-responsive[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]:focus{background-color:var(--input-bg);border-color:var(--color-principal);color:var(--text-primary);box-shadow:0 0 0 .2rem rgba(var(--color-principal),.25)}.table-responsive[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]::placeholder{color:var(--text-secondary)}.table-responsive[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .badge[_ngcontent-%COMP%]{color:#fff}.table-responsive[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .text-muted[_ngcontent-%COMP%]{color:var(--text-secondary)!important}.table-responsive[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{transition:background-color .2s ease}.table-responsive[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:var(--bg-surface)}}body.dark-mode[_ngcontent-%COMP%]   .table-responsive[_ngcontent-%COMP%]{box-shadow:0 2px 8px #0000004d}body.dark-mode[_ngcontent-%COMP%]   .table-responsive[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:var(--bg-surface)}.product-card[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeInUp .3s ease forwards}@keyframes _ngcontent-%COMP%_fadeInUp{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}.text-success[_ngcontent-%COMP%]{color:#28a745!important;font-weight:600}.text-warning[_ngcontent-%COMP%]{color:#ffc107!important;font-weight:600}.text-danger[_ngcontent-%COMP%]{color:#dc3545!important;font-weight:600}']})}}return i})()}];let yt=(()=>{class i{static{this.\u0275fac=function(e){return new(e||i)}}static{this.\u0275mod=t.$C({type:i})}static{this.\u0275inj=t.G2t({imports:[E.iI.forChild(xt),E.iI]})}}return i})(),Et=(()=>{class i{static{this.\u0275fac=function(e){return new(e||i)}}static{this.\u0275mod=t.$C({type:i})}static{this.\u0275inj=t.G2t({imports:[yt,A.PrivateModule,C.MD,f.X1,f.YN]})}}return i})()}}]);