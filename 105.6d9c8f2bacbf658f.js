"use strict";(self.webpackChunkrigel=self.webpackChunkrigel||[]).push([[105],{7105:(R,d,t)=>{t.r(d),t.d(d,{ProfileModule:()=>G});var f=t(177),m=t(5743),a=t(9417),g=t(467),s=t(9173),p=t(8359),F=t(8032),u=t.n(F),i=t(7705);function b(n,c){1&n&&(i.j41(0,"div",1)(1,"div",2)(2,"div",54),i.nrm(3,"i",55),i.j41(4,"div")(5,"h6",4),i.EFF(6,"Configuraci\xf3n Requerida"),i.k0s(),i.j41(7,"p",11),i.EFF(8,"Debes completar la informaci\xf3n de tu restaurante para acceder a todas las funcionalidades del sistema."),i.k0s()()()()())}function v(n,c){1&n&&(i.j41(0,"span",56),i.nrm(1,"i",57),i.EFF(2," Configurado "),i.k0s())}function E(n,c){1&n&&(i.j41(0,"span",58),i.nrm(1,"i",59),i.EFF(2," Editando "),i.k0s())}function h(n,c){if(1&n){const e=i.RV6();i.j41(0,"button",60),i.bIt("click",function(){i.eBV(e);const o=i.XpG();return i.Njj(o.activarEdicion())}),i.nrm(1,"i",59),i.EFF(2," Editar "),i.k0s()}}function k(n,c){if(1&n){const e=i.RV6();i.j41(0,"button",68),i.bIt("click",function(){i.eBV(e);const o=i.XpG(2);return i.Njj(o.cancelarEdicion())}),i.nrm(1,"i",69),i.EFF(2," Cancelar "),i.k0s()}if(2&n){const e=i.XpG(2);i.Y8G("disabled",e.guardando)}}function P(n,c){1&n&&i.nrm(0,"span",70)}function C(n,c){1&n&&i.nrm(0,"i",71)}function j(n,c){1&n&&i.nrm(0,"i",72)}function y(n,c){if(1&n&&(i.j41(0,"div",61)(1,"div",62),i.DNE(2,k,3,1,"button",63),i.j41(3,"button",64),i.DNE(4,P,1,0,"span",65),i.DNE(5,C,1,0,"i",66),i.DNE(6,j,1,0,"i",67),i.EFF(7),i.k0s()()()),2&n){const e=i.XpG();i.R7$(2),i.Y8G("ngIf",!e.esPrimeraConfiguracion&&e.modoEdicion),i.R7$(1),i.AVh("btn-danger",e.esPrimeraConfiguracion)("btn-success",!e.esPrimeraConfiguracion&&e.modoEdicion),i.Y8G("disabled",!e.configuracionForm.valid||e.guardando),i.R7$(1),i.Y8G("ngIf",e.guardando),i.R7$(1),i.Y8G("ngIf",!e.guardando&&e.esPrimeraConfiguracion),i.R7$(1),i.Y8G("ngIf",!e.guardando&&!e.esPrimeraConfiguracion&&e.modoEdicion),i.R7$(1),i.SpI(" ",e.guardando?e.esPrimeraConfiguracion?"Guardando...":"Guardando cambios...":e.esPrimeraConfiguracion?"Guardar Configuraci\xf3n":"Guardar Cambios"," ")}}const x=[{path:"",component:(()=>{class n{constructor(e,r){this.fb=e,this.firestore=r,this.guardando=!1,this.configuracionExistente=null,this.esPrimeraConfiguracion=!1,this.modoEdicion=!1,this.subscriptions=new p.yU,this.inicializarForm()}ngOnInit(){this.cargarConfiguracion()}ngOnDestroy(){this.subscriptions.unsubscribe()}inicializarForm(){this.configuracionForm=this.fb.group({nombreRestaurante:["",[a.k0.required]],razonSocial:["",[a.k0.required]],cif:["",[a.k0.required]],telefono:["",[a.k0.required]],email:["",[a.k0.required,a.k0.email]],sitioWeb:[""],direccion:["",[a.k0.required]],codigoPostal:["",[a.k0.required]],ciudad:["",[a.k0.required]],provincia:["",[a.k0.required]]})}cargarConfiguracion(){const e=(0,s.collection)(this.firestore,"configuracion"),r=(0,s.query)(e,(0,s.limit)(1));this.subscriptions.add((0,s.collectionData)(r,{idField:"id"}).subscribe(o=>{o.length>0?(this.configuracionExistente=o[0],this.configuracionExistente&&(this.configuracionForm.patchValue(this.configuracionExistente),this.esPrimeraConfiguracion=!1,this.configuracionForm.disable())):(this.esPrimeraConfiguracion=!0,this.mostrarMensajePrimeraConfiguracion())}))}mostrarMensajePrimeraConfiguracion(){setTimeout(()=>{u().fire({title:"\xa1Bienvenido a Rigel!",html:'\n          <div class="text-start">\n            <p class="mb-3">Para comenzar a usar el sistema, necesitamos que configures la informaci\xf3n de tu restaurante.</p>\n            <div class="alert alert-info">\n              <i class="bi bi-info-circle me-2"></i>\n              <strong>Esta informaci\xf3n se usar\xe1 para:</strong>\n              <ul class="mt-2 mb-0">\n                <li>Generar albaranes y documentos</li>\n                <li>Identificar tu negocio en el sistema</li>\n                <li>Personalizar la experiencia</li>\n              </ul>\n            </div>\n            <p class="mb-0"><strong>Una vez completada, podr\xe1s acceder a todas las funcionalidades del sistema.</strong></p>\n          </div>\n        ',icon:"info",confirmButtonText:"Comenzar Configuraci\xf3n",confirmButtonColor:"#007bff",allowOutsideClick:!1,allowEscapeKey:!1})},500)}activarEdicion(){this.modoEdicion=!0,this.configuracionForm.enable()}cancelarEdicion(){this.modoEdicion=!1,this.configuracionForm.disable(),this.configuracionExistente&&this.configuracionForm.patchValue(this.configuracionExistente)}guardarConfiguracion(){var e=this;return(0,g.A)(function*(){if(!e.configuracionForm.valid)return void u().fire("Error","Por favor completa todos los campos requeridos","error");e.guardando=!0;const o={...e.configuracionForm.value,fechaActualizacion:new Date};try{if(e.configuracionExistente?.id){const l=(0,s.doc)(e.firestore,"configuracion",e.configuracionExistente.id);yield(0,s.updateDoc)(l,e.cleanObjectForFirebase(o)),e.modoEdicion=!1,e.configuracionForm.disable(),u().fire({title:"\xa1Perfil Actualizado!",text:"Los cambios se han guardado correctamente.",icon:"success",timer:2e3,showConfirmButton:!1})}else{o.fechaCreacion=new Date;const l=(0,s.collection)(e.firestore,"configuracion"),I=yield(0,s.addDoc)(l,e.cleanObjectForFirebase(o));e.configuracionExistente={...o,id:I.id},u().fire({title:"\xa1Perfil Creado!",text:"La configuraci\xf3n inicial se ha creado correctamente.",icon:"success",timer:2e3,showConfirmButton:!1})}}catch(l){console.error("Error al guardar configuraci\xf3n:",l),u().fire("Error","No se pudo guardar la configuraci\xf3n","error")}finally{e.guardando=!1}})()}cleanObjectForFirebase(e){const r={};for(const o in e)null!=e[o]&&(r[o]=e[o]instanceof Date||"object"!=typeof e[o]||Array.isArray(e[o])?e[o]:this.cleanObjectForFirebase(e[o]));return r}static{this.\u0275fac=function(r){return new(r||n)(i.rXU(a.ok),i.rXU(s.Firestore))}}static{this.\u0275cmp=i.VBU({type:n,selectors:[["app-profile-page"]],decls:111,vars:7,consts:[[1,"container-fluid","profile-page","py-4"],[1,"row"],[1,"col-12"],[1,"d-flex","justify-content-between","align-items-center","mb-4"],[1,"mb-1"],[1,"bi","bi-person-circle","me-2"],[1,"text-muted"],["class","row",4,"ngIf"],[1,"card","border-0","shadow-sm"],[1,"card-header","bg-white","border-0","py-3"],[1,"d-flex","justify-content-between","align-items-center"],[1,"mb-0"],[1,"d-flex","align-items-center","gap-2"],["class","badge bg-success",4,"ngIf"],["class","badge bg-warning",4,"ngIf"],["class","btn btn-sm btn-outline-primary",3,"click",4,"ngIf"],[1,"card-body"],[3,"formGroup","ngSubmit"],[1,"col-12","col-md-6","mb-3"],[1,"form-label"],["type","text","formControlName","nombreRestaurante","placeholder","Restaurante Ori\xf3n",1,"form-control"],["type","text","formControlName","razonSocial","placeholder","Ori\xf3n System S.L.",1,"form-control"],["type","text","formControlName","cif","placeholder","B12345678",1,"form-control"],["type","text","formControlName","telefono","placeholder","+34 91 123 4567",1,"form-control"],["type","email","formControlName","email","placeholder","info@orionsystem.com",1,"form-control"],["type","text","formControlName","sitioWeb","placeholder","www.orionsystem.com",1,"form-control"],[1,"mb-3"],["type","text","formControlName","direccion","placeholder","Calle Principal, 123",1,"form-control"],[1,"col-12","col-md-4","mb-3"],["type","text","formControlName","codigoPostal","placeholder","28001",1,"form-control"],["type","text","formControlName","ciudad","placeholder","Madrid",1,"form-control"],["formControlName","provincia",1,"form-select"],["value",""],["value","Madrid"],["value","Barcelona"],["value","Valencia"],["value","Sevilla"],["value","Zaragoza"],["value","M\xe1laga"],["value","Murcia"],["value","Palma"],["value","Las Palmas"],["value","Bilbao"],["value","Alicante"],["value","C\xf3rdoba"],["value","Valladolid"],["value","Vigo"],["value","Gij\xf3n"],["value","Hospitalet"],["value","Vitoria"],["value","A Coru\xf1a"],["value","Elche"],["value","Granada"],["class","d-flex justify-content-end mt-4",4,"ngIf"],[1,"alert","alert-warning","d-flex","align-items-center","mb-4"],[1,"bi","bi-exclamation-triangle-fill","me-3","fs-4"],[1,"badge","bg-success"],[1,"bi","bi-check-circle","me-1"],[1,"badge","bg-warning"],[1,"bi","bi-pencil","me-1"],[1,"btn","btn-sm","btn-outline-primary",3,"click"],[1,"d-flex","justify-content-end","mt-4"],[1,"d-flex","gap-2"],["type","button","class","btn btn-outline-secondary",3,"disabled","click",4,"ngIf"],["type","submit",1,"btn",3,"disabled"],["class","spinner-border spinner-border-sm me-2",4,"ngIf"],["class","bi bi-check me-2",4,"ngIf"],["class","bi bi-save me-2",4,"ngIf"],["type","button",1,"btn","btn-outline-secondary",3,"disabled","click"],[1,"bi","bi-x","me-2"],[1,"spinner-border","spinner-border-sm","me-2"],[1,"bi","bi-check","me-2"],[1,"bi","bi-save","me-2"]],template:function(r,o){1&r&&(i.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div")(5,"h3",4),i.nrm(6,"i",5),i.EFF(7," Mi Perfil "),i.k0s(),i.j41(8,"span",6),i.EFF(9),i.k0s()()()()(),i.DNE(10,b,9,0,"div",7),i.j41(11,"div",1)(12,"div",2)(13,"div",8)(14,"div",9)(15,"div",10)(16,"h5",11),i.EFF(17,"Informaci\xf3n del Restaurante"),i.k0s(),i.j41(18,"div",12),i.DNE(19,v,3,0,"span",13),i.DNE(20,E,3,0,"span",14),i.DNE(21,h,3,0,"button",15),i.k0s()()(),i.j41(22,"div",16)(23,"form",17),i.bIt("ngSubmit",function(){return o.guardarConfiguracion()}),i.j41(24,"div",1)(25,"div",18)(26,"label",19),i.EFF(27,"Nombre del Restaurante *"),i.k0s(),i.nrm(28,"input",20),i.k0s(),i.j41(29,"div",18)(30,"label",19),i.EFF(31,"Raz\xf3n Social *"),i.k0s(),i.nrm(32,"input",21),i.k0s()(),i.j41(33,"div",1)(34,"div",18)(35,"label",19),i.EFF(36,"CIF *"),i.k0s(),i.nrm(37,"input",22),i.k0s(),i.j41(38,"div",18)(39,"label",19),i.EFF(40,"Tel\xe9fono *"),i.k0s(),i.nrm(41,"input",23),i.k0s()(),i.j41(42,"div",1)(43,"div",18)(44,"label",19),i.EFF(45,"Email *"),i.k0s(),i.nrm(46,"input",24),i.k0s(),i.j41(47,"div",18)(48,"label",19),i.EFF(49,"Sitio Web"),i.k0s(),i.nrm(50,"input",25),i.k0s()(),i.j41(51,"div",26)(52,"label",19),i.EFF(53,"Direcci\xf3n *"),i.k0s(),i.nrm(54,"input",27),i.k0s(),i.j41(55,"div",1)(56,"div",28)(57,"label",19),i.EFF(58,"C\xf3digo Postal *"),i.k0s(),i.nrm(59,"input",29),i.k0s(),i.j41(60,"div",28)(61,"label",19),i.EFF(62,"Ciudad *"),i.k0s(),i.nrm(63,"input",30),i.k0s(),i.j41(64,"div",28)(65,"label",19),i.EFF(66,"Provincia *"),i.k0s(),i.j41(67,"select",31)(68,"option",32),i.EFF(69,"Seleccionar provincia"),i.k0s(),i.j41(70,"option",33),i.EFF(71,"Madrid"),i.k0s(),i.j41(72,"option",34),i.EFF(73,"Barcelona"),i.k0s(),i.j41(74,"option",35),i.EFF(75,"Valencia"),i.k0s(),i.j41(76,"option",36),i.EFF(77,"Sevilla"),i.k0s(),i.j41(78,"option",37),i.EFF(79,"Zaragoza"),i.k0s(),i.j41(80,"option",38),i.EFF(81,"M\xe1laga"),i.k0s(),i.j41(82,"option",39),i.EFF(83,"Murcia"),i.k0s(),i.j41(84,"option",40),i.EFF(85,"Palma"),i.k0s(),i.j41(86,"option",41),i.EFF(87,"Las Palmas"),i.k0s(),i.j41(88,"option",42),i.EFF(89,"Bilbao"),i.k0s(),i.j41(90,"option",43),i.EFF(91,"Alicante"),i.k0s(),i.j41(92,"option",44),i.EFF(93,"C\xf3rdoba"),i.k0s(),i.j41(94,"option",45),i.EFF(95,"Valladolid"),i.k0s(),i.j41(96,"option",46),i.EFF(97,"Vigo"),i.k0s(),i.j41(98,"option",47),i.EFF(99,"Gij\xf3n"),i.k0s(),i.j41(100,"option",48),i.EFF(101,"Hospitalet"),i.k0s(),i.j41(102,"option",49),i.EFF(103,"Vitoria"),i.k0s(),i.j41(104,"option",50),i.EFF(105,"A Coru\xf1a"),i.k0s(),i.j41(106,"option",51),i.EFF(107,"Elche"),i.k0s(),i.j41(108,"option",52),i.EFF(109,"Granada"),i.k0s()()()(),i.DNE(110,y,8,10,"div",53),i.k0s()()()()()()),2&r&&(i.R7$(9),i.SpI(" ",o.esPrimeraConfiguracion?"Completa la informaci\xf3n de tu restaurante":"Informaci\xf3n de tu restaurante"," "),i.R7$(1),i.Y8G("ngIf",o.esPrimeraConfiguracion),i.R7$(9),i.Y8G("ngIf",!o.esPrimeraConfiguracion&&!o.modoEdicion),i.R7$(1),i.Y8G("ngIf",!o.esPrimeraConfiguracion&&o.modoEdicion),i.R7$(1),i.Y8G("ngIf",!o.esPrimeraConfiguracion&&!o.modoEdicion),i.R7$(2),i.Y8G("formGroup",o.configuracionForm),i.R7$(87),i.Y8G("ngIf",o.esPrimeraConfiguracion||o.modoEdicion))},dependencies:[f.bT,a.qT,a.xH,a.y7,a.me,a.wz,a.BC,a.cb,a.j4,a.JD],styles:[".profile-page[_ngcontent-%COMP%]{min-height:calc(100vh - 60px)}"]})}}return n})()}];let G=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275mod=i.$C({type:n})}static{this.\u0275inj=i.G2t({imports:[f.MD,a.X1,m.iI.forChild(x)]})}}return n})()}}]);