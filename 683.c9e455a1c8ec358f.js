"use strict";(self.webpackChunkrigel=self.webpackChunkrigel||[]).push([[683],{3683:(ee,_,u)=>{u.r(_),u.d(_,{InventarioPageModule:()=>H});var C=u(2432),d=u(9417),m=u(177),I=u(9012),b=u(467),a=u(2418),k=u(8359),A=u(8032),v=u.n(A),e=u(7705),y=u(4441);function R(n,s){if(1&n&&(e.j41(0,"option",23),e.EFF(1),e.k0s()),2&n){const t=s.$implicit;e.Y8G("value",t.id),e.R7$(1),e.SpI(" ",t.nombre," ")}}function x(n,s){if(1&n&&(e.j41(0,"option",23),e.EFF(1),e.k0s()),2&n){const t=s.$implicit;e.Y8G("value",t.id),e.R7$(1),e.SpI(" ",t.nombre," ")}}function j(n,s){1&n&&e.nrm(0,"span",24)}function T(n,s){1&n&&e.nrm(0,"i",25)}function P(n,s){1&n&&(e.j41(0,"div",6)(1,"div",26)(2,"div",27)(3,"div",28),e.nrm(4,"i",29),e.k0s(),e.j41(5,"h4",30),e.EFF(6,"No hay inventario para esta fecha"),e.k0s(),e.j41(7,"p",31),e.EFF(8," Selecciona una fecha y crea un nuevo inventario o busca uno existente "),e.k0s()()()())}function S(n,s){1&n&&e.nrm(0,"span",24)}function $(n,s){1&n&&e.nrm(0,"i",63)}function w(n,s){if(1&n){const t=e.RV6();e.j41(0,"div",6)(1,"div",26)(2,"div",55),e.nrm(3,"i",56),e.j41(4,"div",57)(5,"strong"),e.EFF(6,"Inventario en borrador"),e.k0s(),e.EFF(7," - Este inventario no est\xe1 finalizado. Recuerda guardarlo o cancelarlo. "),e.k0s(),e.j41(8,"div",58)(9,"button",59),e.bIt("click",function(){e.eBV(t);const o=e.XpG(2);return e.Njj(o.cancelarInventario())}),e.nrm(10,"i",60),e.EFF(11," Cancelar "),e.k0s(),e.j41(12,"button",61),e.bIt("click",function(){e.eBV(t);const o=e.XpG(2);return e.Njj(o.guardarInventario())}),e.DNE(13,S,1,0,"span",19),e.DNE(14,$,1,0,"i",62),e.EFF(15),e.k0s()()()()()}if(2&n){const t=e.XpG(2);e.R7$(9),e.Y8G("disabled",t.isSaving),e.R7$(3),e.Y8G("disabled",t.isSaving),e.R7$(1),e.Y8G("ngIf",t.isSaving),e.R7$(1),e.Y8G("ngIf",!t.isSaving),e.R7$(1),e.SpI(" ",t.isSaving?"Guardando...":"Finalizar Inventario"," ")}}function G(n,s){if(1&n&&(e.j41(0,"div",64)(1,"div",26)(2,"div",46)(3,"span",65),e.nrm(4,"i",66),e.EFF(5," Inventario Finalizado "),e.k0s(),e.j41(6,"small",67),e.EFF(7),e.nI1(8,"date"),e.k0s()()()()),2&n){const t=e.XpG(2);e.R7$(7),e.SpI(" Finalizado el ",e.i5U(8,1,t.inventarioActual.fechaActualizacion,"dd/MM/yyyy HH:mm")," ")}}function O(n,s){1&n&&(e.j41(0,"span",68),e.EFF(1,"Borrador"),e.k0s())}function D(n,s){1&n&&(e.j41(0,"span",69),e.EFF(1,"Finalizado"),e.k0s())}function z(n,s){1&n&&e.nrm(0,"span",24)}function M(n,s){1&n&&e.nrm(0,"i",72)}function B(n,s){if(1&n){const t=e.RV6();e.j41(0,"div")(1,"button",59),e.bIt("click",function(){e.eBV(t);const o=e.XpG(2);return e.Njj(o.cancelarInventario())}),e.nrm(2,"i",60),e.EFF(3," Cancelar "),e.k0s(),e.j41(4,"button",70),e.bIt("click",function(){e.eBV(t);const o=e.XpG(2);return e.Njj(o.guardarInventario())}),e.DNE(5,z,1,0,"span",19),e.DNE(6,M,1,0,"i",71),e.EFF(7),e.k0s()()}if(2&n){const t=e.XpG(2);e.R7$(1),e.Y8G("disabled",t.isSaving),e.R7$(3),e.Y8G("disabled",t.isSaving),e.R7$(1),e.Y8G("ngIf",t.isSaving),e.R7$(1),e.Y8G("ngIf",!t.isSaving),e.R7$(1),e.SpI(" ",t.isSaving?"Finalizando...":"Finalizar Inventario"," ")}}function U(n,s){1&n&&(e.j41(0,"div")(1,"span",36),e.nrm(2,"i",73),e.EFF(3," Inventario finalizado - Solo lectura "),e.k0s()())}function Y(n,s){if(1&n&&(e.j41(0,"small"),e.EFF(1),e.nI1(2,"number"),e.k0s()),2&n){const t=e.XpG().$implicit;e.HbH(t.diferencia>0?"text-success":"text-danger"),e.R7$(1),e.Lme(" ",t.diferencia>0?"+":"","",e.i5U(2,4,t.diferencia,"1.1-1")," ")}}function N(n,s){if(1&n){const t=e.RV6();e.j41(0,"tr")(1,"td")(2,"div")(3,"strong"),e.EFF(4),e.k0s(),e.nrm(5,"br"),e.j41(6,"small",67),e.EFF(7),e.k0s()()(),e.j41(8,"td")(9,"span",74),e.EFF(10),e.k0s()(),e.j41(11,"td"),e.EFF(12),e.k0s(),e.j41(13,"td")(14,"span"),e.EFF(15),e.nI1(16,"number"),e.k0s()(),e.j41(17,"td"),e.EFF(18),e.nI1(19,"currency"),e.k0s(),e.j41(20,"td")(21,"input",75),e.bIt("ngModelChange",function(o){const r=e.eBV(t).$implicit;return e.Njj(r.stockContado=o)})("ngModelChange",function(){const c=e.eBV(t).$implicit,r=e.XpG(2);return e.Njj(r.calcularValorTotal(c))}),e.k0s(),e.DNE(22,Y,3,7,"small",76),e.k0s(),e.j41(23,"td")(24,"strong"),e.EFF(25),e.nI1(26,"currency"),e.k0s()()()}if(2&n){const t=s.$implicit,i=e.XpG(2);e.R7$(4),e.JRh(t.nombre),e.R7$(3),e.JRh(t.unidadMedida),e.R7$(3),e.JRh(t.categoria),e.R7$(2),e.JRh(t.proveedor),e.R7$(2),e.HbH(i.getStockClass(t.stockActual)),e.R7$(1),e.SpI(" ",e.i5U(16,16,t.stockActual,"1.1-1")," "),e.R7$(3),e.SpI(" ",e.ii3(19,19,t.costoUnitario,"EUR","symbol","1.2-2")," "),e.R7$(3),e.AVh("is-invalid",0!==t.diferencia),e.Y8G("ngModel",t.stockContado)("disabled","finalizado"===i.inventarioActual.estado),e.R7$(1),e.Y8G("ngIf",0!==t.diferencia),e.R7$(2),e.HbH(0!==t.diferencia?"text-warning":"text-success"),e.R7$(1),e.SpI(" ",e.ii3(26,24,t.valorTotal,"EUR","symbol","1.0-0")," ")}}function V(n,s){if(1&n&&(e.j41(0,"div"),e.DNE(1,w,16,5,"div",21),e.DNE(2,G,9,4,"div",32),e.j41(3,"div",6)(4,"div",33)(5,"div",8)(6,"div",34)(7,"div",35)(8,"span",36),e.EFF(9,"Inversi\xf3n Total"),e.k0s(),e.nrm(10,"i",37),e.k0s(),e.j41(11,"h3",38),e.EFF(12),e.nI1(13,"currency"),e.k0s()()()(),e.j41(14,"div",33)(15,"div",8)(16,"div",34)(17,"div",35)(18,"span",36),e.EFF(19,"Total Productos"),e.k0s(),e.nrm(20,"i",39),e.k0s(),e.j41(21,"h3",40),e.EFF(22),e.k0s()()()(),e.j41(23,"div",33)(24,"div",8)(25,"div",34)(26,"div",35)(27,"span",36),e.EFF(28,"Total Unidades"),e.k0s(),e.nrm(29,"i",41),e.k0s(),e.j41(30,"h3",42),e.EFF(31),e.nI1(32,"number"),e.k0s()()()(),e.j41(33,"div",33)(34,"div",8)(35,"div",34)(36,"div",35)(37,"span",36),e.EFF(38,"Costo Promedio"),e.k0s(),e.nrm(39,"i",43),e.k0s(),e.j41(40,"h3",44),e.EFF(41),e.nI1(42,"currency"),e.k0s()()()()(),e.j41(43,"div",6)(44,"div",26)(45,"div",8)(46,"div",45)(47,"div",46)(48,"h5",47),e.EFF(49),e.DNE(50,O,2,0,"span",48),e.DNE(51,D,2,0,"span",49),e.k0s(),e.DNE(52,B,8,5,"div",22),e.DNE(53,U,4,0,"div",22),e.k0s()(),e.j41(54,"div",50)(55,"div",51)(56,"table",52)(57,"thead",53)(58,"tr")(59,"th"),e.EFF(60,"PRODUCTO"),e.k0s(),e.j41(61,"th"),e.EFF(62,"CATEGOR\xcdA"),e.k0s(),e.j41(63,"th"),e.EFF(64,"PROVEEDOR"),e.k0s(),e.j41(65,"th"),e.EFF(66,"STOCK ACTUAL"),e.k0s(),e.j41(67,"th"),e.EFF(68,"COSTO UNITARIO"),e.k0s(),e.j41(69,"th"),e.EFF(70,"STOCK CONTADO"),e.k0s(),e.j41(71,"th"),e.EFF(72,"VALOR TOTAL"),e.k0s()()(),e.j41(73,"tbody"),e.DNE(74,N,27,29,"tr",54),e.k0s()()()()()()()()),2&n){const t=e.XpG();e.R7$(1),e.Y8G("ngIf","borrador"===t.inventarioActual.estado),e.R7$(1),e.Y8G("ngIf","finalizado"===t.inventarioActual.estado),e.R7$(10),e.SpI(" ",e.ii3(13,13,t.inventarioActual.inversionTotal,"EUR","symbol","1.0-0")," "),e.R7$(10),e.SpI(" ",t.inventarioActual.totalProductos," "),e.R7$(9),e.SpI(" ",e.i5U(32,18,t.inventarioActual.totalUnidades,"1.1-1")," "),e.R7$(10),e.SpI(" ",e.ii3(42,21,t.inventarioActual.costoPromedio,"EUR","symbol","1.0-0")," "),e.R7$(8),e.SpI(" Productos del Inventario (",t.inventarioActual.productos.length,") "),e.R7$(1),e.Y8G("ngIf","borrador"===t.inventarioActual.estado),e.R7$(1),e.Y8G("ngIf","finalizado"===t.inventarioActual.estado),e.R7$(1),e.Y8G("ngIf","borrador"===t.inventarioActual.estado),e.R7$(1),e.Y8G("ngIf","finalizado"===t.inventarioActual.estado),e.R7$(21),e.Y8G("ngForOf",t.inventarioActual.productos)("ngForTrackBy",t.trackByProducto)}}function X(n,s){1&n&&(e.j41(0,"div",6)(1,"div",26)(2,"div",27)(3,"div",77)(4,"span",78),e.EFF(5,"Cargando..."),e.k0s()(),e.j41(6,"h4",30),e.EFF(7,"Creando inventario..."),e.k0s(),e.j41(8,"p",67),e.EFF(9," Cargando productos y preparando el inventario para la fecha seleccionada "),e.k0s()()()())}const L=[{path:"",component:(()=>{class n{constructor(t,i){this.firestore=t,this.authService=i,this.isLoading=!1,this.isCreatingInventory=!1,this.isSaving=!1,this.inventarioActual=null,this.productos=[],this.categorias=[],this.proveedores=[],this.fechaSeleccionada=new Date,this.fechaFiltro=new d.MJ((new Date).toISOString().split("T")[0]),this.categoriaFiltro=new d.MJ(""),this.proveedorFiltro=new d.MJ(""),this.subscriptions=new k.yU}convertirFecha(t){if(t){if(t instanceof Date)return t;if("object"==typeof t&&"toDate"in t)return t.toDate();if("string"==typeof t)return new Date(t)}}limpiarObjetoParaFirebase(t){const i={};for(const[o,c]of Object.entries(t))null!=c&&(i[o]=c);return i}ngOnInit(){console.log("Inicializando p\xe1gina de inventario...");const t=this.authService.getCurrentUser();if(!t)return console.error("Usuario no autenticado"),void v().fire("Error","Usuario no autenticado","error");console.log("Usuario autenticado:",t.nombre),this.cargarDatosIniciales(),this.setupFiltros(),console.log("P\xe1gina de inventario inicializada correctamente")}ngOnDestroy(){this.subscriptions.unsubscribe()}setupFiltros(){this.subscriptions.add(this.fechaFiltro.valueChanges.subscribe(t=>{if(t)try{this.fechaSeleccionada=new Date(t),console.log("Fecha seleccionada:",this.fechaSeleccionada)}catch(i){console.error("Error procesando fecha:",i),this.fechaSeleccionada=new Date}}))}cargarDatosIniciales(){var t=this;return(0,b.A)(function*(){try{console.log("Cargando datos iniciales...");const i=(0,a.rJ)(t.firestore,"productos");t.subscriptions.add((0,a.xs)(i,{idField:"id"}).subscribe({next:r=>{t.productos=r.filter(f=>!f.esCombinado),console.log("Productos cargados:",t.productos.length)},error:r=>{console.error("Error cargando productos:",r)}}));const o=(0,a.rJ)(t.firestore,"categorias");t.subscriptions.add((0,a.xs)(o,{idField:"id"}).subscribe({next:r=>{t.categorias=r,console.log("Categor\xedas cargadas:",t.categorias.length)},error:r=>{console.error("Error cargando categor\xedas:",r)}}));const c=(0,a.rJ)(t.firestore,"proveedores");t.subscriptions.add((0,a.xs)(c,{idField:"id"}).subscribe({next:r=>{t.proveedores=r,console.log("Proveedores cargados:",t.proveedores.length)},error:r=>{console.error("Error cargando proveedores:",r)}}))}catch(i){console.error("Error cargando datos iniciales:",i),v().fire("Error","Error al cargar los datos iniciales","error")}})()}buscarInventario(){var t=this;return(0,b.A)(function*(){t.isLoading=!0;try{const i=t.fechaSeleccionada.toISOString().split("T")[0];console.log("Buscando inventario para fecha:",i);const o=(0,a.rJ)(t.firestore,"inventarios"),c=(0,a.P)(o,(0,a._M)("fecha","==",i));console.log("Ejecutando consulta...");const r=yield(0,a.GG)(c);if(console.log("Documentos encontrados:",r.size),r.empty)t.inventarioActual=null;else{const f=r.docs.filter(g=>!g.data().eliminado);if(f.length>0){const g=f[0];t.inventarioActual={id:g.id,...g.data()},t.inventarioActual.fecha=t.convertirFecha(t.inventarioActual.fecha)||t.inventarioActual.fecha,t.inventarioActual.fechaActualizacion=t.convertirFecha(t.inventarioActual.fechaActualizacion),t.inventarioActual.fechaCreacion=t.convertirFecha(t.inventarioActual.fechaCreacion)}else t.inventarioActual=null}}catch(i){console.error("Error buscando inventario:",i),t.inventarioActual=null}finally{t.isLoading=!1}})()}crearNuevoInventario(){var t=this;return(0,b.A)(function*(){if(!t.inventarioActual||(yield v().fire({title:"\xbfCrear nuevo inventario?",text:"Ya existe un inventario para esta fecha. \xbfDeseas reemplazarlo?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#dc3545",cancelButtonColor:"#6c757d",confirmButtonText:"S\xed, crear nuevo",cancelButtonText:"Cancelar"})).isConfirmed){t.isCreatingInventory=!0;try{let i=[...t.productos];const o=t.categoriaFiltro.value,c=t.proveedorFiltro.value;o&&(i=i.filter(l=>l.categoriaId===o)),c&&(i=i.filter(l=>l.proveedorId===c));const r=i.map(l=>{const h=t.categorias.find(F=>F.id===l.categoriaId),q=t.proveedores.find(F=>F.id===l.proveedorId);return{productoId:l.id,nombre:l.nombre,categoria:h?.nombre||"Sin categor\xeda",proveedor:q?.nombre||"Sin proveedor",stockActual:l.stock||0,stockContado:l.stock||0,costoUnitario:l.costo,valorTotal:(l.stock||0)*l.costo,unidadMedida:l.unidadMedida,diferencia:0}}),f=r.reduce((l,h)=>l+h.valorTotal,0),g=r.length,p=r.reduce((l,h)=>l+h.stockContado,0),E=p>0?f/p:0,Z={fecha:t.fechaSeleccionada.toISOString().split("T")[0],categoriaId:o||void 0,proveedorId:c||void 0,productos:r,inversionTotal:f,totalProductos:g,totalUnidades:p,costoPromedio:E,fechaCreacion:(0,a.O5)(),usuarioId:t.authService.getCurrentUser()?.id,estado:"borrador"},K=t.limpiarObjetoParaFirebase(Z),Q=(0,a.rJ)(t.firestore,"inventarios"),W=yield(0,a.gS)(Q,K);t.inventarioActual={id:W.id,fecha:t.fechaSeleccionada,categoriaId:o||void 0,proveedorId:c||void 0,productos:r,inversionTotal:f,totalProductos:g,totalUnidades:p,costoPromedio:E,fechaCreacion:new Date,usuarioId:t.authService.getCurrentUser()?.id,estado:"borrador"},v().fire("\xa1Creado!","Inventario creado como borrador. Puedes editarlo y luego finalizarlo.","success")}catch(i){console.error("Error creando inventario:",i),v().fire("Error","Error al crear el inventario","error")}finally{t.isCreatingInventory=!1}}})()}recalcularTotales(){this.inventarioActual&&(this.inventarioActual.inversionTotal=this.inventarioActual.productos.reduce((t,i)=>t+i.valorTotal,0),this.inventarioActual.totalUnidades=this.inventarioActual.productos.reduce((t,i)=>t+i.stockContado,0),this.inventarioActual.costoPromedio=this.inventarioActual.totalUnidades>0?this.inventarioActual.inversionTotal/this.inventarioActual.totalUnidades:0)}guardarInventario(){var t=this;return(0,b.A)(function*(){if(t.inventarioActual&&("borrador"!==t.inventarioActual.estado||(yield v().fire({title:"\xbfFinalizar inventario?",text:"Una vez finalizado, no podr\xe1s editarlo. \xbfEst\xe1s seguro?",icon:"question",showCancelButton:!0,confirmButtonColor:"#dc3545",cancelButtonColor:"#6c757d",confirmButtonText:"S\xed, finalizar",cancelButtonText:"Cancelar"})).isConfirmed)){t.isSaving=!0;try{const i={...t.inventarioActual,fecha:t.fechaSeleccionada.toISOString().split("T")[0],fechaActualizacion:(0,a.O5)(),estado:"finalizado"},o=t.limpiarObjetoParaFirebase(i);if(t.inventarioActual.id){const c=(0,a.H9)(t.firestore,"inventarios",t.inventarioActual.id);yield(0,a.mZ)(c,o),t.inventarioActual.estado="finalizado",t.inventarioActual.fechaActualizacion=new Date}else{const c=(0,a.rJ)(t.firestore,"inventarios"),r=yield(0,a.gS)(c,o);t.inventarioActual.id=r.id,t.inventarioActual.estado="finalizado"}v().fire("\xa1Finalizado!","Inventario finalizado exitosamente","success")}catch(i){console.error("Error finalizando inventario:",i),v().fire("Error","Error al finalizar el inventario","error")}finally{t.isSaving=!1}}})()}getStockClass(t){return t<=0?"text-danger fw-bold":t<=5?"text-warning fw-bold":"text-success fw-bold"}trackByProducto(t,i){return i.productoId}cancelarInventario(){var t=this;return(0,b.A)(function*(){if((yield v().fire({title:"\xbfCancelar inventario?",text:"Se eliminar\xe1 el inventario en borrador. Esta acci\xf3n no se puede deshacer.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#dc3545",cancelButtonColor:"#6c757d",confirmButtonText:"S\xed, cancelar",cancelButtonText:"No cancelar"})).isConfirmed){t.isSaving=!0;try{if(t.inventarioActual?.id){const o=(0,a.H9)(t.firestore,"inventarios",t.inventarioActual.id);yield(0,a.mZ)(o,{eliminado:!0,fechaEliminacion:(0,a.O5)()})}t.inventarioActual=null,v().fire("\xa1Cancelado!","El inventario ha sido cancelado","success")}catch(o){console.error("Error cancelando inventario:",o),v().fire("Error","Error al cancelar el inventario","error")}finally{t.isSaving=!1}}})()}calcularValorTotal(t){"finalizado"!==this.inventarioActual?.estado&&(t.diferencia=t.stockContado-t.stockActual,t.valorTotal=t.stockContado*t.costoUnitario,this.recalcularTotales(),"borrador"===this.inventarioActual?.estado&&this.autoGuardarBorrador())}autoGuardarBorrador(){this.autoSaveTimeout&&clearTimeout(this.autoSaveTimeout),this.autoSaveTimeout=setTimeout(()=>{this.guardarBorrador()},2e3)}guardarBorrador(){var t=this;return(0,b.A)(function*(){if(t.inventarioActual?.id&&"borrador"===t.inventarioActual.estado)try{const i=(0,a.H9)(t.firestore,"inventarios",t.inventarioActual.id);yield(0,a.mZ)(i,{productos:t.inventarioActual.productos,inversionTotal:t.inventarioActual.inversionTotal,totalUnidades:t.inventarioActual.totalUnidades,costoPromedio:t.inventarioActual.costoPromedio,fechaActualizacion:(0,a.O5)()})}catch(i){console.error("Error en auto-guardado:",i)}})()}static{this.\u0275fac=function(i){return new(i||n)(e.rXU(a._7),e.rXU(y.u))}}static{this.\u0275cmp=e.VBU({type:n,selectors:[["app-inventario-page"]],decls:43,vars:17,consts:[[1,"container-fluid"],[1,"row"],[1,"col-8"],[1,"col","text-end"],[1,"btn","btn-danger",3,"disabled","click"],[1,"bi","bi-plus-lg","me-2"],[1,"row","mt-4"],[1,"col"],[1,"card","border-0","shadow-sm"],[1,"card-body"],[1,"row","align-items-center"],[1,"col-12","col-md-3","mb-2","mb-md-0"],[1,"form-label","small","text-muted"],["type","date",1,"form-control",3,"formControl","value"],[1,"form-select",3,"formControl"],["value",""],[3,"value",4,"ngFor","ngForOf"],[1,"col-12","col-md-3","text-end","mt-4"],[1,"btn","btn-outline-danger","w-100",3,"disabled","click"],["class","spinner-border spinner-border-sm me-2",4,"ngIf"],["class","bi bi-search me-2",4,"ngIf"],["class","row mt-4",4,"ngIf"],[4,"ngIf"],[3,"value"],[1,"spinner-border","spinner-border-sm","me-2"],[1,"bi","bi-search","me-2"],[1,"col-12"],[1,"text-center","py-5"],[1,"mb-4"],[1,"bi","bi-archive","text-muted",2,"font-size","4rem"],[1,"text-muted","mb-3"],[1,"text-muted","mb-4"],["class","row mt-3",4,"ngIf"],[1,"col-12","col-md-3","mb-3"],[1,"card-body","text-center"],[1,"d-flex","justify-content-between","align-items-center","mb-2"],[1,"text-muted","small"],[1,"bi","bi-currency-euro","text-danger"],[1,"text-danger","fw-bold","mb-0"],[1,"bi","bi-box","text-info"],[1,"text-info","fw-bold","mb-0"],[1,"bi","bi-graph-up","text-success"],[1,"text-success","fw-bold","mb-0"],[1,"bi","bi-calculator","text-warning"],[1,"text-warning","fw-bold","mb-0"],[1,"card-header","bg-white","border-0","py-3"],[1,"d-flex","justify-content-between","align-items-center"],[1,"mb-0"],["class","badge bg-warning ms-2",4,"ngIf"],["class","badge bg-success ms-2",4,"ngIf"],[1,"card-body","p-0"],[1,"table-responsive"],[1,"table","table-hover","mb-0"],[1,"table-light"],[4,"ngFor","ngForOf","ngForTrackBy"],["role","alert",1,"alert","alert-warning","d-flex","align-items-center"],[1,"bi","bi-exclamation-triangle-fill","me-2"],[1,"flex-grow-1"],[1,"ms-3"],[1,"btn","btn-outline-secondary","btn-sm","me-2",3,"disabled","click"],[1,"bi","bi-x-lg","me-1"],[1,"btn","btn-warning","btn-sm",3,"disabled","click"],["class","bi bi-save me-1",4,"ngIf"],[1,"bi","bi-save","me-1"],[1,"row","mt-3"],[1,"badge","bg-success","fs-6"],[1,"bi","bi-check-circle","me-1"],[1,"text-muted"],[1,"badge","bg-warning","ms-2"],[1,"badge","bg-success","ms-2"],[1,"btn","btn-danger","btn-sm",3,"disabled","click"],["class","bi bi-save me-2",4,"ngIf"],[1,"bi","bi-save","me-2"],[1,"bi","bi-lock","me-1"],[1,"badge","bg-primary","rounded-pill"],["type","number","step","0.1","min","0",1,"form-control","form-control-sm",2,"width","100px",3,"ngModel","disabled","ngModelChange"],[3,"class",4,"ngIf"],["role","status",1,"spinner-border","text-danger","mb-3"],[1,"visually-hidden"]],template:function(i,o){1&i&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3"),e.EFF(4,"Gesti\xf3n de Inventario"),e.k0s(),e.j41(5,"span"),e.EFF(6,"Control y conteo de stock por fechas"),e.k0s()(),e.j41(7,"div",3)(8,"button",4),e.bIt("click",function(){return o.crearNuevoInventario()}),e.nrm(9,"i",5),e.EFF(10," Nuevo Inventario "),e.k0s()()(),e.j41(11,"div",6)(12,"div",7)(13,"div",8)(14,"div",9)(15,"div",10)(16,"div",11)(17,"label",12),e.EFF(18,"Fecha del Inventario"),e.k0s(),e.nrm(19,"input",13),e.nI1(20,"date"),e.k0s(),e.j41(21,"div",11)(22,"label",12),e.EFF(23,"Categor\xeda"),e.k0s(),e.j41(24,"select",14)(25,"option",15),e.EFF(26,"Todas las categor\xedas"),e.k0s(),e.DNE(27,R,2,2,"option",16),e.k0s()(),e.j41(28,"div",11)(29,"label",12),e.EFF(30,"Proveedor"),e.k0s(),e.j41(31,"select",14)(32,"option",15),e.EFF(33,"Todos los proveedores"),e.k0s(),e.DNE(34,x,2,2,"option",16),e.k0s()(),e.j41(35,"div",17)(36,"button",18),e.bIt("click",function(){return o.buscarInventario()}),e.DNE(37,j,1,0,"span",19),e.DNE(38,T,1,0,"i",20),e.EFF(39),e.k0s()()()()()()(),e.DNE(40,P,9,0,"div",21),e.DNE(41,V,75,26,"div",22),e.DNE(42,X,10,0,"div",21),e.k0s()),2&i&&(e.R7$(8),e.Y8G("disabled",o.isLoading),e.R7$(11),e.Y8G("formControl",o.fechaFiltro)("value",e.i5U(20,14,o.fechaSeleccionada,"yyyy-MM-dd")),e.R7$(5),e.Y8G("formControl",o.categoriaFiltro),e.R7$(3),e.Y8G("ngForOf",o.categorias),e.R7$(4),e.Y8G("formControl",o.proveedorFiltro),e.R7$(3),e.Y8G("ngForOf",o.proveedores),e.R7$(2),e.Y8G("disabled",o.isLoading),e.R7$(1),e.Y8G("ngIf",o.isLoading),e.R7$(1),e.Y8G("ngIf",!o.isLoading),e.R7$(1),e.SpI(" ",o.isLoading?"Buscando...":"Buscar"," "),e.R7$(1),e.Y8G("ngIf",!o.inventarioActual&&!o.isLoading),e.R7$(1),e.Y8G("ngIf",o.inventarioActual&&!o.isCreatingInventory),e.R7$(1),e.Y8G("ngIf",o.isCreatingInventory))},dependencies:[m.Sq,m.bT,d.xH,d.y7,d.me,d.Q0,d.wz,d.BC,d.VZ,d.l_,d.vS,m.QX,m.oe,m.vh],styles:[".table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-size:.75rem;font-weight:600;text-transform:uppercase;letter-spacing:.5px;color:#6c757d;border-bottom:2px solid #dee2e6}.table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{vertical-align:middle;font-size:.875rem}.form-control-sm[_ngcontent-%COMP%]{font-size:.875rem}.badge[_ngcontent-%COMP%]{font-size:.75rem}.text-danger.fw-bold[_ngcontent-%COMP%]{color:#dc3545!important}.text-warning.fw-bold[_ngcontent-%COMP%]{color:#ffc107!important}.text-success.fw-bold[_ngcontent-%COMP%]{color:#198754!important}.card[_ngcontent-%COMP%]{transition:transform .2s ease-in-out}.card[_ngcontent-%COMP%]:hover{transform:translateY(-2px)}.spinner-border[_ngcontent-%COMP%]{width:2rem;height:2rem}@media (max-width: 768px){.table-responsive[_ngcontent-%COMP%]{font-size:.8rem}.form-control-sm[_ngcontent-%COMP%]{width:80px!important}}.is-invalid[_ngcontent-%COMP%]{border-color:#dc3545;box-shadow:0 0 0 .2rem #dc354540}input[type=number][_ngcontent-%COMP%]{text-align:center}input[type=number][_ngcontent-%COMP%]:focus{border-color:#dc3545;box-shadow:0 0 0 .2rem #dc354540}.bi-archive[_ngcontent-%COMP%]{opacity:.5}.btn-outline-danger[_ngcontent-%COMP%]:hover{background-color:#dc3545;border-color:#dc3545}"]})}}return n})()}];let J=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=e.$C({type:n})}static{this.\u0275inj=e.G2t({imports:[I.iI.forChild(L),I.iI]})}}return n})(),H=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=e.$C({type:n})}static{this.\u0275inj=e.G2t({imports:[J,C.PrivateModule,m.MD,d.X1,d.YN]})}}return n})()}}]);