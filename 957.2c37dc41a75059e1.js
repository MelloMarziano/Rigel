"use strict";(self.webpackChunkrigel=self.webpackChunkrigel||[]).push([[957],{5957:(B,m,s)=>{s.r(m),s.d(m,{CategoriaPageModule:()=>S});var v=s(4520),n=s(4341),g=s(177),b=s(2559),p=s(467),l=s(2418),C=s(8032),c=s.n(C),e=s(2598);function k(i,u){if(1&i&&(e.j41(0,"span",77),e.EFF(1),e.k0s()),2&i){const t=u.$implicit;e.R7$(1),e.SpI(" ",t," ")}}function E(i,u){if(1&i){const t=e.RV6();e.j41(0,"div",62)(1,"div",8)(2,"div",63)(3,"div",64)(4,"div",44)(5,"div",65),e.nrm(6,"i"),e.k0s(),e.j41(7,"div")(8,"h5",66),e.EFF(9),e.k0s(),e.j41(10,"p",67),e.EFF(11),e.k0s()()(),e.j41(12,"div")(13,"button",68),e.bIt("click",function(){const r=e.eBV(t).$implicit,d=e.XpG();return e.Njj(r.id&&d.editarCategoria(r))}),e.nrm(14,"i",69),e.k0s(),e.j41(15,"button",70),e.bIt("click",function(){const r=e.eBV(t).$implicit,d=e.XpG();return e.Njj(r.id&&d.eliminarCategoria(r.id))}),e.nrm(16,"i",71),e.k0s()()(),e.j41(17,"div",29)(18,"div",44),e.nrm(19,"i",72),e.j41(20,"div")(21,"small",73),e.EFF(22,"Productos: "),e.j41(23,"span"),e.EFF(24),e.k0s()()()()(),e.j41(25,"div")(26,"small",74),e.EFF(27,"Unidades disponibles"),e.k0s(),e.j41(28,"div",75),e.DNE(29,k,2,1,"span",76),e.k0s()()()()()}if(2&i){const t=u.$implicit;e.R7$(5),e.xc7("background-color",t.colorFondo),e.R7$(1),e.HbH("bi "+t.icono+" text-white fs-4"),e.R7$(3),e.JRh(t.nombre),e.R7$(2),e.JRh(t.descripcion),e.R7$(2),e.Y8G("disabled",!t.id),e.R7$(2),e.Y8G("disabled",!t.id),e.R7$(9),e.JRh(t.productos),e.R7$(5),e.Y8G("ngForOf",t.unidadesDisponibles)}}function j(i,u){if(1&i){const t=e.RV6();e.j41(0,"button",78),e.bIt("click",function(){const r=e.eBV(t).$implicit,d=e.XpG();return e.Njj(d.seleccionarColor(r))}),e.k0s()}2&i&&e.xc7("background-color",u.$implicit)}function _(i,u){1&i&&(e.j41(0,"div",11),e.EFF(1," No hay unidades seleccionadas "),e.k0s())}function x(i,u){if(1&i){const t=e.RV6();e.j41(0,"span",80),e.EFF(1),e.j41(2,"button",81),e.bIt("click",function(){const r=e.eBV(t).$implicit,d=e.XpG(2);return e.Njj(d.eliminarUnidad(r))}),e.k0s()()}if(2&i){const t=u.$implicit;e.R7$(1),e.SpI(" ",t," ")}}function y(i,u){if(1&i&&(e.j41(0,"div",75),e.DNE(1,x,3,1,"span",79),e.k0s()),2&i){const t=e.XpG();e.R7$(1),e.Y8G("ngForOf",t.unidadesSeleccionadas)}}const D=function(){return{standalone:!0}},R=[{path:"",component:(()=>{class i{constructor(t,a){this.fb=t,this.firestore=a,this.stats={totalCategorias:0,totalProductos:0,unidadesMedida:0,productosCombo:0},this.categorias=[],this.mostrarPaleta=!1,this.nuevaUnidad="",this.unidadesSeleccionadas=[],this.coloresPaleta=["#DC3545","#B02A37","#6EA8FE","#031633","#F8F9FA","#FF4136","#FF851B","#FFDC00","#00D1B2","#0DCAF0","#0A58CA","#6610F2","#0D6EFD","#20C997","#FFC107"],this.unidadesBebidas=["ml","L","oz","unidades"],this.unidadesComida=["kg","g","lb","porciones","unidades"],this.categoriaForm=this.fb.group({nombre:["",n.k0.required],descripcion:["",n.k0.required],icono:["bi-cup-straw"],colorFondo:["#DC3545"]})}ngOnInit(){this.cargarCategorias()}ngOnDestroy(){this.categoriasSubscription&&this.categoriasSubscription.unsubscribe()}cargarCategorias(){const t=(0,l.rJ)(this.firestore,"categorias");this.categoriasSubscription=(0,l.xs)(t,{idField:"id"}).subscribe(a=>{this.categorias=a,this.actualizarStats()})}actualizarStats(){this.stats.totalCategorias=this.categorias.length,this.stats.totalProductos=this.categorias.reduce((t,a)=>t+a.productos,0),this.stats.unidadesMedida=[...new Set(this.categorias.flatMap(t=>t.unidadesDisponibles))].length,this.stats.productosCombo=0}seleccionarColor(t){this.categoriaForm.patchValue({colorFondo:t}),this.mostrarPaleta=!1}agregarUnidadPersonalizada(){this.nuevaUnidad&&!this.unidadesSeleccionadas.includes(this.nuevaUnidad)&&(this.unidadesSeleccionadas.push(this.nuevaUnidad),this.nuevaUnidad="")}seleccionarUnidadesBebidas(){this.unidadesBebidas.forEach(t=>{this.unidadesSeleccionadas.includes(t)||this.unidadesSeleccionadas.push(t)})}seleccionarUnidadesComida(){this.unidadesComida.forEach(t=>{this.unidadesSeleccionadas.includes(t)||this.unidadesSeleccionadas.push(t)})}eliminarUnidad(t){const a=this.unidadesSeleccionadas.indexOf(t);a>-1&&this.unidadesSeleccionadas.splice(a,1)}eliminarCategoria(t){var a=this;return(0,p.A)(function*(){if(t&&(yield c().fire({title:"\xbfEst\xe1s seguro?",text:"Esta acci\xf3n no se puede deshacer",icon:"warning",showCancelButton:!0,confirmButtonColor:"#dc3545",cancelButtonColor:"#6c757d",confirmButtonText:"S\xed, eliminar",cancelButtonText:"Cancelar"})).isConfirmed)try{const r=(0,l.H9)(a.firestore,"categorias",t);yield(0,l.kd)(r),yield c().fire("\xa1Eliminado!","La categor\xeda ha sido eliminada.","success")}catch(r){console.error("Error al eliminar la categor\xeda:",r),yield c().fire("Error","No se pudo eliminar la categor\xeda.","error")}})()}editarCategoria(t){if(!t.id)return;this.categoriaForm.contains("id")||this.categoriaForm.addControl("id",this.fb.control("")),this.categoriaForm.patchValue({id:t.id,nombre:t.nombre,descripcion:t.descripcion,icono:t.icono,colorFondo:t.colorFondo}),this.unidadesSeleccionadas=[...t.unidadesDisponibles||[]];const a=document.getElementById("modalCategoria");if(a){new bootstrap.Modal(a).show();const r=a.querySelector(".btn-danger");r&&(r.textContent="Actualizar Categor\xeda")}}guardarCategoria(){var t=this;return(0,p.A)(function*(){if(t.categoriaForm.valid)if(0!==t.unidadesSeleccionadas.length)try{const a={nombre:t.categoriaForm.get("nombre")?.value,descripcion:t.categoriaForm.get("descripcion")?.value,icono:t.categoriaForm.get("icono")?.value,colorFondo:t.categoriaForm.get("colorFondo")?.value,unidadesDisponibles:[...t.unidadesSeleccionadas]},o=t.categoriaForm.get("id")?.value;if(c().showLoading(),o){const r=(0,l.H9)(t.firestore,"categorias",o);yield(0,l.mZ)(r,a),yield c().fire({icon:"success",title:"\xa1Actualizado!",text:"La categor\xeda ha sido actualizada exitosamente",timer:1500,showConfirmButton:!1}),$("#modalCategoria").modal("hide")}else{const r=(0,l.rJ)(t.firestore,"categorias"),d={...a,productos:0};yield(0,l.gS)(r,d),yield c().fire({icon:"success",title:"\xa1Creado!",text:"La categor\xeda ha sido creada exitosamente",timer:1500,showConfirmButton:!1}),$("#modalCategoria").modal("hide")}t.resetForm()}catch(a){console.error("Error al guardar la categor\xeda:",a),yield c().fire({icon:"error",title:"Error",text:"Hubo un problema al guardar la categor\xeda. Int\xe9ntelo de nuevo."})}else yield c().fire({icon:"error",title:"Error",text:"Debe seleccionar al menos una unidad de medida"});else yield c().fire({icon:"error",title:"Error",text:"Por favor complete todos los campos requeridos"})})()}resetForm(){this.categoriaForm.reset({nombre:"",descripcion:"",icono:"bi-cup-straw",colorFondo:"#DC3545"}),this.unidadesSeleccionadas=[],this.nuevaUnidad=""}static{this.\u0275fac=function(a){return new(a||i)(e.rXU(n.ok),e.rXU(l._7))}}static{this.\u0275cmp=e.VBU({type:i,selectors:[["app-categoria-page"]],decls:137,vars:21,consts:[[1,"container-fluid"],[1,"row"],[1,"col-8"],[1,"col","text-end"],["data-bs-toggle","modal","data-bs-target","#modalCategoria",1,"btn","btn-danger"],[1,"bi","bi-plus-lg","me-2"],[1,"row","mt-4"],[1,"col-md-3"],[1,"card","border-0","shadow-sm"],[1,"card-body"],[1,"text-danger","mb-0"],[1,"text-muted"],[1,"text-primary","mb-0"],[1,"text-dark","mb-0"],[1,"text-info","mb-0"],["class","col-12 col-md-4 mb-4",4,"ngFor","ngForOf"],["id","modalCategoria","data-bs-backdrop","static","data-bs-keyboard","false","tabindex","-1","aria-labelledby","staticBackdropLabel","aria-hidden","true",1,"modal","fade"],[1,"modal-dialog","modal-dialog-centered","modal-lg"],[1,"modal-content"],[1,"modal-header","border-0","pb-0"],["id","staticBackdropLabel",1,"modal-title","fw-bold"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close"],[1,"modal-body","px-4"],[3,"formGroup"],[1,"col-12","col-sm-6"],[1,"mb-4"],[1,"d-flex","align-items-center","mb-3"],[1,"bi","bi-tag-fill","me-2"],[1,"mb-0"],[1,"mb-3"],[1,"form-label"],["type","text","placeholder","Ej: Bebidas Alcoh\xf3licas","formControlName","nombre",1,"form-control"],["placeholder","Descripci\xf3n de la categor\xeda","formControlName","descripcion",1,"form-control"],["formControlName","icono",1,"form-select"],["value","bi-cup-straw"],["value","bi-egg-fried"],["value","bi-cup-fill"],["value","bi-globe"],[1,"bi","bi-palette-fill","me-2"],[1,"form-control","p-0",2,"height","auto"],[1,"p-3"],[1,"d-flex","flex-wrap","gap-2","mb-3"],["type","button","class","btn rounded-3 p-3 border-0",3,"background-color","click",4,"ngFor","ngForOf"],[1,"border","rounded-3","p-3"],[1,"d-flex","align-items-center"],[1,"rounded-circle","p-2"],[1,"ms-2"],[1,"bi","bi-rulers","me-2"],[1,"row","g-3"],[1,"col-12"],[1,"input-group"],["type","text","placeholder","Ej: litros",1,"form-control",3,"ngModel","ngModelOptions","ngModelChange"],["type","button",1,"btn","btn-primary","rounded-end",3,"click"],[1,"bi","bi-plus-lg"],[1,"col-md-6"],["type","button",1,"btn","btn-outline-primary","w-100",3,"click"],[1,"form-control","p-2",2,"height","auto"],["class","text-muted",4,"ngIf"],["class","d-flex flex-wrap gap-2",4,"ngIf"],[1,"modal-footer","border-0"],["type","button","data-bs-dismiss","modal",1,"btn","btn-link","text-dark","text-decoration-none"],["type","button",1,"btn","btn-danger","px-4",3,"disabled","click"],[1,"col-12","col-md-4","mb-4"],[1,"card-body","p-4"],[1,"d-flex","justify-content-between","align-items-start","mb-3"],[1,"rounded-circle","p-3","me-3"],[1,"mb-1"],[1,"text-muted","mb-0"],[1,"btn","btn-outline-primary","btn-sm","me-2",3,"disabled","click"],[1,"bi","bi-pencil-fill"],[1,"btn","btn-outline-danger","btn-sm",3,"disabled","click"],[1,"bi","bi-trash3-fill"],[1,"bi","bi-box-seam-fill","me-2","text-primary"],[1,"text-muted","d-block"],[1,"text-muted","d-block","mb-2"],[1,"d-flex","flex-wrap","gap-2"],["class","badge rounded-1 bg-light text-dark border",4,"ngFor","ngForOf"],[1,"badge","rounded-1","bg-light","text-dark","border"],["type","button",1,"btn","rounded-3","p-3","border-0",3,"click"],["class","badge bg-light text-dark border d-flex align-items-center",4,"ngFor","ngForOf"],[1,"badge","bg-light","text-dark","border","d-flex","align-items-center"],["type","button",1,"btn-close","ms-2",3,"click"]],template:function(a,o){if(1&a&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"h5"),e.EFF(4,"Gesti\xf3n de Categor\xedas"),e.k0s(),e.j41(5,"span"),e.EFF(6,"Organiza tus productos por categor\xedas"),e.k0s()(),e.j41(7,"div",3)(8,"button",4),e.nrm(9,"i",5),e.EFF(10," Nueva Categor\xeda "),e.k0s()()(),e.j41(11,"div",6)(12,"div",7)(13,"div",8)(14,"div",9)(15,"h1",10),e.EFF(16),e.k0s(),e.j41(17,"span",11),e.EFF(18,"Total Categor\xedas"),e.k0s()()()(),e.j41(19,"div",7)(20,"div",8)(21,"div",9)(22,"h1",12),e.EFF(23),e.k0s(),e.j41(24,"span",11),e.EFF(25,"Total Productos"),e.k0s()()()(),e.j41(26,"div",7)(27,"div",8)(28,"div",9)(29,"h1",13),e.EFF(30),e.k0s(),e.j41(31,"span",11),e.EFF(32,"Unidades de Medida"),e.k0s()()()(),e.j41(33,"div",7)(34,"div",8)(35,"div",9)(36,"h1",14),e.EFF(37),e.k0s(),e.j41(38,"span",11),e.EFF(39,"Productos Combo"),e.k0s()()()()(),e.j41(40,"div",6),e.DNE(41,E,30,10,"div",15),e.k0s()(),e.j41(42,"div",16)(43,"div",17)(44,"div",18)(45,"div",19)(46,"h5",20),e.EFF(47," Nueva Categor\xeda "),e.k0s(),e.nrm(48,"button",21),e.k0s(),e.j41(49,"div",22)(50,"form",23)(51,"div",1)(52,"div",24)(53,"div",25)(54,"div",26),e.nrm(55,"i",27),e.j41(56,"h6",28),e.EFF(57,"Informaci\xf3n B\xe1sica"),e.k0s()(),e.j41(58,"div")(59,"div",29)(60,"label",30),e.EFF(61,"Nombre de la Categor\xeda *"),e.k0s(),e.nrm(62,"input",31),e.k0s(),e.j41(63,"div",29)(64,"label",30),e.EFF(65,"Descripci\xf3n *"),e.k0s(),e.nrm(66,"textarea",32),e.k0s(),e.j41(67,"div")(68,"label",30),e.EFF(69,"Icono"),e.k0s(),e.j41(70,"select",33)(71,"option",34),e.EFF(72,"\u{1f964} Bebida"),e.k0s(),e.j41(73,"option",35),e.EFF(74,"\u{1f373} Comida"),e.k0s(),e.j41(75,"option",36),e.EFF(76,"\u{1f378} Coctel"),e.k0s(),e.j41(77,"option",37),e.EFF(78,"\u{1f30e} Global"),e.k0s()()()()()(),e.j41(79,"div",24)(80,"div",25)(81,"div",26),e.nrm(82,"i",38),e.j41(83,"h6",28),e.EFF(84,"Apariencia"),e.k0s()(),e.j41(85,"div",29)(86,"label",30),e.EFF(87,"Color de la Categor\xeda"),e.k0s(),e.j41(88,"div",39),e.nrm(89,"div",40),e.k0s()(),e.j41(90,"div",41),e.DNE(91,j,1,2,"button",42),e.k0s(),e.j41(92,"label",30),e.EFF(93,"Vista Previa"),e.k0s(),e.j41(94,"div",43)(95,"div",44)(96,"div",45),e.nrm(97,"i"),e.k0s(),e.j41(98,"div",46)(99,"div"),e.EFF(100),e.k0s(),e.j41(101,"small",11),e.EFF(102),e.k0s()()()()()()(),e.j41(103,"div")(104,"div",26),e.nrm(105,"i",47),e.j41(106,"h6",28),e.EFF(107,"Unidades de Medida"),e.k0s()(),e.j41(108,"div",48)(109,"div",49)(110,"label",30),e.EFF(111,"Agregar Unidad Personalizada"),e.k0s(),e.j41(112,"div",50)(113,"input",51),e.bIt("ngModelChange",function(d){return o.nuevaUnidad=d}),e.k0s(),e.j41(114,"button",52),e.bIt("click",function(){return o.agregarUnidadPersonalizada()}),e.nrm(115,"i",53),e.k0s()()(),e.j41(116,"div",54)(117,"label",30),e.EFF(118,"Unidades para Bebidas"),e.k0s(),e.j41(119,"button",55),e.bIt("click",function(){return o.seleccionarUnidadesBebidas()}),e.EFF(120," Agregar Unidades de Bebidas "),e.k0s()(),e.j41(121,"div",54)(122,"label",30),e.EFF(123,"Unidades para Comida"),e.k0s(),e.j41(124,"button",55),e.bIt("click",function(){return o.seleccionarUnidadesComida()}),e.EFF(125," Agregar Unidades de Comida "),e.k0s()(),e.j41(126,"div",49)(127,"label",30),e.EFF(128,"Unidades Seleccionadas *"),e.k0s(),e.j41(129,"div",56),e.DNE(130,_,2,0,"div",57),e.DNE(131,y,2,1,"div",58),e.k0s()()()()()(),e.j41(132,"div",59)(133,"button",60),e.EFF(134," Cancelar "),e.k0s(),e.j41(135,"button",61),e.bIt("click",function(){return o.guardarCategoria()}),e.EFF(136," Crear Categor\xeda "),e.k0s()()()()()),2&a){let r,d,F,f,h;e.R7$(16),e.JRh(o.stats.totalCategorias),e.R7$(7),e.JRh(o.stats.totalProductos),e.R7$(7),e.JRh(o.stats.unidadesMedida),e.R7$(7),e.JRh(o.stats.productosCombo),e.R7$(4),e.Y8G("ngForOf",o.categorias),e.R7$(9),e.Y8G("formGroup",o.categoriaForm),e.R7$(39),e.xc7("background-color",null==(r=o.categoriaForm.get("colorFondo"))?null:r.value),e.R7$(2),e.Y8G("ngForOf",o.coloresPaleta),e.R7$(5),e.xc7("background-color",null==(d=o.categoriaForm.get("colorFondo"))?null:d.value),e.R7$(1),e.HbH("bi "+(null==(F=o.categoriaForm.get("icono"))?null:F.value)+" text-white"),e.R7$(3),e.SpI(" ",(null==(f=o.categoriaForm.get("nombre"))?null:f.value)||"Nombre de Categor\xeda"," "),e.R7$(2),e.JRh((null==(h=o.categoriaForm.get("descripcion"))?null:h.value)||"Descripci\xf3n de la categor\xeda"),e.R7$(11),e.Y8G("ngModel",o.nuevaUnidad)("ngModelOptions",e.lJ4(20,D)),e.R7$(17),e.Y8G("ngIf",0===o.unidadesSeleccionadas.length),e.R7$(1),e.Y8G("ngIf",o.unidadesSeleccionadas.length>0),e.R7$(4),e.Y8G("disabled",!o.categoriaForm.valid||0===o.unidadesSeleccionadas.length)}},dependencies:[g.Sq,g.bT,n.qT,n.xH,n.y7,n.me,n.wz,n.BC,n.cb,n.j4,n.JD,n.vS]})}}return i})()}];let P=(()=>{class i{static{this.\u0275fac=function(a){return new(a||i)}}static{this.\u0275mod=e.$C({type:i})}static{this.\u0275inj=e.G2t({imports:[b.iI.forChild(R),b.iI]})}}return i})(),S=(()=>{class i{static{this.\u0275fac=function(a){return new(a||i)}}static{this.\u0275mod=e.$C({type:i})}static{this.\u0275inj=e.G2t({imports:[P,v.PrivateModule,g.MD,n.X1,n.YN]})}}return i})()}}]);