"use strict";(self.webpackChunkrigel=self.webpackChunkrigel||[]).push([[529],{8529:(L,F,l)=>{l.r(F),l.d(F,{ProductosPageModule:()=>X});var m=l(177),a=l(9417),h=l(5743),b=l(467),c=l(9173),C=l(8032),u=l.n(C),j=l(8359),P=l(4572),p=l(7673),f=l(9172),v=l(152),R=l(5558),o=l(7705);function I(r,d){if(1&r&&(o.j41(0,"option",77),o.EFF(1),o.k0s()),2&r){const e=d.$implicit;o.Y8G("value",e.id),o.R7$(1),o.JRh(e.nombre)}}function S(r,d){if(1&r&&(o.j41(0,"option",77),o.EFF(1),o.k0s()),2&r){const e=d.$implicit;o.Y8G("value",e.id),o.R7$(1),o.JRh(e.nombre)}}function y(r,d){1&r&&(o.j41(0,"div",78)(1,"p",65),o.EFF(2,"No se encontraron productos con los filtros seleccionados."),o.k0s()())}function $(r,d){if(1&r&&(o.j41(0,"span",92),o.EFF(1),o.k0s()),2&r){const e=o.XpG().$implicit,i=o.XpG();o.R7$(1),o.SpI(" ",i.getFamiliaName(e.categoriaId,e.familiaId)," ")}}function x(r,d){if(1&r){const e=o.RV6();o.j41(0,"div",79)(1,"div",80),o.bIt("click",function(){const s=o.eBV(e).$implicit,n=o.XpG();return o.Njj(n.verDetalleProducto(s))}),o.j41(2,"div",81)(3,"div",48)(4,"div",30)(5,"h6",82),o.EFF(6),o.k0s(),o.j41(7,"p",83),o.EFF(8),o.k0s(),o.j41(9,"div",84)(10,"span",85),o.EFF(11),o.k0s(),o.DNE(12,$,2,1,"span",86),o.k0s()()(),o.j41(13,"div",87)(14,"div",88)(15,"div",89),o.EFF(16,"Costo"),o.k0s(),o.j41(17,"div",90),o.EFF(18),o.nI1(19,"currency"),o.k0s()(),o.j41(20,"div",88)(21,"div",89),o.EFF(22,"Stock Actual"),o.k0s(),o.j41(23,"div",91),o.EFF(24),o.k0s()()()()()()}if(2&r){const e=d.$implicit,i=o.XpG();o.R7$(6),o.JRh(e.nombre),o.R7$(2),o.JRh(e.descripcion),o.R7$(2),o.Y8G("ngClass",i.getCategoryBadgeClass(e.categoriaId)),o.R7$(1),o.SpI(" ",i.getCategoryName(e.categoriaId)," "),o.R7$(1),o.Y8G("ngIf",e.familiaId),o.R7$(6),o.SpI(" ",o.ii3(19,7,e.costo,"EUR","symbol","1.2-2")," "),o.R7$(6),o.SpI(" ",e.stock," ")}}function D(r,d){if(1&r&&(o.j41(0,"span",126),o.nrm(1,"i",127),o.EFF(2),o.k0s()),2&r){const e=o.XpG(2);o.R7$(2),o.SpI(" ",e.getFamiliaName(e.productoSeleccionado.categoriaId,e.productoSeleccionado.familiaId)," ")}}function M(r,d){if(1&r&&(o.j41(0,"div",128)(1,"div",9)(2,"h6",48),o.nrm(3,"i",129),o.EFF(4,"Control de Stock"),o.k0s(),o.j41(5,"div",113)(6,"div",88)(7,"div",130)(8,"div")(9,"small",117),o.EFF(10,"Stock Actual"),o.k0s(),o.j41(11,"h4",131),o.EFF(12),o.k0s()(),o.nrm(13,"i",132),o.k0s()(),o.j41(14,"div",88)(15,"div",130)(16,"div")(17,"small",117),o.EFF(18,"Stock M\xednimo"),o.k0s(),o.j41(19,"h4",133),o.EFF(20),o.k0s()(),o.nrm(21,"i",134),o.k0s()()()()()),2&r){const e=o.XpG(2);o.R7$(11),o.Y8G("ngClass",e.getStockClass(e.productoSeleccionado)),o.R7$(1),o.JRh(e.productoSeleccionado.stock),o.R7$(1),o.Y8G("ngClass",e.getStockClass(e.productoSeleccionado)),o.R7$(7),o.JRh(e.productoSeleccionado.stockMinimo)}}function N(r,d){if(1&r&&(o.j41(0,"div")(1,"small",117),o.EFF(2,"Valor en stock"),o.k0s(),o.j41(3,"strong",135),o.EFF(4),o.nI1(5,"currency"),o.k0s()()),2&r){const e=o.XpG(2);o.R7$(4),o.SpI(" ",o.ii3(5,1,(e.productoSeleccionado.stock||0)*e.productoSeleccionado.costo,"EUR","symbol","1.2-2")," ")}}function G(r,d){1&r&&(o.j41(0,"div",136),o.nrm(1,"i",137),o.j41(2,"div")(3,"strong"),o.EFF(4,"\xa1Atenci\xf3n!"),o.k0s(),o.EFF(5," El stock actual est\xe1 por debajo o igual al stock m\xednimo. Considera realizar un pedido. "),o.k0s()())}function _(r,d){if(1&r&&(o.j41(0,"div",93)(1,"div",94)(2,"span",95),o.nrm(3,"i",96),o.EFF(4),o.k0s(),o.DNE(5,D,3,1,"span",97),o.j41(6,"span",95),o.nrm(7,"i",98),o.EFF(8),o.k0s()(),o.j41(9,"div",99)(10,"div",100)(11,"div",101)(12,"div",102),o.nrm(13,"i",103),o.j41(14,"h3",104),o.EFF(15),o.nI1(16,"currency"),o.k0s(),o.j41(17,"small",65),o.EFF(18,"Costo"),o.k0s()()()(),o.j41(19,"div",100)(20,"div",105)(21,"div",102),o.nrm(22,"i",106),o.j41(23,"h3",107),o.EFF(24),o.k0s(),o.j41(25,"small",108),o.EFF(26,"IVA"),o.k0s()()()(),o.j41(27,"div",100)(28,"div",109)(29,"div",102),o.nrm(30,"i",110),o.j41(31,"h3",111),o.EFF(32),o.nI1(33,"currency"),o.k0s(),o.j41(34,"small",65),o.EFF(35,"Precio + IVA"),o.k0s()()()()(),o.DNE(36,M,22,4,"div",112),o.j41(37,"div",113)(38,"div",114)(39,"div",115)(40,"div",9)(41,"h6",48),o.nrm(42,"i",116),o.EFF(43,"Informaci\xf3n del Producto"),o.k0s(),o.j41(44,"div",48)(45,"small",117),o.EFF(46,"Cantidad por unidad"),o.k0s(),o.j41(47,"strong",118),o.EFF(48),o.k0s()(),o.j41(49,"div",48)(50,"small",117),o.EFF(51,"Proveedor"),o.k0s(),o.j41(52,"div",119),o.nrm(53,"i",120),o.j41(54,"strong"),o.EFF(55),o.k0s()()()()()(),o.j41(56,"div",114)(57,"div",115)(58,"div",9)(59,"h6",48),o.nrm(60,"i",121),o.EFF(61,"An\xe1lisis"),o.k0s(),o.j41(62,"div",48)(63,"small",117),o.EFF(64,"Margen de ganancia"),o.k0s(),o.j41(65,"div",122)(66,"div",123)(67,"strong"),o.EFF(68),o.k0s()()()(),o.DNE(69,N,6,6,"div",124),o.k0s()()()(),o.DNE(70,G,6,0,"div",125),o.k0s()),2&r){const e=o.XpG();o.R7$(2),o.Y8G("ngClass",e.getCategoryBadgeClass(e.productoSeleccionado.categoriaId)),o.R7$(2),o.SpI(" ",e.getCategoryName(e.productoSeleccionado.categoriaId)," "),o.R7$(1),o.Y8G("ngIf",e.productoSeleccionado.familiaId),o.R7$(1),o.Y8G("ngClass",e.productoSeleccionado.esCombinado?"bg-warning text-dark":"bg-info"),o.R7$(1),o.Y8G("ngClass",e.productoSeleccionado.esCombinado?"bi-cup-straw":"bi-box"),o.R7$(1),o.SpI(" ",e.productoSeleccionado.esCombinado?"Receta/Combinado":"Producto Simple"," "),o.R7$(7),o.JRh(o.ii3(16,19,e.productoSeleccionado.costo,"EUR","symbol","1.2-2")),o.R7$(9),o.SpI("",e.productoSeleccionado.IVA,"%"),o.R7$(8),o.JRh(o.ii3(33,24,e.getPrecioVenta(e.productoSeleccionado),"EUR","symbol","1.2-2")),o.R7$(4),o.Y8G("ngIf",!e.productoSeleccionado.esCombinado),o.R7$(12),o.Lme("",e.productoSeleccionado.cantidad," ",e.productoSeleccionado.unidadMedida,""),o.R7$(7),o.JRh(e.getProveedorName(e.productoSeleccionado.proveedorId)),o.R7$(11),o.xc7("width",e.getMargenPorcentaje(e.productoSeleccionado),"%"),o.BMQ("aria-valuenow",e.getMargenPorcentaje(e.productoSeleccionado)),o.R7$(2),o.SpI("",e.getMargenPorcentaje(e.productoSeleccionado),"%"),o.R7$(1),o.Y8G("ngIf",!e.productoSeleccionado.esCombinado),o.R7$(1),o.Y8G("ngIf",!e.productoSeleccionado.esCombinado&&(e.productoSeleccionado.stock||0)<=(e.productoSeleccionado.stockMinimo||0))}}function w(r,d){1&r&&(o.j41(0,"div",138),o.EFF(1," Este nombre de producto ya existe. "),o.k0s())}function Y(r,d){if(1&r&&(o.j41(0,"option",77),o.EFF(1),o.k0s()),2&r){const e=d.$implicit;o.Y8G("value",e.id),o.R7$(1),o.JRh(e.nombre)}}function V(r,d){if(1&r&&(o.j41(0,"option",77),o.EFF(1),o.k0s()),2&r){const e=d.$implicit;o.Y8G("value",e.id),o.R7$(1),o.JRh(e.nombre)}}function T(r,d){1&r&&(o.j41(0,"small",65),o.EFF(1," Las familias se cargar\xe1n al seleccionar una categor\xeda "),o.k0s())}function A(r,d){if(1&r&&(o.j41(0,"option",77),o.EFF(1),o.k0s()),2&r){const e=d.$implicit;o.Y8G("value",e.id),o.R7$(1),o.JRh(e.nombre)}}function J(r,d){1&r&&(o.j41(0,"div",72)(1,"label",49),o.EFF(2,"Stock Actual"),o.k0s(),o.nrm(3,"input",139),o.k0s())}function B(r,d){1&r&&(o.j41(0,"div",72)(1,"label",49),o.EFF(2,"Stock M\xednimo"),o.k0s(),o.nrm(3,"input",140),o.k0s())}function O(r,d){if(1&r&&(o.j41(0,"option",77),o.EFF(1),o.k0s()),2&r){const e=d.$implicit;o.Y8G("value",e),o.R7$(1),o.JRh(e)}}const z=[{path:"",component:(()=>{class r{constructor(e,i){this.fb=e,this.firestore=i,this.productos=[],this.filteredProducts=[],this.categorias=[],this.proveedores=[],this.unidadesDisponibles=[],this.familiasDisponibles=[],this.totalProveedores=0,this.totalStockValue=0,this.productosBajosEnStock=0,this.subscriptions=new j.yU,this.productSearch=new a.MJ(""),this.categoryFilter=new a.MJ("all"),this.supplierFilter=new a.MJ("all"),this.productoSeleccionado=null}ngOnInit(){this.productoForm=this.fb.group({id:[""],nombre:["",{validators:[a.k0.required],asyncValidators:[this.productNameValidator()],updateOn:"blur"}],descripcion:["",a.k0.required],costo:[0,[a.k0.required,a.k0.min(0)]],IVA:[0,[a.k0.required,a.k0.min(0)]],categoriaId:["",a.k0.required],familiaId:["",a.k0.required],proveedorId:[null],esCombinado:[!1],stock:[0,a.k0.min(0)],stockMinimo:[0,a.k0.min(0)],cantidad:[0,[a.k0.required,a.k0.min(0)]],unidadMedida:["",a.k0.required]}),this.cargarProductos(),this.cargarCategorias(),this.cargarProveedores();const e=document.getElementById("productModal");e&&(this.modal=new bootstrap.Modal(e));const i=document.getElementById("detalleProductoModal");i&&(this.detalleModal=new bootstrap.Modal(i)),this.subscriptions.add(this.productoForm.get("categoriaId")?.valueChanges.subscribe(t=>{this.onCategoriaChange(t)})),this.subscriptions.add(this.productoForm.get("esCombinado")?.valueChanges.subscribe(t=>{this.onEsCombinadoChange(t)})),this.subscriptions.add((0,P.z)([this.productSearch.valueChanges.pipe((0,f.Z)("")),this.categoryFilter.valueChanges.pipe((0,f.Z)("all")),this.supplierFilter.valueChanges.pipe((0,f.Z)("all"))]).pipe((0,v.B)(300)).subscribe(([t,s,n])=>{this.filterProducts(t||"",s||"all",n||"all")}))}ngOnDestroy(){this.subscriptions.unsubscribe()}productNameValidator(){return e=>(0,p.of)(e.value).pipe((0,v.B)(500),(0,R.n)(i=>{if(!i||!i.trim())return(0,p.of)(null);const t=i.trim().toLowerCase(),s=this.productoForm?.get("id")?.value;return this.productos&&0!==this.productos.length&&this.productos.some(g=>g.nombre.toLowerCase()===t&&g.id!==s)?(0,p.of)({productNameExists:!0}):(0,p.of)(null)}))}cargarProductos(){const e=(0,c.collection)(this.firestore,"productos");this.subscriptions.add((0,c.collectionData)(e,{idField:"id"}).subscribe(i=>{this.productos=i,this.filteredProducts=i,this.totalStockValue=i.reduce((t,s)=>t+(s.stock||0)*s.costo,0),this.productosBajosEnStock=i.filter(t=>!t.esCombinado&&(t.stock||0)<=(t.stockMinimo||0)).length}))}cargarCategorias(){const e=(0,c.collection)(this.firestore,"categorias");this.subscriptions.add((0,c.collectionData)(e,{idField:"id"}).subscribe(i=>{this.categorias=i}))}cargarProveedores(){const e=(0,c.collection)(this.firestore,"proveedores");this.subscriptions.add((0,c.collectionData)(e,{idField:"id"}).subscribe(i=>{this.proveedores=i,this.totalProveedores=i.length}))}filterProducts(e,i,t){let s=[...this.productos];e&&(s=s.filter(n=>n.nombre.toLowerCase().includes(e.toLowerCase()))),i&&"all"!==i&&(s=s.filter(n=>n.categoriaId===i)),t&&"all"!==t&&(s=s.filter(n=>n.proveedorId===t)),this.filteredProducts=s}onCategoriaChange(e){const i=this.categorias.find(t=>t.id===e);this.unidadesDisponibles=i?.unidadesDisponibles||[],this.unidadesDisponibles.length>0?this.productoForm.get("unidadMedida")?.setValue(this.unidadesDisponibles[0]):this.productoForm.get("unidadMedida")?.setValue(""),this.familiasDisponibles=i?.familias||[],this.productoForm.get("familiaId")?.setValue("")}onEsCombinadoChange(e){const i=this.productoForm.get("stock"),t=this.productoForm.get("stockMinimo");e?(i?.setValue(null),i?.disable(),t?.setValue(null),t?.disable()):(i?.enable(),t?.enable())}guardarProducto(){var e=this;return(0,b.A)(function*(){if(e.productoForm.invalid)return void u().fire("Error","Por favor, complete todos los campos requeridos.","error");const i=e.productoForm.getRawValue();u().showLoading();try{if(i.id){const t=(0,c.doc)(e.firestore,"productos",i.id);yield(0,c.updateDoc)(t,i),u().fire("\xa1Actualizado!","El producto ha sido actualizado.","success")}else i.fechaCreacion=(0,c.serverTimestamp)(),delete i.id,yield(0,c.addDoc)((0,c.collection)(e.firestore,"productos"),i),u().fire("\xa1Creado!","El nuevo producto ha sido guardado.","success");e.modal.hide(),e.resetForm()}catch(t){console.error("Error al guardar el producto:",t),u().fire("Error","Hubo un problema al guardar el producto.","error")}})()}editarProducto(e){this.productoForm.contains("id")||this.productoForm.addControl("id",this.fb.control(""));const i=this.categorias.find(t=>t.id===e.categoriaId);this.unidadesDisponibles=i?.unidadesDisponibles||[],this.familiasDisponibles=i?.familias||[],this.productoForm.patchValue({id:e.id,nombre:e.nombre,descripcion:e.descripcion,costo:e.costo,IVA:e.IVA,categoriaId:e.categoriaId,familiaId:e.familiaId,proveedorId:e.proveedorId,esCombinado:e.esCombinado,stock:e.stock,stockMinimo:e.stockMinimo,cantidad:e.cantidad,unidadMedida:e.unidadMedida}),this.modal.show()}eliminarProducto(e){var i=this;return(0,b.A)(function*(){if((yield u().fire({title:"\xbfEst\xe1s seguro?",text:"Esta acci\xf3n no se puede deshacer.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#dc3545",cancelButtonColor:"#6c757d",confirmButtonText:"S\xed, eliminar",cancelButtonText:"Cancelar"})).isConfirmed)try{yield(0,c.deleteDoc)((0,c.doc)(i.firestore,"productos",e)),u().fire("\xa1Eliminado!","El producto ha sido eliminado.","success")}catch(s){console.error("Error al eliminar el producto:",s),u().fire("Error","No se pudo eliminar el producto.","error")}})()}abrirModalNuevo(){this.resetForm(),this.modal.show()}resetForm(){this.productoForm.reset({id:"",nombre:"",descripcion:"",costo:0,IVA:0,categoriaId:"",familiaId:"",proveedorId:null,esCombinado:!1,stock:0,stockMinimo:0,cantidad:0,unidadMedida:""}),this.familiasDisponibles=[],this.unidadesDisponibles=[]}getCategoryName(e){const i=this.categorias.find(t=>t.id===e);return i?i.nombre:""}getFamiliaName(e,i){if(!i)return"";const t=this.categorias.find(n=>n.id===e);if(!t||!t.familias)return"";const s=t.familias.find(n=>n.id===i);return s?s.nombre:""}getCategoryBadgeClass(e){const i=this.categorias.find(n=>n.id===e);if(!i)return"bg-secondary";const t=["bg-primary","bg-success","bg-info","bg-warning","bg-danger"];return t[i.nombre.length%t.length]}getPrecioVenta(e){return e.costo*(1+(e.IVA||0)/100)}getStockClass(e){if(e.esCombinado)return"text-muted";const i=e.stock||0;return i<=0?"text-danger":i<=(e.stockMinimo||0)?"text-warning":"text-success"}getUnidadDisplay(e){return e.cantidad&&e.unidadMedida?`${e.unidadMedida}`:"unidades"}getMargenPorcentaje(e){const i=this.getPrecioVenta(e),t=e.costo;return 0===t?"0.0":((i-t)/t*100).toFixed(1)}verDetalleProducto(e){this.productoSeleccionado=e,this.detalleModal.show()}editarDesdeDetalle(){this.productoSeleccionado&&(this.detalleModal.hide(),this.editarProducto(this.productoSeleccionado))}eliminarDesdeDetalle(){var e=this;return(0,b.A)(function*(){e.productoSeleccionado&&(e.detalleModal.hide(),yield e.eliminarProducto(e.productoSeleccionado.id),e.productoSeleccionado=null)})()}getProveedorName(e){if(!e)return"Sin proveedor";const i=this.proveedores.find(t=>t.id===e);return i?i.nombre:"Sin proveedor"}static{this.\u0275fac=function(i){return new(i||r)(o.rXU(a.ok),o.rXU(c.Firestore))}}static{this.\u0275cmp=o.VBU({type:r,selectors:[["app-productos-page"]],decls:161,vars:27,consts:[[1,"container-fluid"],[1,"row"],[1,"col-8"],[1,"col","text-end"],[1,"btn","btn-danger",3,"click"],[1,"bi","bi-plus-lg","me-2"],[1,"row","mt-3"],[1,"col"],[1,"card"],[1,"card-body"],[1,"row","d-flex","align-items-center"],[1,"col-12","col-sm-4","mt-2"],["type","text","placeholder","Buscar productos...",1,"form-control",3,"formControl"],[1,"col-12","col-sm-3","mt-2"],[1,"form-select",3,"formControl"],["value","all"],[3,"value",4,"ngFor","ngForOf"],[1,"col-12","col-sm-2","mt-2"],[1,"bi","bi-box","text-primary"],[1,"bi","bi-exclamation-circle","text-danger"],[1,"row","mt-4"],["class","col-12 text-center",4,"ngIf"],["class","col-12 col-sm-3 mb-4",4,"ngFor","ngForOf"],["id","detalleProductoModal","data-bs-backdrop","static","data-bs-keyboard","false","tabindex","-1",1,"modal","fade"],[1,"modal-dialog","modal-dialog-centered","modal-lg"],[1,"modal-content"],[1,"modal-header","border-0","pb-0"],[1,"d-flex","align-items-center","w-100"],[1,"rounded-circle","me-3","d-flex","justify-content-center","align-items-center",2,"background","linear-gradient(135deg, #667eea 0%, #764ba2 100%)","width","56px","height","56px"],[1,"bi","bi-box-seam-fill","text-white","fs-3"],[1,"flex-grow-1"],[1,"mb-1"],[1,"text-muted","mb-0","small"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close"],["class","modal-body pt-3",4,"ngIf"],[1,"modal-footer","border-0"],["type","button","data-bs-dismiss","modal",1,"btn","btn-secondary"],[1,"bi","bi-x-lg","me-2"],["type","button",1,"btn","btn-primary",3,"click"],[1,"bi","bi-pencil-fill","me-2"],["type","button",1,"btn","btn-danger",3,"click"],[1,"bi","bi-trash3-fill","me-2"],["id","productModal","data-bs-backdrop","static","data-bs-keyboard","false","tabindex","-1",1,"modal","fade"],[1,"modal-dialog","modal-dialog-centered"],[3,"formGroup","ngSubmit"],[1,"modal-header"],[1,"modal-title"],[1,"modal-body"],[1,"mb-3"],[1,"form-label"],[1,"text-danger"],["type","text","formControlName","nombre","placeholder","Ej: Coca-Cola",1,"form-control"],["class","text-danger mt-1",4,"ngIf"],["formControlName","descripcion","placeholder","Descripci\xf3n del producto",1,"form-control"],[1,"col-md-6","mb-3"],["type","number","formControlName","costo","placeholder","0.00",1,"form-control"],["formControlName","IVA",1,"form-control"],["selected","","disabled",""],["value","4"],["value","10"],["value","21"],["formControlName","categoriaId",1,"form-select"],["value","","disabled",""],["formControlName","familiaId",1,"form-select",3,"disabled"],["class","text-muted",4,"ngIf"],[1,"text-muted"],["formControlName","proveedorId",1,"form-select"],[3,"ngValue"],[1,"form-check","mb-3"],["type","checkbox","formControlName","esCombinado","id","esCombinadoCheck",1,"form-check-input"],["for","esCombinadoCheck",1,"form-check-label"],["class","col-md-4 mb-3",4,"ngIf"],[1,"col-md-4","mb-3"],["type","number","formControlName","cantidad","placeholder","0",1,"form-control"],["formControlName","unidadMedida",1,"form-select"],[1,"modal-footer"],["type","submit",1,"btn","btn-danger",3,"disabled"],[3,"value"],[1,"col-12","text-center"],[1,"col-12","col-sm-3","mb-4"],[1,"card","shadow-sm","border-0","h-100",2,"cursor","pointer",3,"click"],[1,"card-body","p-3"],[1,"mb-1","fw-bold","text-dark"],[1,"text-muted","small","mb-2"],[1,"d-flex","flex-wrap","gap-1"],[1,"badge","rounded-pill",2,"font-size","0.75rem",3,"ngClass"],["class","badge rounded-pill bg-secondary","style","font-size: 0.7rem;",4,"ngIf"],[1,"row","mb-3"],[1,"col-6"],[1,"text-muted","small"],[1,"fw-bold","text-danger",2,"font-size","1.1rem"],[1,"fw-bold"],[1,"badge","rounded-pill","bg-secondary",2,"font-size","0.7rem"],[1,"modal-body","pt-3"],[1,"mb-4","d-flex","gap-2","align-items-center"],[1,"badge","rounded-pill","px-3","py-2",3,"ngClass"],[1,"bi","bi-tag-fill","me-1"],["class","badge rounded-pill bg-secondary px-3 py-2",4,"ngIf"],[1,"bi",3,"ngClass"],[1,"row","g-3","mb-3"],[1,"col-md-4"],[1,"card","border-0","bg-danger","bg-opacity-10","h-100"],[1,"card-body","text-center"],[1,"bi","bi-cash-coin","text-danger","fs-2","d-block","mb-2"],[1,"mb-0","text-danger"],[1,"card","border-0","bg-primary","h-100"],[1,"bi","bi-percent","text-white","fs-2","d-block","mb-2"],[1,"mb-0","text-white"],[1,"text-white","opacity-75"],[1,"card","border-0","bg-success","bg-opacity-10","h-100"],[1,"bi","bi-calculator","text-success","fs-2","d-block","mb-2"],[1,"mb-0","text-success"],["class","card border-0 bg-light mb-3",4,"ngIf"],[1,"row","g-3"],[1,"col-md-6"],[1,"card","border-0","bg-light","h-100"],[1,"bi","bi-info-circle","me-2","text-primary"],[1,"text-muted","d-block"],[1,"fs-5"],[1,"d-flex","align-items-center","mt-1"],[1,"bi","bi-building","me-2","text-primary"],[1,"bi","bi-graph-up","me-2","text-primary"],[1,"progress","mt-2",2,"height","25px"],["role","progressbar","aria-valuemin","0","aria-valuemax","100",1,"progress-bar","bg-success"],[4,"ngIf"],["class","alert alert-warning d-flex align-items-center mt-3",4,"ngIf"],[1,"badge","rounded-pill","bg-secondary","px-3","py-2"],[1,"bi","bi-diagram-3-fill","me-1"],[1,"card","border-0","bg-light","mb-3"],[1,"bi","bi-boxes","me-2","text-primary"],[1,"d-flex","align-items-center","justify-content-between","p-3","bg-white","rounded"],[1,"mb-0",3,"ngClass"],[1,"bi","bi-box-seam","fs-2",3,"ngClass"],[1,"mb-0","text-warning"],[1,"bi","bi-exclamation-triangle","fs-2","text-warning"],[1,"fs-5","text-success"],[1,"alert","alert-warning","d-flex","align-items-center","mt-3"],[1,"bi","bi-exclamation-triangle-fill","fs-4","me-3"],[1,"text-danger","mt-1"],["type","number","formControlName","stock","placeholder","0",1,"form-control"],["type","number","formControlName","stockMinimo","placeholder","0",1,"form-control"]],template:function(i,t){if(1&i&&(o.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"h5"),o.EFF(4,"Gesti\xf3n de Productos"),o.k0s(),o.j41(5,"span"),o.EFF(6,"Crea, edita y organiza todos tus productos."),o.k0s()(),o.j41(7,"div",3)(8,"button",4),o.bIt("click",function(){return t.abrirModalNuevo()}),o.nrm(9,"i",5),o.EFF(10," Nuevo Producto "),o.k0s()()(),o.j41(11,"div",6)(12,"div",7)(13,"div",8)(14,"div",9)(15,"div",10)(16,"div",11),o.nrm(17,"input",12),o.k0s(),o.j41(18,"div",13)(19,"select",14)(20,"option",15),o.EFF(21,"Todas las categor\xedas"),o.k0s(),o.DNE(22,I,2,2,"option",16),o.k0s()(),o.j41(23,"div",13)(24,"select",14)(25,"option",15),o.EFF(26,"Todos los proveedores"),o.k0s(),o.DNE(27,S,2,2,"option",16),o.k0s()(),o.j41(28,"div",17)(29,"span"),o.nrm(30,"i",18),o.EFF(31),o.k0s(),o.EFF(32,"\xa0\xa0 "),o.j41(33,"span"),o.nrm(34,"i",19),o.EFF(35),o.k0s()()()()()()(),o.j41(36,"div",20),o.DNE(37,y,3,0,"div",21),o.DNE(38,x,25,12,"div",22),o.k0s()(),o.j41(39,"div",23)(40,"div",24)(41,"div",25)(42,"div",26)(43,"div",27)(44,"div",28),o.nrm(45,"i",29),o.k0s(),o.j41(46,"div",30)(47,"h4",31),o.EFF(48),o.k0s(),o.j41(49,"p",32),o.EFF(50),o.k0s()()(),o.nrm(51,"button",33),o.k0s(),o.DNE(52,_,71,29,"div",34),o.j41(53,"div",35)(54,"button",36),o.nrm(55,"i",37),o.EFF(56,"Cerrar "),o.k0s(),o.j41(57,"button",38),o.bIt("click",function(){return t.editarDesdeDetalle()}),o.nrm(58,"i",39),o.EFF(59,"Editar "),o.k0s(),o.j41(60,"button",40),o.bIt("click",function(){return t.eliminarDesdeDetalle()}),o.nrm(61,"i",41),o.EFF(62,"Eliminar "),o.k0s()()()()(),o.j41(63,"div",42)(64,"div",43)(65,"div",25)(66,"form",44),o.bIt("ngSubmit",function(){return t.guardarProducto()}),o.j41(67,"div",45)(68,"h5",46),o.EFF(69),o.k0s(),o.nrm(70,"button",33),o.k0s(),o.j41(71,"div",47)(72,"div",48)(73,"label",49),o.EFF(74,"Nombre del Producto "),o.j41(75,"span",50),o.EFF(76,"*"),o.k0s()(),o.nrm(77,"input",51),o.DNE(78,w,2,0,"div",52),o.k0s(),o.j41(79,"div",48)(80,"label",49),o.EFF(81,"Descripci\xf3n "),o.j41(82,"span",50),o.EFF(83,"*"),o.k0s()(),o.nrm(84,"textarea",53),o.k0s(),o.j41(85,"div",1)(86,"div",54)(87,"label",49),o.EFF(88,"Costo "),o.j41(89,"span",50),o.EFF(90,"*"),o.k0s()(),o.nrm(91,"input",55),o.k0s(),o.j41(92,"div",54)(93,"label",49),o.EFF(94,"IVA(%) "),o.j41(95,"span",50),o.EFF(96,"*"),o.k0s()(),o.j41(97,"select",56)(98,"option",57),o.EFF(99,"Selecciona un IVA"),o.k0s(),o.j41(100,"option",58),o.EFF(101,"4%"),o.k0s(),o.j41(102,"option",59),o.EFF(103,"10%"),o.k0s(),o.j41(104,"option",60),o.EFF(105,"21%"),o.k0s()()()(),o.j41(106,"div",48)(107,"label",49),o.EFF(108,"Categor\xeda "),o.j41(109,"span",50),o.EFF(110,"*"),o.k0s()(),o.j41(111,"select",61)(112,"option",62),o.EFF(113,"Selecciona una categor\xeda"),o.k0s(),o.DNE(114,Y,2,2,"option",16),o.k0s()(),o.j41(115,"div",48)(116,"label",49),o.EFF(117,"Familia "),o.j41(118,"span",50),o.EFF(119,"*"),o.k0s()(),o.j41(120,"select",63)(121,"option",62),o.EFF(122),o.k0s(),o.DNE(123,V,2,2,"option",16),o.k0s(),o.DNE(124,T,2,0,"small",64),o.k0s(),o.j41(125,"div",48)(126,"label",49),o.EFF(127,"Proveedor "),o.j41(128,"small",65),o.EFF(129,"(Opcional)"),o.k0s()(),o.j41(130,"select",66)(131,"option",67),o.EFF(132,"Ninguno"),o.k0s(),o.DNE(133,A,2,2,"option",16),o.k0s()(),o.j41(134,"div",68),o.nrm(135,"input",69),o.j41(136,"label",70),o.EFF(137," Es Receta/Combinado (sin control de stock) "),o.k0s()(),o.j41(138,"div",1),o.DNE(139,J,4,0,"div",71),o.DNE(140,B,4,0,"div",71),o.j41(141,"div",72)(142,"label",49),o.EFF(143,"Cantidad "),o.j41(144,"span",50),o.EFF(145,"*"),o.k0s()(),o.nrm(146,"input",73),o.k0s(),o.j41(147,"div",72)(148,"label",49),o.EFF(149,"Unidad de Medida "),o.j41(150,"span",50),o.EFF(151,"*"),o.k0s()(),o.j41(152,"select",74)(153,"option",62),o.EFF(154,"Selecciona una unidad"),o.k0s(),o.DNE(155,O,2,2,"option",16),o.k0s()()()(),o.j41(156,"div",75)(157,"button",36),o.EFF(158,"Cancelar"),o.k0s(),o.j41(159,"button",76),o.EFF(160),o.k0s()()()()()()),2&i){let s,n,g,k,E;o.R7$(17),o.Y8G("formControl",t.productSearch),o.R7$(2),o.Y8G("formControl",t.categoryFilter),o.R7$(3),o.Y8G("ngForOf",t.categorias),o.R7$(2),o.Y8G("formControl",t.supplierFilter),o.R7$(3),o.Y8G("ngForOf",t.proveedores),o.R7$(4),o.SpI("\xa0",t.filteredProducts.length,"\xa0Productos"),o.R7$(4),o.SpI("\xa0",t.productosBajosEnStock,"\xa0Stock"),o.R7$(2),o.Y8G("ngIf",0===t.filteredProducts.length),o.R7$(1),o.Y8G("ngForOf",t.filteredProducts),o.R7$(10),o.JRh(null==t.productoSeleccionado?null:t.productoSeleccionado.nombre),o.R7$(2),o.JRh(null==t.productoSeleccionado?null:t.productoSeleccionado.descripcion),o.R7$(2),o.Y8G("ngIf",t.productoSeleccionado),o.R7$(14),o.Y8G("formGroup",t.productoForm),o.R7$(3),o.JRh(null!=(s=t.productoForm.get("id"))&&s.value?"Editar Producto":"Nuevo Producto"),o.R7$(9),o.Y8G("ngIf",null==(n=t.productoForm.get("nombre"))?null:n.hasError("productNameExists")),o.R7$(36),o.Y8G("ngForOf",t.categorias),o.R7$(6),o.Y8G("disabled",0===t.familiasDisponibles.length),o.R7$(2),o.SpI(" ",0===t.familiasDisponibles.length?"Primero selecciona una categor\xeda":"Selecciona una familia"," "),o.R7$(1),o.Y8G("ngForOf",t.familiasDisponibles),o.R7$(1),o.Y8G("ngIf",0===t.familiasDisponibles.length),o.R7$(7),o.Y8G("ngValue",null),o.R7$(2),o.Y8G("ngForOf",t.proveedores),o.R7$(6),o.Y8G("ngIf",!(null!=(g=t.productoForm.get("esCombinado"))&&g.value)),o.R7$(1),o.Y8G("ngIf",!(null!=(k=t.productoForm.get("esCombinado"))&&k.value)),o.R7$(15),o.Y8G("ngForOf",t.unidadesDisponibles),o.R7$(4),o.Y8G("disabled",t.productoForm.invalid),o.R7$(1),o.JRh(null!=(E=t.productoForm.get("id"))&&E.value?"Actualizar":"Crear")}},dependencies:[m.YU,m.Sq,m.bT,a.qT,a.xH,a.y7,a.me,a.Q0,a.Zm,a.wz,a.BC,a.cb,a.l_,a.j4,a.JD,m.oe]})}}return r})()}];let U=(()=>{class r{static{this.\u0275fac=function(i){return new(i||r)}}static{this.\u0275mod=o.$C({type:r})}static{this.\u0275inj=o.G2t({imports:[h.iI.forChild(z),h.iI]})}}return r})(),X=(()=>{class r{static{this.\u0275fac=function(i){return new(i||r)}}static{this.\u0275mod=o.$C({type:r})}static{this.\u0275inj=o.G2t({imports:[m.MD,a.YN,a.X1,U]})}}return r})()}}]);