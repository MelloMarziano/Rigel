"use strict";(self.webpackChunkrigel=self.webpackChunkrigel||[]).push([[683],{3683:(ue,E,f)=>{f.r(E),f.d(E,{InventarioPageModule:()=>ge});var S=f(2432),u=f(9417),C=f(177),y=f(8498),_=f(467),s=f(2418),R=f(8359),j=f(8032),l=f.n(j),e=f(7705),A=f(4441);function T(i,c){if(1&i&&(e.j41(0,"option",40),e.EFF(1),e.k0s()),2&i){const t=c.$implicit;e.Y8G("value",t.id),e.R7$(1),e.SpI(" ",t.nombre," ")}}function w(i,c){if(1&i&&(e.j41(0,"option",40),e.EFF(1),e.k0s()),2&i){const t=c.$implicit;e.Y8G("value",t.id),e.R7$(1),e.SpI(" ",t.nombre," ")}}function $(i,c){1&i&&e.nrm(0,"span",41)}function G(i,c){1&i&&e.nrm(0,"i",42)}function D(i,c){1&i&&(e.j41(0,"div",6)(1,"div",43)(2,"div",44)(3,"div",45),e.nrm(4,"i",46),e.k0s(),e.j41(5,"h4",47),e.EFF(6,"No hay inventario para esta fecha"),e.k0s(),e.j41(7,"p",48),e.EFF(8," Selecciona una fecha y crea un nuevo inventario o busca uno existente "),e.k0s()()()())}function z(i,c){1&i&&e.nrm(0,"span",41)}function N(i,c){1&i&&e.nrm(0,"i",81)}function Y(i,c){if(1&i){const t=e.RV6();e.j41(0,"div",6)(1,"div",43)(2,"div",73),e.nrm(3,"i",74),e.j41(4,"div",75)(5,"strong"),e.EFF(6,"Inventario en borrador"),e.k0s(),e.EFF(7," - Este inventario no est\xe1 finalizado. Recuerda guardarlo o cancelarlo. "),e.k0s(),e.j41(8,"div",76)(9,"button",77),e.bIt("click",function(){e.eBV(t);const a=e.XpG(2);return e.Njj(a.cancelarInventario())}),e.nrm(10,"i",78),e.EFF(11," Cancelar "),e.k0s(),e.j41(12,"button",79),e.bIt("click",function(){e.eBV(t);const a=e.XpG(2);return e.Njj(a.guardarInventario())}),e.DNE(13,z,1,0,"span",19),e.DNE(14,N,1,0,"i",80),e.EFF(15),e.k0s()()()()()}if(2&i){const t=e.XpG(2);e.R7$(9),e.Y8G("disabled",t.isSaving),e.R7$(3),e.Y8G("disabled",t.isSaving),e.R7$(1),e.Y8G("ngIf",t.isSaving),e.R7$(1),e.Y8G("ngIf",!t.isSaving),e.R7$(1),e.SpI(" ",t.isSaving?"Guardando...":"Finalizar Inventario"," ")}}function B(i,c){if(1&i&&(e.j41(0,"div",82)(1,"div",43)(2,"div",63)(3,"span",83),e.nrm(4,"i",84),e.EFF(5," Inventario Finalizado "),e.k0s(),e.j41(6,"small",85),e.EFF(7),e.nI1(8,"date"),e.k0s()()()()),2&i){const t=e.XpG(2);e.R7$(7),e.SpI(" Finalizado el ",e.i5U(8,1,t.inventarioActual.fechaActualizacion,"dd/MM/yyyy HH:mm")," ")}}function U(i,c){if(1&i&&(e.j41(0,"option",40),e.EFF(1),e.k0s()),2&i){const t=c.$implicit,n=e.XpG(3);e.Y8G("value",t.id),e.R7$(1),e.Lme(" ",t.nombre," (",n.getProductosPorFamilia(t.id||"").length,") ")}}function X(i,c){if(1&i){const t=e.RV6();e.j41(0,"div",82)(1,"div",86)(2,"label",12),e.EFF(3,"Filtrar por Familia"),e.k0s(),e.j41(4,"select",87),e.bIt("ngModelChange",function(a){e.eBV(t);const o=e.XpG(2);return e.Njj(o.familiaSeleccionada=a)})("ngModelChange",function(a){e.eBV(t);const o=e.XpG(2);return e.Njj(o.filtrarPorFamilia(a))}),e.j41(5,"option",15),e.EFF(6),e.k0s(),e.DNE(7,U,2,3,"option",16),e.k0s()()()}if(2&i){const t=e.XpG(2);e.R7$(4),e.Y8G("ngModel",t.familiaSeleccionada),e.R7$(2),e.SpI("Todas las familias (",t.inventarioActual.productos.length,")"),e.R7$(1),e.Y8G("ngForOf",t.familiasDisponibles)}}function V(i,c){1&i&&(e.j41(0,"span",88),e.EFF(1,"Borrador"),e.k0s())}function J(i,c){1&i&&(e.j41(0,"span",89),e.EFF(1,"Finalizado"),e.k0s())}function L(i,c){if(1&i&&(e.j41(0,"span",90),e.EFF(1),e.k0s()),2&i){const t=e.XpG(2);e.R7$(1),e.JRh(t.getNombreFamiliaSeleccionada())}}function H(i,c){1&i&&e.nrm(0,"span",41)}function Z(i,c){1&i&&e.nrm(0,"i",92)}function K(i,c){if(1&i){const t=e.RV6();e.j41(0,"div")(1,"button",77),e.bIt("click",function(){e.eBV(t);const a=e.XpG(2);return e.Njj(a.cancelarInventario())}),e.nrm(2,"i",78),e.EFF(3," Cancelar "),e.k0s(),e.j41(4,"button",79),e.bIt("click",function(){e.eBV(t);const a=e.XpG(2);return e.Njj(a.guardarInventario())}),e.DNE(5,H,1,0,"span",19),e.DNE(6,Z,1,0,"i",91),e.EFF(7),e.k0s()()}if(2&i){const t=e.XpG(2);e.R7$(1),e.Y8G("disabled",t.isSaving),e.R7$(3),e.Y8G("disabled",t.isSaving),e.R7$(1),e.Y8G("ngIf",t.isSaving),e.R7$(1),e.Y8G("ngIf",!t.isSaving),e.R7$(1),e.SpI(" ",t.isSaving?"Finalizando...":"Finalizar Inventario"," ")}}function Q(i,c){1&i&&(e.j41(0,"div")(1,"span",53),e.nrm(2,"i",93),e.EFF(3," Inventario finalizado - Solo lectura "),e.k0s()())}function W(i,c){if(1&i&&(e.j41(0,"small"),e.EFF(1),e.nI1(2,"number"),e.k0s()),2&i){const t=e.XpG().$implicit;e.HbH(t.diferencia>0?"text-success":"text-danger"),e.R7$(1),e.Lme(" ",t.diferencia>0?"+":"","",e.i5U(2,4,t.diferencia,"1.1-1")," ")}}function q(i,c){if(1&i){const t=e.RV6();e.j41(0,"tr")(1,"td")(2,"div")(3,"strong"),e.EFF(4),e.k0s(),e.nrm(5,"br"),e.j41(6,"small",85),e.EFF(7),e.k0s()()(),e.j41(8,"td")(9,"span",94),e.EFF(10),e.k0s()(),e.j41(11,"td"),e.EFF(12),e.k0s(),e.j41(13,"td")(14,"span"),e.EFF(15),e.nI1(16,"number"),e.k0s()(),e.j41(17,"td"),e.EFF(18),e.nI1(19,"currency"),e.k0s(),e.j41(20,"td")(21,"input",95),e.bIt("ngModelChange",function(a){const r=e.eBV(t).$implicit;return e.Njj(r.stockContado=a)})("ngModelChange",function(){const o=e.eBV(t).$implicit,r=e.XpG(2);return e.Njj(r.calcularValorTotal(o))}),e.k0s(),e.DNE(22,W,3,7,"small",96),e.k0s(),e.j41(23,"td")(24,"strong"),e.EFF(25),e.nI1(26,"currency"),e.k0s()()()}if(2&i){const t=c.$implicit,n=e.XpG(2);e.R7$(4),e.JRh(t.nombre),e.R7$(3),e.JRh(t.unidadMedida),e.R7$(3),e.JRh(t.categoria),e.R7$(2),e.JRh(t.proveedor),e.R7$(2),e.HbH(n.getStockClass(t.stockActual)),e.R7$(1),e.SpI(" ",e.i5U(16,16,t.stockActual,"1.1-1")," "),e.R7$(3),e.SpI(" ",e.ii3(19,19,t.costoUnitario,"EUR","symbol","1.2-2")," "),e.R7$(3),e.AVh("is-invalid",0!==t.diferencia),e.Y8G("ngModel",t.stockContado)("disabled","finalizado"===n.inventarioActual.estado),e.R7$(1),e.Y8G("ngIf",0!==t.diferencia),e.R7$(2),e.HbH(0!==t.diferencia?"text-danger":"text-success"),e.R7$(1),e.SpI(" ",e.ii3(26,24,t.valorTotal,"EUR","symbol","1.0-0")," ")}}function ee(i,c){if(1&i&&(e.j41(0,"div"),e.DNE(1,Y,16,5,"div",21),e.DNE(2,B,9,4,"div",49),e.j41(3,"div",6)(4,"div",50)(5,"div",8)(6,"div",51)(7,"div",52)(8,"span",53),e.EFF(9,"Inversi\xf3n Total"),e.k0s(),e.nrm(10,"i",54),e.k0s(),e.j41(11,"h3",55),e.EFF(12),e.nI1(13,"currency"),e.k0s()()()(),e.j41(14,"div",50)(15,"div",8)(16,"div",51)(17,"div",52)(18,"span",53),e.EFF(19,"Total Productos"),e.k0s(),e.nrm(20,"i",56),e.k0s(),e.j41(21,"h3",57),e.EFF(22),e.k0s()()()(),e.j41(23,"div",50)(24,"div",8)(25,"div",51)(26,"div",52)(27,"span",53),e.EFF(28,"Total Unidades"),e.k0s(),e.nrm(29,"i",58),e.k0s(),e.j41(30,"h3",59),e.EFF(31),e.nI1(32,"number"),e.k0s()()()(),e.j41(33,"div",50)(34,"div",8)(35,"div",51)(36,"div",52)(37,"span",53),e.EFF(38,"Costo Promedio"),e.k0s(),e.nrm(39,"i",60),e.k0s(),e.j41(40,"h3",61),e.EFF(41),e.nI1(42,"currency"),e.k0s()()()()(),e.DNE(43,X,8,3,"div",49),e.j41(44,"div",6)(45,"div",43)(46,"div",8)(47,"div",62)(48,"div",63)(49,"h5",64),e.EFF(50),e.DNE(51,V,2,0,"span",65),e.DNE(52,J,2,0,"span",66),e.DNE(53,L,2,1,"span",67),e.k0s(),e.DNE(54,K,8,5,"div",22),e.DNE(55,Q,4,0,"div",22),e.k0s()(),e.j41(56,"div",68)(57,"div",69)(58,"table",70)(59,"thead",71)(60,"tr")(61,"th"),e.EFF(62,"PRODUCTO"),e.k0s(),e.j41(63,"th"),e.EFF(64,"CATEGOR\xcdA"),e.k0s(),e.j41(65,"th"),e.EFF(66,"PROVEEDOR"),e.k0s(),e.j41(67,"th"),e.EFF(68,"STOCK ACTUAL"),e.k0s(),e.j41(69,"th"),e.EFF(70,"COSTO UNITARIO"),e.k0s(),e.j41(71,"th"),e.EFF(72,"STOCK CONTADO"),e.k0s(),e.j41(73,"th"),e.EFF(74,"VALOR TOTAL"),e.k0s()()(),e.j41(75,"tbody"),e.DNE(76,q,27,29,"tr",72),e.k0s()()()()()()()()),2&i){const t=e.XpG();e.R7$(1),e.Y8G("ngIf","borrador"===t.inventarioActual.estado),e.R7$(1),e.Y8G("ngIf","finalizado"===t.inventarioActual.estado),e.R7$(10),e.SpI(" ",e.ii3(13,16,t.inventarioActual.inversionTotal,"EUR","symbol","1.0-0")," "),e.R7$(10),e.SpI(" ",t.inventarioActual.totalProductos," "),e.R7$(9),e.SpI(" ",e.i5U(32,21,t.inventarioActual.totalUnidades,"1.1-1")," "),e.R7$(10),e.SpI(" ",e.ii3(42,24,t.inventarioActual.costoPromedio,"EUR","symbol","1.0-0")," "),e.R7$(2),e.Y8G("ngIf",t.familiasDisponibles.length>0),e.R7$(7),e.Lme(" Productos del Inventario (",t.productosFiltrados.length," de ",t.inventarioActual.productos.length,") "),e.R7$(1),e.Y8G("ngIf","borrador"===t.inventarioActual.estado),e.R7$(1),e.Y8G("ngIf","finalizado"===t.inventarioActual.estado),e.R7$(1),e.Y8G("ngIf",t.familiaSeleccionada),e.R7$(1),e.Y8G("ngIf","borrador"===t.inventarioActual.estado),e.R7$(1),e.Y8G("ngIf","finalizado"===t.inventarioActual.estado),e.R7$(21),e.Y8G("ngForOf",t.productosFiltrados)("ngForTrackBy",t.trackByProducto)}}function te(i,c){1&i&&(e.j41(0,"div",6)(1,"div",43)(2,"div",44)(3,"div",97)(4,"span",98),e.EFF(5,"Cargando..."),e.k0s()(),e.j41(6,"h4",47),e.EFF(7,"Creando inventario..."),e.k0s(),e.j41(8,"p",85),e.EFF(9," Cargando productos y preparando el inventario para la fecha seleccionada "),e.k0s()()()())}function ne(i,c){if(1&i&&(e.j41(0,"div",107)(1,"small",108),e.EFF(2),e.k0s()()),2&i){const t=e.XpG().$implicit,n=e.XpG();e.R7$(2),e.Lme(" ",t.familias.length," familias: ",n.getFamiliasNombres(t.familias)," ")}}function ie(i,c){if(1&i){const t=e.RV6();e.j41(0,"div",99)(1,"div",100),e.bIt("click",function(){const o=e.eBV(t).$implicit,r=e.XpG();return e.Njj(r.seleccionarCategoria(o.id||""))}),e.j41(2,"div",9)(3,"div",101)(4,"div",102),e.nrm(5,"i"),e.k0s(),e.j41(6,"div",75)(7,"h6",103),e.EFF(8),e.k0s(),e.j41(9,"small",85),e.EFF(10),e.k0s(),e.DNE(11,ne,3,2,"div",104),e.k0s(),e.j41(12,"div",105),e.nrm(13,"i",106),e.k0s()()()()()}if(2&i){const t=c.$implicit,n=e.XpG();e.R7$(1),e.AVh("selected",n.categoriaSeleccionada===t.id),e.R7$(3),e.xc7("background-color",t.colorFondo),e.R7$(1),e.HbH("bi "+t.icono+" text-white"),e.R7$(3),e.JRh(t.nombre),e.R7$(2),e.SpI("",n.getTotalProductosCategoria(t.id)," productos"),e.R7$(1),e.Y8G("ngIf",t.familias&&t.familias.length>0),e.R7$(2),e.HbH(n.categoriaSeleccionada===t.id?"bi-check-circle-fill text-success":"bi-circle text-muted")}}function ae(i,c){if(1&i&&(e.j41(0,"span",116),e.EFF(1),e.k0s()),2&i){const t=c.$implicit,n=e.XpG(3);e.R7$(1),e.Lme(" ",t.nombre," (",n.getProductosPorFamiliaEnCategoria(t.id||"").length," productos) ")}}function oe(i,c){if(1&i&&(e.j41(0,"div",113)(1,"h6",110),e.EFF(2,"Familias incluidas:"),e.k0s(),e.j41(3,"div",114),e.DNE(4,ae,2,2,"span",115),e.k0s()()),2&i){const t=e.XpG(2);e.R7$(4),e.Y8G("ngForOf",t.getFamiliasCategoria())}}function re(i,c){if(1&i&&(e.j41(0,"div",43)(1,"div",109)(2,"h6",110),e.nrm(3,"i",111),e.EFF(4," Categor\xeda seleccionada: "),e.j41(5,"strong"),e.EFF(6),e.k0s()(),e.j41(7,"p",110),e.EFF(8," Se incluir\xe1n "),e.j41(9,"strong"),e.EFF(10),e.k0s(),e.EFF(11," productos de esta categor\xeda en el inventario. "),e.k0s(),e.DNE(12,oe,5,1,"div",112),e.k0s()()),2&i){const t=e.XpG();e.R7$(6),e.JRh(t.getNombreCategoriaSeleccionada()),e.R7$(4),e.JRh(t.getTotalProductosCategoria()),e.R7$(2),e.Y8G("ngIf",t.getFamiliasCategoria().length>0)}}function ce(i,c){1&i&&e.nrm(0,"span",41)}function se(i,c){1&i&&e.nrm(0,"i",117)}const le=[{path:"",component:(()=>{class i{constructor(t,n){this.firestore=t,this.authService=n,this.isLoading=!1,this.isCreatingInventory=!1,this.isSaving=!1,this.inventarioActual=null,this.productos=[],this.categorias=[],this.proveedores=[],this.fechaSeleccionada=new Date,this.fechaFiltro=new u.MJ((new Date).toISOString().split("T")[0]),this.categoriaFiltro=new u.MJ(""),this.proveedorFiltro=new u.MJ(""),this.categoriaSeleccionada="",this.familiasDisponibles=[],this.familiaSeleccionada="",this.productosFiltrados=[],this.subscriptions=new R.yU}convertirFecha(t){if(t){if(t instanceof Date)return t;if("object"==typeof t&&"toDate"in t)return t.toDate();if("string"==typeof t)return new Date(t)}}limpiarObjetoParaFirebase(t){const n={};for(const[a,o]of Object.entries(t))null!=o&&(n[a]=Array.isArray(o)?o.map(r=>"object"==typeof r?this.limpiarObjetoParaFirebase(r):r):"object"==typeof o&&null!==o?this.limpiarObjetoParaFirebase(o):o);return n}ngOnInit(){this.authService.getCurrentUser()?(this.cargarDatosIniciales(),this.setupFiltros(),this.buscarInventario()):l().fire("Error","Usuario no autenticado","error")}ngOnDestroy(){this.subscriptions.unsubscribe()}setupFiltros(){this.subscriptions.add(this.fechaFiltro.valueChanges.subscribe(t=>{if(t)try{this.fechaSeleccionada=new Date(t)}catch{this.fechaSeleccionada=new Date}}))}cargarDatosIniciales(){var t=this;return(0,_.A)(function*(){try{const n=(0,s.rJ)(t.firestore,"productos");t.subscriptions.add((0,s.xs)(n,{idField:"id"}).subscribe({next:r=>{t.productos=r.filter(m=>!m.esCombinado)},error:r=>{l().fire("Error","Error al cargar productos","error")}}));const a=(0,s.rJ)(t.firestore,"categorias");t.subscriptions.add((0,s.xs)(a,{idField:"id"}).subscribe({next:r=>{t.categorias=r,t.inventarioActual&&(t.configurarFamiliasDisponibles(),t.aplicarFiltroFamilia())},error:r=>{l().fire("Error","Error al cargar categor\xedas","error")}}));const o=(0,s.rJ)(t.firestore,"proveedores");t.subscriptions.add((0,s.xs)(o,{idField:"id"}).subscribe({next:r=>{t.proveedores=r},error:r=>{l().fire("Error","Error al cargar proveedores","error")}}))}catch{l().fire("Error","Error al cargar los datos iniciales","error")}})()}buscarInventario(){var t=this;return(0,_.A)(function*(){t.isLoading=!0;try{const n=t.fechaSeleccionada.toISOString().split("T")[0],a=(0,s.rJ)(t.firestore,"inventarios"),o=(0,s.P)(a,(0,s._M)("fecha","==",n)),r=yield(0,s.GG)(o);if(r.empty)t.inventarioActual=null;else{const m=r.docs.filter(v=>!v.data().eliminado);if(m.length>0){const v=m.filter(h=>"borrador"===h.data().estado),p=v.length>0?v[0]:m[0];t.inventarioActual={id:p.id,...p.data()},t.inventarioActual.fecha=t.convertirFecha(t.inventarioActual.fecha)||t.inventarioActual.fecha,t.inventarioActual.fechaActualizacion=t.convertirFecha(t.inventarioActual.fechaActualizacion),t.inventarioActual.fechaCreacion=t.convertirFecha(t.inventarioActual.fechaCreacion),"borrador"===t.inventarioActual.estado&&setTimeout(()=>{const F=t.categorias.find(P=>P.id===t.inventarioActual?.categoriaId)?.nombre||"Sin categor\xeda";l().fire({title:"Inventario en borrador encontrado",text:`Se ha cargado un inventario en borrador de ${F} para esta fecha. Puedes continuar edit\xe1ndolo.`,icon:"info",confirmButtonText:"Continuar",timer:3e3,timerProgressBar:!0})},1e3)}else t.inventarioActual=null}t.inventarioActual&&(t.configurarFamiliasDisponibles(),t.aplicarFiltroFamilia())}catch{t.inventarioActual=null}finally{t.isLoading=!1}})()}crearNuevoInventario(){var t=this;return(0,_.A)(function*(){if(!t.inventarioActual||(yield l().fire({title:"\xbfCrear nuevo inventario?",text:"Ya existe un inventario para esta fecha. \xbfDeseas reemplazarlo?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#dc3545",cancelButtonColor:"#6c757d",confirmButtonText:"S\xed, crear nuevo",cancelButtonText:"Cancelar"})).isConfirmed){t.isCreatingInventory=!0;try{let n=[...t.productos];const a=t.categoriaFiltro.value,o=t.proveedorFiltro.value;a&&(n=n.filter(g=>g.categoriaId===a)),o&&(n=n.filter(g=>g.proveedorId===o));const r=n.map(g=>{const b=t.categorias.find(M=>M.id===g.categoriaId),x=t.proveedores.find(M=>M.id===g.proveedorId);return{productoId:g.id,nombre:g.nombre,categoria:b?.nombre||"Sin categor\xeda",proveedor:x?.nombre||"Sin proveedor",stockActual:g.stock||0,stockContado:null,costoUnitario:g.costo,valorTotal:(g.stock||0)*g.costo,unidadMedida:g.unidadMedida,diferencia:0}}),m=r.reduce((g,b)=>g+b.valorTotal,0),v=r.length,p=r.reduce((g,b)=>g+(b.stockContado??0),0),h=p>0?m/p:0,F={fecha:t.fechaSeleccionada.toISOString().split("T")[0],categoriaId:a||void 0,proveedorId:o||void 0,productos:r,inversionTotal:m,totalProductos:v,totalUnidades:p,costoPromedio:h,fechaCreacion:(0,s.O5)(),usuarioId:t.authService.getCurrentUser()?.id,estado:"borrador"},P=t.limpiarObjetoParaFirebase(F),k=(0,s.rJ)(t.firestore,"inventarios"),O=yield(0,s.gS)(k,P);t.inventarioActual={id:O.id,fecha:t.fechaSeleccionada,categoriaId:a||void 0,proveedorId:o||void 0,productos:r,inversionTotal:m,totalProductos:v,totalUnidades:p,costoPromedio:h,fechaCreacion:new Date,usuarioId:t.authService.getCurrentUser()?.id,estado:"borrador"},a&&t.categorias.find(g=>g.id===a),l().fire("\xa1Creado!",`Inventario creado con ${v} productos. Puedes editarlo y luego finalizarlo.`,"success")}catch{l().fire("Error","Error al crear el inventario","error")}finally{t.isCreatingInventory=!1}}})()}recalcularTotales(){this.inventarioActual&&(this.inventarioActual.inversionTotal=this.inventarioActual.productos.reduce((t,n)=>t+n.valorTotal,0),this.inventarioActual.totalUnidades=this.inventarioActual.productos.reduce((t,n)=>t+(n.stockContado??0),0),this.inventarioActual.costoPromedio=this.inventarioActual.totalUnidades>0?this.inventarioActual.inversionTotal/this.inventarioActual.totalUnidades:0)}guardarInventario(){var t=this;return(0,_.A)(function*(){if(t.inventarioActual&&("borrador"!==t.inventarioActual.estado||(yield l().fire({title:"\xbfFinalizar inventario?",text:"Una vez finalizado, no podr\xe1s editarlo. \xbfEst\xe1s seguro?",icon:"question",showCancelButton:!0,confirmButtonColor:"#dc3545",cancelButtonColor:"#6c757d",confirmButtonText:"S\xed, finalizar",cancelButtonText:"Cancelar"})).isConfirmed)){t.isSaving=!0;try{const n={...t.inventarioActual,fecha:t.fechaSeleccionada.toISOString().split("T")[0],fechaActualizacion:(0,s.O5)(),estado:"finalizado"},a=t.limpiarObjetoParaFirebase(n);if(t.inventarioActual.id){const o=(0,s.H9)(t.firestore,"inventarios",t.inventarioActual.id);yield(0,s.mZ)(o,a),t.inventarioActual.estado="finalizado",t.inventarioActual.fechaActualizacion=new Date}else{const o=(0,s.rJ)(t.firestore,"inventarios"),r=yield(0,s.gS)(o,a);t.inventarioActual.id=r.id,t.inventarioActual.estado="finalizado"}l().fire("\xa1Finalizado!","Inventario finalizado exitosamente","success")}catch{l().fire("Error","Error al finalizar el inventario","error")}finally{t.isSaving=!1}}})()}getStockClass(t){return t<=0?"text-danger fw-bold":t<=5?"text-warning fw-bold":"text-success fw-bold"}trackByProducto(t,n){return n.productoId}cancelarInventario(){var t=this;return(0,_.A)(function*(){if(t.inventarioActual?.id){if((yield l().fire({title:"\xbfCancelar inventario?",text:"Se eliminar\xe1 completamente el inventario en borrador. Esta acci\xf3n no se puede deshacer.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#dc3545",cancelButtonColor:"#6c757d",confirmButtonText:"S\xed, eliminar",cancelButtonText:"No cancelar"})).isConfirmed){t.isSaving=!0;try{const a=(0,s.H9)(t.firestore,"inventarios",t.inventarioActual.id);yield(0,s.kd)(a),t.inventarioActual=null,t.familiasDisponibles=[],t.familiaSeleccionada="",t.productosFiltrados=[],l().fire({title:"\xa1Eliminado!",text:"El inventario ha sido eliminado completamente",icon:"success",timer:2e3,timerProgressBar:!0})}catch{l().fire("Error","Error al eliminar el inventario","error")}finally{t.isSaving=!1}}}else l().fire("Error","No hay inventario para cancelar","error")})()}calcularValorTotal(t){if("finalizado"===this.inventarioActual?.estado)return;const n=t.stockContado??0;t.diferencia=n-t.stockActual,t.valorTotal=n*t.costoUnitario,this.recalcularTotales(),"borrador"===this.inventarioActual?.estado&&this.autoGuardarBorrador()}autoGuardarBorrador(){this.autoSaveTimeout&&clearTimeout(this.autoSaveTimeout),this.autoSaveTimeout=setTimeout(()=>{this.guardarBorrador()},2e3)}guardarBorrador(){var t=this;return(0,_.A)(function*(){if(t.inventarioActual?.id&&"borrador"===t.inventarioActual.estado)try{const n=(0,s.H9)(t.firestore,"inventarios",t.inventarioActual.id);yield(0,s.mZ)(n,{productos:t.inventarioActual.productos,inversionTotal:t.inventarioActual.inversionTotal,totalUnidades:t.inventarioActual.totalUnidades,costoPromedio:t.inventarioActual.costoPromedio,fechaActualizacion:(0,s.O5)()})}catch{}})()}abrirModalNuevoInventario(){this.categoriaSeleccionada="";const t=document.getElementById("modalNuevoInventario");t&&(this.modal=new bootstrap.Modal(t),this.modal.show())}cerrarModalNuevoInventario(){this.modal&&this.modal.hide(),this.categoriaSeleccionada=""}seleccionarCategoria(t){this.categoriaSeleccionada=t}getNombreCategoriaSeleccionada(){return this.categorias.find(n=>n.id===this.categoriaSeleccionada)?.nombre||""}getTotalProductosCategoria(t){const n=t||this.categoriaSeleccionada;return n?this.productos.filter(a=>a.categoriaId===n&&!a.esCombinado).length:0}getFamiliasCategoria(){return this.categorias.find(n=>n.id===this.categoriaSeleccionada)?.familias||[]}getProductosPorFamiliaEnCategoria(t){return this.productos.filter(n=>n.categoriaId===this.categoriaSeleccionada&&n.familiaId===t&&!n.esCombinado)}getFamiliasNombres(t){return t&&0!==t.length?t.map(n=>n.nombre).join(", "):""}crearInventarioConSeleccion(){var t=this;return(0,_.A)(function*(){if(t.categoriaSeleccionada)if(0!==t.productos.length)if(0!==t.categorias.length){if(t.inventarioActual){const a="borrador"===t.inventarioActual.estado?"en borrador":"finalizado";if(!(yield l().fire({title:"\xbfCrear nuevo inventario?",text:`Ya existe un inventario ${a} para esta fecha. \xbfDeseas reemplazarlo?`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#dc3545",cancelButtonColor:"#6c757d",confirmButtonText:"S\xed, reemplazar",cancelButtonText:"Cancelar"})).isConfirmed)return;if(t.inventarioActual.id)try{const r=(0,s.H9)(t.firestore,"inventarios",t.inventarioActual.id);yield(0,s.kd)(r)}catch(r){console.error("Error eliminando inventario anterior:",r)}}t.isCreatingInventory=!0;try{const n=t.authService.getCurrentUser();if(!n?.id)return void l().fire("Error","Usuario no autenticado","error");const a=t.productos.filter(d=>d.categoriaId===t.categoriaSeleccionada&&!d.esCombinado);if(0===a.length)return void l().fire("Error","No hay productos disponibles en la categor\xeda seleccionada.","error");const o=a.map(d=>{const I=t.categorias.find(x=>x.id===d.categoriaId),g=t.proveedores.find(x=>x.id===d.proveedorId),b={productoId:d.id||"",nombre:d.nombre||"",categoria:I?.nombre||"Sin categor\xeda",proveedor:g?.nombre||"Sin proveedor",stockActual:d.stock||0,stockContado:null,costoUnitario:d.costo||0,valorTotal:(d.stock||0)*(d.costo||0),unidadMedida:d.unidadMedida||"",diferencia:0};return d.familiaId&&(b.familiaId=d.familiaId),b}),r=o.reduce((d,I)=>d+I.valorTotal,0),m=o.length,v=o.reduce((d,I)=>d+(I.stockContado??0),0),p=v>0?r/v:0,h={fecha:t.fechaSeleccionada.toISOString().split("T")[0],categoriaId:t.categoriaSeleccionada||"",productos:o,inversionTotal:r||0,totalProductos:m||0,totalUnidades:v||0,costoPromedio:p||0,fechaCreacion:(0,s.O5)(),usuarioId:n.id||"",estado:"borrador"},F=t.limpiarObjetoParaFirebase(h),P=(0,s.rJ)(t.firestore,"inventarios"),k=yield(0,s.gS)(P,F);t.inventarioActual={id:k.id,fecha:t.fechaSeleccionada,categoriaId:t.categoriaSeleccionada,productos:o,inversionTotal:r,totalProductos:m,totalUnidades:v,costoPromedio:p,fechaCreacion:new Date,usuarioId:n.id,estado:"borrador"},t.configurarFamiliasDisponibles(),t.aplicarFiltroFamilia(),t.cerrarModalNuevoInventario();const O=t.getNombreCategoriaSeleccionada();l().fire("\xa1Creado!",`Inventario de ${O} creado con ${m} productos. Puedes editarlo y luego finalizarlo.`,"success")}catch(n){let a="Error al crear el inventario";n?.message&&(a+=": "+n.message),l().fire("Error",a,"error")}finally{t.isCreatingInventory=!1}}else l().fire("Error","No se han cargado las categor\xedas. Intenta recargar la p\xe1gina.","error");else l().fire("Error","No se han cargado los productos. Intenta recargar la p\xe1gina.","error");else l().fire("Error","Selecciona una categor\xeda para el inventario","error")})()}configurarFamiliasDisponibles(){if(!this.inventarioActual)return;const t=new Set,n=new Map,a=this.categorias.find(o=>o.id===this.inventarioActual?.categoriaId);a?.familias&&a.familias.forEach(o=>{o.id&&!t.has(o.id)&&(t.add(o.id),n.set(o.id,o))}),this.familiasDisponibles=Array.from(n.values())}filtrarPorFamilia(t){this.familiaSeleccionada=t,this.aplicarFiltroFamilia()}aplicarFiltroFamilia(){this.inventarioActual&&(this.productosFiltrados=this.familiaSeleccionada?this.inventarioActual.productos.filter(t=>this.productos.find(a=>a.id===t.productoId)?.familiaId===this.familiaSeleccionada):[...this.inventarioActual.productos])}getProductosPorFamilia(t){return this.inventarioActual?this.inventarioActual.productos.filter(n=>this.productos.find(o=>o.id===n.productoId)?.familiaId===t):[]}getNombreFamiliaSeleccionada(){return this.familiasDisponibles.find(n=>n.id===this.familiaSeleccionada)?.nombre||""}static{this.\u0275fac=function(n){return new(n||i)(e.rXU(s._7),e.rXU(A.u))}}static{this.\u0275cmp=e.VBU({type:i,selectors:[["app-inventario-page"]],decls:67,vars:23,consts:[[1,"container-fluid"],[1,"row"],[1,"col-8"],[1,"col","text-end"],[1,"btn","btn-danger",3,"disabled","click"],[1,"bi","bi-plus-lg","me-2"],[1,"row","mt-4"],[1,"col"],[1,"card","border-0","shadow-sm"],[1,"card-body"],[1,"row","align-items-center"],[1,"col-12","col-md-3","mb-2","mb-md-0"],[1,"form-label","small","text-muted"],["type","date",1,"form-control",3,"formControl","value"],[1,"form-select",3,"formControl"],["value",""],[3,"value",4,"ngFor","ngForOf"],[1,"col-12","col-md-3","text-end","mt-4"],[1,"btn","btn-outline-danger","w-100",3,"disabled","click"],["class","spinner-border spinner-border-sm me-2",4,"ngIf"],["class","bi bi-search me-2",4,"ngIf"],["class","row mt-4",4,"ngIf"],[4,"ngIf"],["id","modalNuevoInventario","tabindex","-1","data-bs-backdrop","static",1,"modal","fade"],[1,"modal-dialog","modal-lg"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],[1,"bi","bi-clipboard-check","me-2"],["type","button",1,"btn-close",3,"click"],[1,"modal-body"],[1,"col-12","mb-4"],[1,"mb-3"],[1,"bi","bi-tags","me-2"],["class","col-md-6 mb-3",4,"ngFor","ngForOf"],["class","col-12",4,"ngIf"],[1,"modal-footer"],["type","button",1,"btn","btn-secondary",3,"click"],["type","button",1,"btn","btn-danger",3,"disabled","click"],["class","bi bi-plus me-2",4,"ngIf"],[3,"value"],[1,"spinner-border","spinner-border-sm","me-2"],[1,"bi","bi-search","me-2"],[1,"col-12"],[1,"text-center","py-5"],[1,"mb-4"],[1,"bi","bi-archive","text-muted",2,"font-size","4rem"],[1,"text-muted","mb-3"],[1,"text-muted","mb-4"],["class","row mt-3",4,"ngIf"],[1,"col-12","col-md-3","mb-3"],[1,"card-body","text-center"],[1,"d-flex","justify-content-between","align-items-center","mb-2"],[1,"text-muted","small"],[1,"bi","bi-currency-euro","text-danger"],[1,"text-danger","fw-bold","mb-0"],[1,"bi","bi-box","text-info"],[1,"text-info","fw-bold","mb-0"],[1,"bi","bi-graph-up","text-success"],[1,"text-success","fw-bold","mb-0"],[1,"bi","bi-calculator","text-warning"],[1,"text-warning","fw-bold","mb-0"],[1,"card-header","bg-white","border-0","py-3"],[1,"d-flex","justify-content-between","align-items-center"],[1,"mb-0"],["class","badge bg-warning ms-2",4,"ngIf"],["class","badge bg-success ms-2",4,"ngIf"],["class","badge bg-info ms-2",4,"ngIf"],[1,"card-body","p-0"],[1,"table-responsive"],[1,"table","table-hover","mb-0"],[1,"table-light"],[4,"ngFor","ngForOf","ngForTrackBy"],["role","alert",1,"alert","alert-warning","d-flex","align-items-center"],[1,"bi","bi-exclamation-triangle-fill","me-2"],[1,"flex-grow-1"],[1,"ms-3"],[1,"btn","btn-outline-secondary","btn-sm","me-2",3,"disabled","click"],[1,"bi","bi-x-lg","me-1"],[1,"btn","btn-danger","btn-sm",3,"disabled","click"],["class","bi bi-save me-1",4,"ngIf"],[1,"bi","bi-save","me-1"],[1,"row","mt-3"],[1,"badge","bg-success","fs-6"],[1,"bi","bi-check-circle","me-1"],[1,"text-muted"],[1,"col-12","col-md-4"],[1,"form-select",3,"ngModel","ngModelChange"],[1,"badge","bg-warning","ms-2"],[1,"badge","bg-success","ms-2"],[1,"badge","bg-info","ms-2"],["class","bi bi-save me-2",4,"ngIf"],[1,"bi","bi-save","me-2"],[1,"bi","bi-lock","me-1"],[1,"badge","bg-primary","rounded-pill"],["type","number","step","0.1","min","0","placeholder","Ingrese cantidad contada",1,"form-control","form-control-sm",2,"width","100px",3,"ngModel","disabled","ngModelChange"],[3,"class",4,"ngIf"],["role","status",1,"spinner-border","text-danger","mb-3"],[1,"visually-hidden"],[1,"col-md-6","mb-3"],[1,"card","h-100","cursor-pointer","categoria-card",3,"click"],[1,"d-flex","align-items-center"],[1,"rounded-circle","p-2","me-3"],[1,"mb-1"],["class","mt-1",4,"ngIf"],[1,"ms-2"],[1,"bi","fs-5"],[1,"mt-1"],[1,"text-info"],[1,"alert","alert-success"],[1,"mb-2"],[1,"bi","bi-check-circle","me-2"],["class","mt-3",4,"ngIf"],[1,"mt-3"],[1,"d-flex","flex-wrap","gap-2"],["class","badge bg-primary","style","font-size: 0.85rem; padding: 6px 12px;",4,"ngFor","ngForOf"],[1,"badge","bg-primary",2,"font-size","0.85rem","padding","6px 12px"],[1,"bi","bi-plus","me-2"]],template:function(n,a){1&n&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3"),e.EFF(4,"Gesti\xf3n de Inventario"),e.k0s(),e.j41(5,"span"),e.EFF(6,"Control y conteo de stock por fechas"),e.k0s()(),e.j41(7,"div",3)(8,"button",4),e.bIt("click",function(){return a.abrirModalNuevoInventario()}),e.nrm(9,"i",5),e.EFF(10," Nuevo Inventario "),e.k0s()()(),e.j41(11,"div",6)(12,"div",7)(13,"div",8)(14,"div",9)(15,"div",10)(16,"div",11)(17,"label",12),e.EFF(18,"Fecha del Inventario"),e.k0s(),e.nrm(19,"input",13),e.nI1(20,"date"),e.k0s(),e.j41(21,"div",11)(22,"label",12),e.EFF(23,"Categor\xeda"),e.k0s(),e.j41(24,"select",14)(25,"option",15),e.EFF(26,"Todas las categor\xedas"),e.k0s(),e.DNE(27,T,2,2,"option",16),e.k0s()(),e.j41(28,"div",11)(29,"label",12),e.EFF(30,"Proveedor"),e.k0s(),e.j41(31,"select",14)(32,"option",15),e.EFF(33,"Todos los proveedores"),e.k0s(),e.DNE(34,w,2,2,"option",16),e.k0s()(),e.j41(35,"div",17)(36,"button",18),e.bIt("click",function(){return a.buscarInventario()}),e.DNE(37,$,1,0,"span",19),e.DNE(38,G,1,0,"i",20),e.EFF(39),e.k0s()()()()()()(),e.DNE(40,D,9,0,"div",21),e.DNE(41,ee,77,29,"div",22),e.DNE(42,te,10,0,"div",21),e.k0s(),e.j41(43,"div",23)(44,"div",24)(45,"div",25)(46,"div",26)(47,"h5",27),e.nrm(48,"i",28),e.EFF(49," Crear Nuevo Inventario "),e.k0s(),e.j41(50,"button",29),e.bIt("click",function(){return a.cerrarModalNuevoInventario()}),e.k0s()(),e.j41(51,"div",30)(52,"div",1)(53,"div",31)(54,"h6",32),e.nrm(55,"i",33),e.EFF(56," Selecciona la categor\xeda para el inventario: "),e.k0s(),e.j41(57,"div",1),e.DNE(58,ie,14,11,"div",34),e.k0s()(),e.DNE(59,re,13,3,"div",35),e.k0s()(),e.j41(60,"div",36)(61,"button",37),e.bIt("click",function(){return a.cerrarModalNuevoInventario()}),e.EFF(62," Cancelar "),e.k0s(),e.j41(63,"button",38),e.bIt("click",function(){return a.crearInventarioConSeleccion()}),e.DNE(64,ce,1,0,"span",19),e.DNE(65,se,1,0,"i",39),e.EFF(66),e.k0s()()()()()),2&n&&(e.R7$(8),e.Y8G("disabled",a.isLoading),e.R7$(11),e.Y8G("formControl",a.fechaFiltro)("value",e.i5U(20,20,a.fechaSeleccionada,"yyyy-MM-dd")),e.R7$(5),e.Y8G("formControl",a.categoriaFiltro),e.R7$(3),e.Y8G("ngForOf",a.categorias),e.R7$(4),e.Y8G("formControl",a.proveedorFiltro),e.R7$(3),e.Y8G("ngForOf",a.proveedores),e.R7$(2),e.Y8G("disabled",a.isLoading),e.R7$(1),e.Y8G("ngIf",a.isLoading),e.R7$(1),e.Y8G("ngIf",!a.isLoading),e.R7$(1),e.SpI(" ",a.isLoading?"Buscando...":"Buscar"," "),e.R7$(1),e.Y8G("ngIf",!a.inventarioActual&&!a.isLoading),e.R7$(1),e.Y8G("ngIf",a.inventarioActual&&!a.isCreatingInventory),e.R7$(1),e.Y8G("ngIf",a.isCreatingInventory),e.R7$(16),e.Y8G("ngForOf",a.categorias),e.R7$(1),e.Y8G("ngIf",a.categoriaSeleccionada),e.R7$(4),e.Y8G("disabled",!a.categoriaSeleccionada||a.isCreatingInventory),e.R7$(1),e.Y8G("ngIf",a.isCreatingInventory),e.R7$(1),e.Y8G("ngIf",!a.isCreatingInventory),e.R7$(1),e.SpI(" ",a.isCreatingInventory?"Creando...":"Crear Inventario"," "))},dependencies:[C.Sq,C.bT,u.xH,u.y7,u.me,u.Q0,u.wz,u.BC,u.VZ,u.l_,u.vS,C.QX,C.oe,C.vh],styles:['.table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-size:.75rem;font-weight:600;text-transform:uppercase;letter-spacing:.5px;color:#6c757d;border-bottom:2px solid #dee2e6}.table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{vertical-align:middle;font-size:.875rem}.form-control-sm[_ngcontent-%COMP%]{font-size:.875rem}.badge[_ngcontent-%COMP%]{font-size:.75rem}.text-danger.fw-bold[_ngcontent-%COMP%]{color:#dc3545!important}.text-warning.fw-bold[_ngcontent-%COMP%]{color:#ffc107!important}.text-success.fw-bold[_ngcontent-%COMP%]{color:#198754!important}.card[_ngcontent-%COMP%]{transition:transform .2s ease-in-out}.card[_ngcontent-%COMP%]:hover{transform:translateY(-2px)}.spinner-border[_ngcontent-%COMP%]{width:2rem;height:2rem}@media (max-width: 768px){.table-responsive[_ngcontent-%COMP%]{font-size:.8rem;border-radius:.5rem;box-shadow:0 2px 8px #0000001a}.form-control-sm[_ngcontent-%COMP%]{width:70px!important;font-size:.75rem}.table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-size:.65rem;padding:.5rem .25rem}.table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-size:.75rem;padding:.5rem .25rem}.card-header[_ngcontent-%COMP%]{padding:.75rem 1rem}.card-header[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{font-size:1rem}.card-header[_ngcontent-%COMP%]   .btn-sm[_ngcontent-%COMP%]{font-size:.75rem;padding:.25rem .5rem}}.is-invalid[_ngcontent-%COMP%]{border-color:#dc3545;box-shadow:0 0 0 .2rem #dc354540}input[type=number][_ngcontent-%COMP%]{text-align:center}input[type=number][_ngcontent-%COMP%]:focus{border-color:#dc3545;box-shadow:0 0 0 .2rem #dc354540}.bi-archive[_ngcontent-%COMP%]{opacity:.5}.btn-outline-danger[_ngcontent-%COMP%]:hover{background-color:#dc3545;border-color:#dc3545}.cursor-pointer[_ngcontent-%COMP%]{cursor:pointer}.area-card[_ngcontent-%COMP%], .categoria-card[_ngcontent-%COMP%]{transition:all .3s ease;border:2px solid transparent}.area-card[_ngcontent-%COMP%]:hover, .categoria-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 4px 12px #00000026}.area-card.selected[_ngcontent-%COMP%], .categoria-card.selected[_ngcontent-%COMP%]{border-color:var(--bs-primary);background-color:#0d6efd0d}.area-card.selected[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%], .categoria-card.selected[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]{background-color:transparent}.area-card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]{padding:2rem}.area-card[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{transition:transform .3s ease}.area-card[_ngcontent-%COMP%]:hover   i[_ngcontent-%COMP%]{transform:scale(1.1)}.categoria-card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]{padding:1rem}.btn-group[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{transition:all .2s ease}.btn-group[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:hover{transform:translateY(-1px)}@media (max-width: 768px){.area-card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]{padding:1.5rem}.btn-group[_ngcontent-%COMP%]{flex-wrap:wrap}.btn-group[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{margin-bottom:.5rem}}@media (max-width: 576px){.area-card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]{padding:1rem}.area-card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:2rem!important}.categoria-card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]{padding:.75rem}}.familia-pills-container[_ngcontent-%COMP%]{position:relative;margin-bottom:1rem;padding:0 .5rem}.familia-pills-scroll[_ngcontent-%COMP%]{display:flex;gap:.75rem;overflow-x:auto;padding:.75rem 0;scroll-behavior:smooth;-webkit-overflow-scrolling:touch;scrollbar-width:none;-ms-overflow-style:none}.familia-pills-scroll[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}.familia-pills-scroll[_ngcontent-%COMP%]:before, .familia-pills-scroll[_ngcontent-%COMP%]:after{content:"";position:absolute;top:0;bottom:0;width:20px;pointer-events:none;z-index:1}.familia-pills-scroll[_ngcontent-%COMP%]:before{left:0;background:linear-gradient(to right,rgb(255,255,255),rgba(255,255,255,0))}.familia-pills-scroll[_ngcontent-%COMP%]:after{right:0;background:linear-gradient(to left,rgb(255,255,255),rgba(255,255,255,0))}.familia-pill[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;padding:.5rem 1rem;background:#f8f9fa;border:1.5px solid #e9ecef;border-radius:25px;cursor:pointer;transition:all .3s ease;white-space:nowrap;flex-shrink:0;min-height:40px;-webkit-user-select:none;user-select:none}.familia-pill[_ngcontent-%COMP%]   .pill-text[_ngcontent-%COMP%]{font-size:.875rem;font-weight:500;color:#495057}.familia-pill[_ngcontent-%COMP%]   .pill-count[_ngcontent-%COMP%]{background:#6c757d;color:#fff;font-size:.75rem;font-weight:600;padding:.2rem .5rem;border-radius:12px;min-width:24px;text-align:center;line-height:1}.familia-pill[_ngcontent-%COMP%]:hover{background:#e9ecef;border-color:#adb5bd;transform:translateY(-1px);box-shadow:0 2px 8px #0000001a}.familia-pill.active[_ngcontent-%COMP%]{background:var(--bs-primary, #0d6efd);border-color:var(--bs-primary, #0d6efd);box-shadow:0 2px 12px #0d6efd4d}.familia-pill.active[_ngcontent-%COMP%]   .pill-text[_ngcontent-%COMP%]{color:#fff;font-weight:600}.familia-pill.active[_ngcontent-%COMP%]   .pill-count[_ngcontent-%COMP%]{background:rgba(255,255,255,.2);color:#fff;font-weight:700}.familia-pill.active[_ngcontent-%COMP%]:hover{transform:translateY(-1px);box-shadow:0 4px 16px #0d6efd66}.familia-pill[_ngcontent-%COMP%]:active{transform:scale(.98)}@media (max-width: 768px){.familia-pills-container[_ngcontent-%COMP%]{margin:0 -1rem 1rem;padding:0 1rem}.familia-pill[_ngcontent-%COMP%]{padding:.4rem .8rem;min-height:36px}.familia-pill[_ngcontent-%COMP%]   .pill-text[_ngcontent-%COMP%]{font-size:.8rem}.familia-pill[_ngcontent-%COMP%]   .pill-count[_ngcontent-%COMP%]{font-size:.7rem;padding:.15rem .4rem;min-width:20px}}@media (max-width: 576px){.familia-pills-scroll[_ngcontent-%COMP%]{gap:.5rem;padding:.5rem 0}.familia-pill[_ngcontent-%COMP%]{padding:.35rem .7rem;min-height:32px}.familia-pill[_ngcontent-%COMP%]   .pill-text[_ngcontent-%COMP%]{font-size:.75rem}.familia-pill[_ngcontent-%COMP%]   .pill-count[_ngcontent-%COMP%]{font-size:.65rem;padding:.1rem .35rem;min-width:18px}}.container-fluid[_ngcontent-%COMP%]{padding-left:1rem;padding-right:1rem}*[_ngcontent-%COMP%]{-webkit-tap-highlight-color:transparent}@media (max-width: 576px){.btn[_ngcontent-%COMP%]{touch-action:manipulation}.row[_ngcontent-%COMP%]:first-child{margin-bottom:1rem}.row[_ngcontent-%COMP%]:first-child   h3[_ngcontent-%COMP%]{font-size:1.5rem;margin-bottom:.25rem}.row[_ngcontent-%COMP%]:first-child   span[_ngcontent-%COMP%]{font-size:.875rem;color:#6c757d}.card-body[_ngcontent-%COMP%]{padding:.75rem}.form-label[_ngcontent-%COMP%]{font-size:.8rem;margin-bottom:.25rem}.form-control[_ngcontent-%COMP%], .form-select[_ngcontent-%COMP%]{font-size:.875rem;padding:.375rem .5rem}}input[type=number][_ngcontent-%COMP%]{-moz-appearance:textfield}input[type=number][_ngcontent-%COMP%]::-webkit-outer-spin-button, input[type=number][_ngcontent-%COMP%]::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}.scroll-indicator[_ngcontent-%COMP%]{position:absolute;right:0;top:50%;transform:translateY(-50%);background:linear-gradient(to left,rgba(255,255,255,.9),rgba(255,255,255,0));padding:.5rem .75rem .5rem 1.5rem;pointer-events:none;z-index:2}.scroll-indicator[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#6c757d;font-size:.875rem;animation:_ngcontent-%COMP%_bounce-horizontal 2s infinite}@keyframes _ngcontent-%COMP%_bounce-horizontal{0%,20%,50%,80%,to{transform:translate(0)}40%{transform:translate(3px)}60%{transform:translate(1px)}}']})}}return i})()}];let de=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275mod=e.$C({type:i})}static{this.\u0275inj=e.G2t({imports:[y.iI.forChild(le),y.iI]})}}return i})(),ge=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275mod=e.$C({type:i})}static{this.\u0275inj=e.G2t({imports:[de,S.PrivateModule,C.MD,u.X1,u.YN]})}}return i})()}}]);