"use strict";(self.webpackChunkrigel=self.webpackChunkrigel||[]).push([[765],{1765:(J,E,p)=>{p.r(E),p.d(E,{AlbaranesPageModule:()=>L});var y=p(7412),s=p(9417),F=p(177),x=p(8498),k=p(467),c=p(2418),A=p(8359),I=p(4572),P=p(8032),g=p.n(P),t=p(7705);function j(a,l){if(1&a){const e=t.RV6();t.j41(0,"div",72)(1,"small",5),t.nrm(2,"i",73),t.EFF(3),t.j41(4,"button",74),t.bIt("click",function(){t.eBV(e);const r=t.XpG();return t.Njj(r.limpiarFiltros())}),t.nrm(5,"i",75),t.EFF(6," Limpiar filtros "),t.k0s()()()}if(2&a){const e=t.XpG();t.R7$(3),t.Lme(" Mostrando ",e.albaranesFiltrados.length," de ",e.albaranes.length," albaranes ")}}function C(a,l){if(1&a&&(t.j41(0,"div",96)(1,"span",97),t.EFF(2),t.k0s(),t.j41(3,"span",98),t.EFF(4),t.k0s()()),2&a){const e=l.$implicit;t.R7$(2),t.JRh(e.productoNombre),t.R7$(2),t.SpI("",e.cantidad," unidades")}}function w(a,l){if(1&a&&(t.j41(0,"div",99),t.EFF(1),t.k0s()),2&a){const e=t.XpG().$implicit;t.R7$(1),t.SpI(" +",e.productos.length-3," productos m\xe1s ")}}function R(a,l){if(1&a&&(t.j41(0,"div",48)(1,"small",100),t.EFF(2,"Observaciones:"),t.k0s(),t.j41(3,"small",101),t.EFF(4),t.k0s()()),2&a){const e=t.XpG().$implicit;t.R7$(4),t.JRh(e.observaciones)}}function T(a,l){if(1&a){const e=t.RV6();t.j41(0,"div",76)(1,"div",10)(2,"div",18)(3,"div",77)(4,"div",78),t.nrm(5,"i",79),t.j41(6,"h5",45),t.EFF(7),t.k0s(),t.j41(8,"span",80),t.EFF(9),t.k0s()(),t.j41(10,"div",81)(11,"button",82),t.bIt("click",function(){const i=t.eBV(e).$implicit,n=t.XpG();return t.Njj(n.verAlbaran(i))}),t.nrm(12,"i",83),t.k0s(),t.j41(13,"button",84),t.bIt("click",function(){const i=t.eBV(e).$implicit,n=t.XpG();return t.Njj(n.editarAlbaran(i))}),t.nrm(14,"i",85),t.k0s(),t.j41(15,"button",86),t.bIt("click",function(){const i=t.eBV(e).$implicit,n=t.XpG();return t.Njj(n.eliminarAlbaran(i))}),t.nrm(16,"i",87),t.k0s()()(),t.j41(17,"div",48)(18,"strong"),t.EFF(19),t.k0s(),t.nrm(20,"br"),t.j41(21,"small",5),t.EFF(22),t.k0s()(),t.j41(23,"div",58)(24,"div",47)(25,"small",5),t.EFF(26,"Fecha Emisi\xf3n"),t.k0s(),t.j41(27,"div",88),t.EFF(28),t.nI1(29,"date"),t.k0s()(),t.j41(30,"div",47)(31,"small",5),t.EFF(32,"Fecha Entrega"),t.k0s(),t.j41(33,"div",88),t.EFF(34),t.nI1(35,"date"),t.k0s()()(),t.j41(36,"div",58)(37,"div",89)(38,"small",5),t.EFF(39,"Subtotal"),t.k0s(),t.j41(40,"div",88),t.EFF(41),t.nI1(42,"currency"),t.k0s()(),t.j41(43,"div",47)(44,"small",90),t.EFF(45,"IVA Total:"),t.k0s(),t.j41(46,"div",88),t.EFF(47),t.nI1(48,"currency"),t.k0s()(),t.j41(49,"div",89)(50,"small",5),t.EFF(51,"Total"),t.k0s(),t.j41(52,"div",91),t.EFF(53),t.nI1(54,"currency"),t.k0s()()(),t.j41(55,"div",48)(56,"small",92),t.EFF(57),t.k0s(),t.j41(58,"div",93),t.DNE(59,C,5,2,"div",94),t.DNE(60,w,2,1,"div",95),t.k0s()(),t.DNE(61,R,5,1,"div",60),t.k0s()()()}if(2&a){const e=l.$implicit,o=t.XpG();t.R7$(7),t.JRh(e.numero),t.R7$(1),t.HbH(o.getEstadoBadgeClass(e.estado)),t.R7$(1),t.SpI(" ",e.estado," "),t.R7$(10),t.JRh(e.proveedorNombre),t.R7$(3),t.SpI("CIF: ",e.proveedorCif,""),t.R7$(6),t.SpI(" ",t.i5U(29,15,e.fechaEmision,"dd/MM/yyyy")," "),t.R7$(6),t.SpI(" ",t.i5U(35,18,e.fechaEntrega,"dd/MM/yyyy")," "),t.R7$(7),t.SpI(" ",t.ii3(42,21,e.subtotal,"EUR","symbol","1.2-2")," "),t.R7$(6),t.SpI(" ",t.ii3(48,26,e.iva,"EUR","symbol","1.2-2")," "),t.R7$(6),t.SpI(" ",t.ii3(54,31,e.total,"EUR","symbol","1.2-2")," "),t.R7$(4),t.SpI("Productos (",e.productos.length,"):"),t.R7$(2),t.Y8G("ngForOf",e.productos.slice(0,3)),t.R7$(1),t.Y8G("ngIf",e.productos.length>3),t.R7$(1),t.Y8G("ngIf",e.observaciones)}}function N(a,l){if(1&a){const e=t.RV6();t.j41(0,"div",2)(1,"div",102),t.nrm(2,"i",103),t.j41(3,"h5",104),t.EFF(4,"No se encontraron albaranes"),t.k0s(),t.j41(5,"p",5),t.EFF(6,"Intenta ajustar los filtros de b\xfasqueda"),t.k0s(),t.j41(7,"button",105),t.bIt("click",function(){t.eBV(e);const r=t.XpG();return t.Njj(r.limpiarFiltros())}),t.nrm(8,"i",106),t.EFF(9," Mostrar todos los albaranes "),t.k0s()()()}}function O(a,l){if(1&a){const e=t.RV6();t.j41(0,"div",2)(1,"div",102),t.nrm(2,"i",107),t.j41(3,"h5",104),t.EFF(4,"No tienes albaranes creados"),t.k0s(),t.j41(5,"p",5),t.EFF(6,"Crea tu primer albar\xe1n para comenzar"),t.k0s(),t.j41(7,"button",6),t.bIt("click",function(){t.eBV(e);const r=t.XpG();return t.Njj(r.abrirModalAlbaran())}),t.nrm(8,"i",108),t.EFF(9," Nuevo Albar\xe1n "),t.k0s()()()}}function D(a,l){if(1&a&&(t.j41(0,"option",109),t.EFF(1),t.k0s()),2&a){const e=l.$implicit;t.Y8G("value",e.id),t.R7$(1),t.SpI(" ",e.nombre," ")}}function M(a,l){if(1&a&&(t.j41(0,"div",1)(1,"div",114)(2,"small",5),t.EFF(3),t.k0s()(),t.j41(4,"div",47)(5,"small",88),t.EFF(6),t.nI1(7,"currency"),t.k0s()()()),2&a){const e=l.$implicit;t.R7$(3),t.SpI("IVA ",e.porcentaje,"%:"),t.R7$(3),t.JRh(t.ii3(7,2,e.importe,"EUR","symbol","1.2-2"))}}function S(a,l){if(1&a&&(t.j41(0,"div",48)(1,"div",110)(2,"h6",111),t.EFF(3,"Desglose de IVA"),t.k0s(),t.DNE(4,M,8,7,"div",112),t.nrm(5,"hr",113),t.j41(6,"div",1)(7,"div",114)(8,"strong"),t.EFF(9,"Total IVA:"),t.k0s()(),t.j41(10,"div",47)(11,"strong"),t.EFF(12),t.nI1(13,"currency"),t.k0s()()()()()),2&a){const e=t.XpG();t.R7$(4),t.Y8G("ngForOf",e.ivaBreakdown),t.R7$(8),t.JRh(t.ii3(13,2,e.ivaAlbaran,"EUR","symbol","1.2-2"))}}function G(a,l){1&a&&(t.j41(0,"div",115),t.nrm(1,"i",116),t.j41(2,"p",117),t.EFF(3," Selecciona un proveedor para agregar productos "),t.k0s()())}function B(a,l){if(1&a&&(t.j41(0,"option",109),t.EFF(1),t.k0s()),2&a){const e=l.$implicit;t.Y8G("value",e.id),t.R7$(1),t.SpI(" ",e.nombre," ")}}function V(a,l){if(1&a){const e=t.RV6();t.j41(0,"tr",123)(1,"td")(2,"select",124),t.bIt("change",function(){const i=t.eBV(e).index,n=t.XpG(2);return t.Njj(n.onProductoChange(i))}),t.j41(3,"option",27),t.EFF(4,"Seleccionar producto"),t.k0s(),t.DNE(5,B,2,2,"option",53),t.k0s()(),t.j41(6,"td")(7,"input",125),t.bIt("input",function(){t.eBV(e);const r=t.XpG(2);return t.Njj(r.calcularTotales())}),t.k0s()(),t.j41(8,"td")(9,"input",126),t.bIt("input",function(){t.eBV(e);const r=t.XpG(2);return t.Njj(r.calcularTotales())}),t.k0s()(),t.j41(10,"td")(11,"span",88),t.EFF(12),t.nI1(13,"currency"),t.k0s()(),t.j41(14,"td")(15,"span",127),t.EFF(16),t.nI1(17,"currency"),t.k0s()(),t.j41(18,"td")(19,"span",128),t.EFF(20),t.nI1(21,"currency"),t.k0s()(),t.j41(22,"td")(23,"button",129),t.bIt("click",function(){const i=t.eBV(e).index,n=t.XpG(2);return t.Njj(n.eliminarProducto(i))}),t.nrm(24,"i",87),t.k0s()()()}if(2&a){const e=l.index,o=t.XpG(2);t.Y8G("formGroupName",e),t.R7$(5),t.Y8G("ngForOf",o.productosProveedor),t.R7$(7),t.JRh(t.ii3(13,5,o.getProductoSubtotal(e),"EUR","symbol","1.2-2")),t.R7$(4),t.JRh(t.ii3(17,10,o.getProductoIvaImporte(e),"EUR","symbol","1.2-2")),t.R7$(4),t.JRh(t.ii3(21,15,o.getProductoTotal(e),"EUR","symbol","1.2-2"))}}function z(a,l){if(1&a&&(t.j41(0,"div",118)(1,"table",119)(2,"thead")(3,"tr")(4,"th"),t.EFF(5,"Producto"),t.k0s(),t.j41(6,"th"),t.EFF(7,"Cantidad"),t.k0s(),t.j41(8,"th"),t.EFF(9,"Precio Unit."),t.k0s(),t.j41(10,"th"),t.EFF(11,"Subtotal"),t.k0s(),t.j41(12,"th"),t.EFF(13,"IVA"),t.k0s(),t.j41(14,"th"),t.EFF(15,"Total"),t.k0s(),t.nrm(16,"th",120),t.k0s()(),t.j41(17,"tbody",121),t.DNE(18,V,25,20,"tr",122),t.k0s()()()),2&a){const e=t.XpG();t.R7$(18),t.Y8G("ngForOf",e.productosFormArray.controls)}}const U=[{path:"",component:(()=>{class a{constructor(e,o){this.fb=e,this.firestore=o,this.albaranes=[],this.albaranesFiltrados=[],this.productos=[],this.productosProveedor=[],this.proveedores=[],this.configuracionEmpresa=null,this.estadisticas={totalAlbaranes:0,recibidos:0,pendientes:0,valorTotal:0},this.filtros={busqueda:"",estado:""},this.modoEdicion=!1,this.albaranEditando=null,this.subtotalAlbaran=0,this.ivaAlbaran=0,this.totalAlbaran=0,this.ivaBreakdown=[],this.subscriptions=new A.yU,this.inicializarForm()}ngOnInit(){this.cargarDatos(),this.cargarConfiguracionEmpresa()}ngOnDestroy(){this.subscriptions.unsubscribe()}inicializarForm(){this.albaranForm=this.fb.group({numero:["",[s.k0.required]],proveedorId:["",[s.k0.required]],estado:["Pendiente",[s.k0.required]],fechaEmision:[this.formatDateForInput(new Date),[s.k0.required]],fechaEntrega:[this.formatDateForInput(new Date),[s.k0.required]],recibidoPor:[""],observaciones:[""],productos:this.fb.array([])})}get productosFormArray(){return this.albaranForm.get("productos")}formatDateForInput(e){return e.toISOString().split("T")[0]}cargarDatos(){const e=(0,c.rJ)(this.firestore,"albaranes"),o=(0,c.rJ)(this.firestore,"productos"),r=(0,c.rJ)(this.firestore,"proveedores");this.subscriptions.add((0,I.z)([(0,c.xs)(e,{idField:"id"}),(0,c.xs)(o,{idField:"id"}),(0,c.xs)(r,{idField:"id"})]).subscribe(([i,n,u])=>{this.albaranes=i.map(d=>({...d,fechaEmision:d.fechaEmision?.toDate?d.fechaEmision.toDate():new Date(d.fechaEmision),fechaEntrega:d.fechaEntrega?.toDate?d.fechaEntrega.toDate():new Date(d.fechaEntrega)})),this.productos=n.filter(d=>!d.esCombinado),this.proveedores=u,this.actualizarNombresProveedores(),this.actualizarNombresProductos(),this.calcularEstadisticas(),this.aplicarFiltros()}))}cargarConfiguracionEmpresa(){const e=(0,c.rJ)(this.firestore,"configuracion"),o=(0,c.P)(e,(0,c.AB)(1));this.subscriptions.add((0,c.xs)(o,{idField:"id"}).subscribe(r=>{r.length>0&&(this.configuracionEmpresa=r[0])}))}actualizarNombresProveedores(){this.albaranes.forEach(e=>{const o=this.proveedores.find(r=>r.id===e.proveedorId);o&&(e.proveedorNombre=o.nombre,e.proveedorCif=o.cif)})}actualizarNombresProductos(){this.albaranes.forEach(e=>{e.productos&&e.productos.forEach(o=>{const r=this.productos.find(i=>i.id===o.productoId);r&&(o.productoNombre=r.nombre,o.IVA=r.IVA)})})}calcularEstadisticas(){this.estadisticas={totalAlbaranes:this.albaranes.length,recibidos:this.albaranes.filter(e=>"Recibido"===e.estado).length,pendientes:this.albaranes.filter(e=>"Pendiente"===e.estado).length,valorTotal:this.albaranes.reduce((e,o)=>e+(o.total||0),0)}}aplicarFiltros(){let e=[...this.albaranes];if(this.filtros.busqueda.trim()){const o=this.filtros.busqueda.toLowerCase().trim();e=e.filter(r=>r.numero.toLowerCase().includes(o)||(r.proveedorNombre||"").toLowerCase().includes(o)||(r.proveedorCif||"").toLowerCase().includes(o))}this.filtros.estado&&(e=e.filter(o=>o.estado===this.filtros.estado)),this.albaranesFiltrados=e}limpiarFiltros(){this.filtros={busqueda:"",estado:""},this.aplicarFiltros()}getEstadoBadgeClass(e){switch(e){case"Recibido":return"bg-success";case"Parcial":return"bg-warning text-dark";default:return"bg-secondary"}}getIvaBreakdown(e){const o=new Map;return e.productos&&e.productos.forEach(r=>{const n=this.productos.find(b=>b.id===r.productoId)?.IVA||r.IVA||0,d=r.cantidad*r.precioUnitario*(n/100),f=o.get(n)||0;o.set(n,f+d)}),Array.from(o.entries()).map(([r,i])=>({porcentaje:r,importe:i})).sort((r,i)=>r.porcentaje-i.porcentaje)}abrirModalAlbaran(){this.modoEdicion=!1,this.albaranEditando=null,this.albaranForm.reset(),this.productosFormArray.clear(),this.productosProveedor=[],this.subtotalAlbaran=0,this.ivaAlbaran=0,this.totalAlbaran=0,this.ivaBreakdown=[];const e=this.generarNumeroAlbaran();this.albaranForm.patchValue({numero:e,estado:"Pendiente",fechaEmision:this.formatDateForInput(new Date),fechaEntrega:this.formatDateForInput(new Date)}),$("#modalAlbaran").modal("show")}generarNumeroAlbaran(){return`ALB-${(new Date).getFullYear()}-${(this.albaranes.length+1).toString().padStart(3,"0")}`}editarAlbaran(e){this.modoEdicion=!0,this.albaranEditando=e,this.albaranForm.patchValue({numero:e.numero,proveedorId:e.proveedorId,estado:e.estado,fechaEmision:this.formatDateForInput(e.fechaEmision),fechaEntrega:this.formatDateForInput(e.fechaEntrega),recibidoPor:e.recibidoPor||"",observaciones:e.observaciones||""}),this.onProveedorChange(),this.productosFormArray.clear(),e.productos&&e.productos.forEach(o=>{this.productosFormArray.push(this.fb.group({productoId:[o.productoId,s.k0.required],cantidad:[o.cantidad,[s.k0.required,s.k0.min(1)]],precioUnitario:[o.precioUnitario,[s.k0.required,s.k0.min(0)]]}))}),this.calcularTotales(),$("#modalAlbaran").modal("show")}verAlbaran(e){g().fire({title:"Opciones del Albar\xe1n",html:`\n        <div class="text-start">\n          <p class="mb-3">\xbfQu\xe9 deseas hacer con el albar\xe1n <strong>"${e.numero}"</strong>?</p>\n        </div>\n      `,showCancelButton:!0,showDenyButton:!0,confirmButtonText:'<i class="bi bi-printer me-1"></i> Imprimir',denyButtonText:'<i class="bi bi-eye me-1"></i> Ver Detalles',cancelButtonText:"Cancelar",confirmButtonColor:"#0d6efd",denyButtonColor:"#6c757d"}).then(o=>{o.isConfirmed?this.imprimirAlbaran(e):o.isDenied&&this.mostrarDetallesAlbaran(e)})}mostrarDetallesAlbaran(e){const o=e.productos?.map(r=>`<li>${r.productoNombre}: ${r.cantidad} unidades - ${r.precioUnitario.toFixed(2)}\u20ac/u</li>`).join("")||"";g().fire({title:e.numero,html:`\n        <div class="text-start">\n          <p><strong>Proveedor:</strong> ${e.proveedorNombre}</p>\n          <p><strong>CIF:</strong> ${e.proveedorCif}</p>\n          <p><strong>Estado:</strong> <span class="badge ${this.getEstadoBadgeClass(e.estado)}">${e.estado}</span></p>\n          <p><strong>Fecha Emisi\xf3n:</strong> ${e.fechaEmision.toLocaleDateString()}</p>\n          <p><strong>Fecha Entrega:</strong> ${e.fechaEntrega.toLocaleDateString()}</p>\n          <p><strong>Total:</strong> ${e.total.toFixed(2)}\u20ac</p>\n          ${e.recibidoPor?`<p><strong>Recibido por:</strong> ${e.recibidoPor}</p>`:""}\n          ${e.observaciones?`<p><strong>Observaciones:</strong> ${e.observaciones}</p>`:""}\n          <p><strong>Productos:</strong></p>\n          <ul>${o}</ul>\n        </div>\n      `,width:600,confirmButtonText:"Cerrar"})}imprimirAlbaran(e){const o=this.proveedores.find(m=>m.id===e.proveedorId),r=(new Date).toLocaleDateString("es-ES"),i=e.productos?.map((m,X)=>`\n      <tr>\n        <td style="padding: 8px; border-bottom: 1px solid #ddd; text-align: center;">${X+1}</td>\n        <td style="padding: 8px; border-bottom: 1px solid #ddd;">${m.productoNombre}</td>\n        <td style="padding: 8px; border-bottom: 1px solid #ddd; text-align: center;">${m.cantidad.toFixed(2)}</td>\n        <td style="padding: 8px; border-bottom: 1px solid #ddd; text-align: right;">${m.precioUnitario.toFixed(2)}\u20ac</td>\n        <td style="padding: 8px; border-bottom: 1px solid #ddd; text-align: right;">${(m.cantidad*m.precioUnitario).toFixed(2)}\u20ac</td>\n      </tr>\n    `).join("")||"",n=this.configuracionEmpresa?.nombreRestaurante||"Tu Empresa S.L.",u=this.configuracionEmpresa?.direccion||"Direcci\xf3n de tu empresa",d=`${this.configuracionEmpresa?.ciudad||"Ciudad"}, ${this.configuracionEmpresa?.codigoPostal||"CP"} - ${this.configuracionEmpresa?.provincia||"Provincia"}`,f=this.configuracionEmpresa?.cif||"B12345678",b=this.configuracionEmpresa?.telefono||"123 456 789",_=`\n      <!DOCTYPE html>\n      <html>\n      <head>\n        <meta charset="utf-8">\n        <title>Albar\xe1n ${e.numero}</title>\n        <style>\n          @media print {\n            body { margin: 0; }\n            .no-print { display: none; }\n          }\n          body {\n            font-family: Arial, sans-serif;\n            font-size: 12px;\n            line-height: 1.4;\n            color: #333;\n            max-width: 210mm;\n            margin: 0 auto;\n            padding: 20px;\n          }\n          .header {\n            display: flex;\n            justify-content: space-between;\n            align-items: flex-start;\n            margin-bottom: 30px;\n            border-bottom: 2px solid #333;\n            padding-bottom: 20px;\n          }\n          .company-info {\n            flex: 1;\n          }\n          .company-name {\n            font-size: 18px;\n            font-weight: bold;\n            color: #2c5aa0;\n            margin-bottom: 5px;\n          }\n          .company-details {\n            font-size: 11px;\n            color: #666;\n            line-height: 1.3;\n          }\n          .document-info {\n            text-align: right;\n            flex: 1;\n          }\n          .document-title {\n            font-size: 24px;\n            font-weight: bold;\n            color: #333;\n            margin-bottom: 10px;\n          }\n          .document-number {\n            font-size: 14px;\n            font-weight: bold;\n            background: #f0f0f0;\n            padding: 5px 10px;\n            border: 1px solid #ddd;\n          }\n          .parties {\n            display: flex;\n            justify-content: space-between;\n            margin-bottom: 30px;\n          }\n          .party {\n            flex: 1;\n            margin-right: 20px;\n          }\n          .party:last-child {\n            margin-right: 0;\n          }\n          .party-title {\n            font-weight: bold;\n            font-size: 13px;\n            margin-bottom: 8px;\n            color: #2c5aa0;\n            border-bottom: 1px solid #ddd;\n            padding-bottom: 3px;\n          }\n          .party-details {\n            font-size: 11px;\n            line-height: 1.4;\n          }\n          .dates-info {\n            display: flex;\n            justify-content: space-between;\n            margin-bottom: 20px;\n            background: #f8f9fa;\n            padding: 15px;\n            border: 1px solid #ddd;\n          }\n          .date-item {\n            text-align: center;\n          }\n          .date-label {\n            font-size: 10px;\n            color: #666;\n            margin-bottom: 3px;\n          }\n          .date-value {\n            font-weight: bold;\n            font-size: 12px;\n          }\n          .products-table {\n            width: 100%;\n            border-collapse: collapse;\n            margin-bottom: 20px;\n          }\n          .products-table th {\n            background: #2c5aa0;\n            color: white;\n            padding: 10px 8px;\n            text-align: left;\n            font-size: 11px;\n            font-weight: bold;\n          }\n          .products-table th:nth-child(1) { text-align: center; width: 5%; }\n          .products-table th:nth-child(2) { width: 50%; }\n          .products-table th:nth-child(3) { text-align: center; width: 15%; }\n          .products-table th:nth-child(4) { text-align: right; width: 15%; }\n          .products-table th:nth-child(5) { text-align: right; width: 15%; }\n          .products-table td {\n            padding: 8px;\n            border-bottom: 1px solid #ddd;\n            font-size: 11px;\n          }\n          .totals {\n            float: right;\n            width: 300px;\n            margin-bottom: 30px;\n          }\n          .totals table {\n            width: 100%;\n            border-collapse: collapse;\n          }\n          .totals td {\n            padding: 8px 12px;\n            border: 1px solid #ddd;\n            font-size: 12px;\n          }\n          .totals .label {\n            background: #f8f9fa;\n            font-weight: bold;\n            text-align: right;\n            width: 60%;\n          }\n          .totals .value {\n            text-align: right;\n            width: 40%;\n          }\n          .totals .total-row {\n            background: #2c5aa0;\n            color: white;\n            font-weight: bold;\n            font-size: 14px;\n          }\n          .signature-section {\n            clear: both;\n            margin-top: 50px;\n            border-top: 1px solid #ddd;\n            padding-top: 30px;\n          }\n          .signature-boxes {\n            display: flex;\n            justify-content: space-between;\n            margin-top: 30px;\n          }\n          .signature-box {\n            width: 45%;\n            text-align: center;\n          }\n          .signature-line {\n            border-bottom: 1px solid #333;\n            height: 60px;\n            margin-bottom: 10px;\n          }\n          .signature-label {\n            font-size: 11px;\n            font-weight: bold;\n          }\n          .observations {\n            margin: 20px 0;\n            padding: 15px;\n            background: #f8f9fa;\n            border-left: 4px solid #2c5aa0;\n          }\n          .observations-title {\n            font-weight: bold;\n            margin-bottom: 8px;\n            color: #2c5aa0;\n          }\n          .print-button {\n            position: fixed;\n            top: 20px;\n            right: 20px;\n            background: #2c5aa0;\n            color: white;\n            border: none;\n            padding: 10px 20px;\n            border-radius: 5px;\n            cursor: pointer;\n            font-size: 14px;\n          }\n          .print-button:hover {\n            background: #1e3d6f;\n          }\n        </style>\n      </head>\n      <body>\n        <button class="print-button no-print" onclick="window.print()">\n          \u{1f5a8}\ufe0f Imprimir\n        </button>\n\n        <div class="header">\n          <div class="company-info">\n            <div class="company-name">${n}</div>\n            <div class="company-details">\n              ${u}<br>\n              ${d}<br>\n              CIF: ${f}<br>\n              Tel: ${b}<br>\n              Email: ${this.configuracionEmpresa?.email||"info@tuempresa.com"}\n            </div>\n          </div>\n          <div class="document-info">\n            <div class="document-title">ALBAR\xc1N</div>\n            <div class="document-number">${e.numero}</div>\n          </div>\n        </div>\n\n        <div class="parties">\n          <div class="party">\n            <div class="party-title">PROVEEDOR</div>\n            <div class="party-details">\n              <strong>${o?.nombre||e.proveedorNombre}</strong><br>\n              ${o?.razonSocial?`${o.razonSocial}<br>`:""}\n              ${o?.direccion?.calle||"Direcci\xf3n no disponible"}<br>\n              ${o?.direccion?.codigoPostal||""} ${o?.direccion?.ciudad||""}<br>\n              ${o?.direccion?.provincia?`${o.direccion.provincia}<br>`:""}\n              CIF: ${o?.cif||e.proveedorCif}<br>\n              ${o?.contacto?.telefono?`Tel: ${o.contacto.telefono}<br>`:""}\n              ${o?.contacto?.email?`Email: ${o.contacto.email}<br>`:""}\n              ${o?.contacto?.nombre?`Contacto: ${o.contacto.nombre}`:""}\n            </div>\n          </div>\n          <div class="party">\n            <div class="party-title">DESTINATARIO</div>\n            <div class="party-details">\n              <strong>${n}</strong><br>\n              ${u}<br>\n              ${d}<br>\n              CIF: ${f}<br>\n              Tel: ${b}\n            </div>\n          </div>\n        </div>\n\n        <div class="dates-info">\n          <div class="date-item">\n            <div class="date-label">FECHA EMISI\xd3N</div>\n            <div class="date-value">${e.fechaEmision.toLocaleDateString("es-ES")}</div>\n          </div>\n          <div class="date-item">\n            <div class="date-label">FECHA ENTREGA</div>\n            <div class="date-value">${e.fechaEntrega.toLocaleDateString("es-ES")}</div>\n          </div>\n          <div class="date-item">\n            <div class="date-label">ESTADO</div>\n            <div class="date-value">${e.estado}</div>\n          </div>\n          <div class="date-item">\n            <div class="date-label">FECHA IMPRESI\xd3N</div>\n            <div class="date-value">${r}</div>\n          </div>\n        </div>\n\n        <table class="products-table">\n          <thead>\n            <tr>\n              <th>#</th>\n              <th>DESCRIPCI\xd3N</th>\n              <th>CANTIDAD</th>\n              <th>PRECIO UNIT.</th>\n              <th>TOTAL</th>\n            </tr>\n          </thead>\n          <tbody>\n            ${i}\n          </tbody>\n        </table>\n\n        <div class="totals">\n          <table>\n            <tr>\n              <td class="label">Subtotal:</td>\n              <td class="value">${e.subtotal.toFixed(2)}\u20ac</td>\n            </tr>\n            ${this.getIvaBreakdown(e).map(m=>`\n            <tr>\n              <td class="label">IVA ${m.porcentaje}%:</td>\n              <td class="value">${m.importe.toFixed(2)}\u20ac</td>\n            </tr>\n            `).join("")}\n            <tr class="total-row">\n              <td class="value">TOTAL:</td>\n              <td class="value">${e.total.toFixed(2)}\u20ac</td>\n            </tr>\n          </table>\n        </div>\n\n        ${e.observaciones?`\n        <div class="observations">\n          <div class="observations-title">OBSERVACIONES</div>\n          <div>${e.observaciones}</div>\n        </div>\n        `:""}\n\n        <div class="signature-section">\n          <div style="margin-bottom: 20px;">\n            <strong>Condiciones de entrega:</strong> Los productos han sido entregados en perfecto estado y seg\xfan las especificaciones acordadas.\n          </div>\n\n          <div class="signature-boxes">\n            <div class="signature-box">\n              <div class="signature-line"></div>\n              <div class="signature-label">FIRMA DEL PROVEEDOR</div>\n              <div style="font-size: 10px; margin-top: 5px;">\n                ${o?.nombre||e.proveedorNombre}<br>\n                Fecha: _______________\n              </div>\n            </div>\n            <div class="signature-box">\n              <div class="signature-line"></div>\n              <div class="signature-label">FIRMA DEL RECEPTOR</div>\n              <div style="font-size: 10px; margin-top: 5px;">\n                ${e.recibidoPor||"Nombre: _______________"}<br>\n                Fecha: _______________\n              </div>\n            </div>\n          </div>\n        </div>\n\n        <div style="margin-top: 30px; font-size: 10px; color: #666; text-align: center; border-top: 1px solid #ddd; padding-top: 15px;">\n          Este documento certifica la recepci\xf3n de los productos detallados en las condiciones especificadas.\n        </div>\n      </body>\n      </html>\n    `,h=window.open("","_blank");h&&(h.document.write(_),h.document.close(),h.focus())}eliminarAlbaran(e){var o=this;return(0,k.A)(function*(){if((yield g().fire({title:"\xbfEliminar albar\xe1n?",html:`\n        <div class="text-start">\n          <p>\xbfEst\xe1s seguro de que quieres eliminar el albar\xe1n <strong>"${e.numero}"</strong>?</p>\n          <div class="alert alert-warning">\n            <i class="bi bi-exclamation-triangle me-2"></i>\n            Esta acci\xf3n no se puede deshacer.\n          </div>\n        </div>\n      `,icon:"warning",showCancelButton:!0,confirmButtonColor:"#dc3545",cancelButtonColor:"#6c757d",confirmButtonText:"S\xed, eliminar",cancelButtonText:"Cancelar"})).isConfirmed&&e.id)try{const i=(0,c.H9)(o.firestore,"albaranes",e.id);yield(0,c.kd)(i),g().fire({title:"\xa1Eliminado!",text:"El albar\xe1n ha sido eliminado correctamente.",icon:"success",timer:2e3,showConfirmButton:!1})}catch(i){console.error("Error al eliminar albar\xe1n:",i),g().fire("Error","No se pudo eliminar el albar\xe1n","error")}})()}onProveedorChange(){const e=this.albaranForm.get("proveedorId")?.value;this.productosProveedor=e?this.productos.filter(o=>o.proveedorId===e):[],this.modoEdicion||this.productosFormArray.clear()}agregarProducto(){const e=this.fb.group({productoId:["",s.k0.required],cantidad:[1,[s.k0.required,s.k0.min(1)]],precioUnitario:[0,[s.k0.required,s.k0.min(0)]]});this.productosFormArray.push(e)}eliminarProducto(e){this.productosFormArray.removeAt(e),this.calcularTotales()}onProductoChange(e){const o=this.productosFormArray.at(e).get("productoId")?.value,r=this.productos.find(i=>i.id===o);r&&(this.productosFormArray.at(e).patchValue({precioUnitario:r.costo}),this.calcularTotales())}getProductoSubtotal(e){const o=this.productosFormArray.at(e);return(o.get("cantidad")?.value||0)*(o.get("precioUnitario")?.value||0)}getProductoIvaImporte(e){const o=this.productosFormArray.at(e),r=o.get("productoId")?.value;return(o.get("cantidad")?.value||0)*(o.get("precioUnitario")?.value||0)*((this.productos.find(b=>b.id===r)?.IVA||0)/100)}getProductoTotal(e){return this.getProductoSubtotal(e)+this.getProductoIvaImporte(e)}getProductoIva(e){const o=this.productosFormArray.at(e).get("productoId")?.value;return this.productos.find(i=>i.id===o)?.IVA||0}calcularTotales(){this.subtotalAlbaran=0;let e=0;const o=new Map;for(let r=0;r<this.productosFormArray.length;r++){const i=this.productosFormArray.at(r),n=i.get("productoId")?.value,u=i.get("cantidad")?.value||0,d=i.get("precioUnitario")?.value||0,b=this.productos.find(m=>m.id===n)?.IVA||0,v=u*d,_=v*(b/100);this.subtotalAlbaran+=v,e+=_;const h=o.get(b)||0;o.set(b,h+_)}this.ivaAlbaran=e,this.totalAlbaran=this.subtotalAlbaran+this.ivaAlbaran,this.ivaBreakdown=Array.from(o.entries()).map(([r,i])=>({porcentaje:r,importe:i})).sort((r,i)=>r.porcentaje-i.porcentaje)}guardarAlbaran(){var e=this;return(0,k.A)(function*(){if(!e.albaranForm.valid)return void g().fire("Error","Por favor completa todos los campos requeridos","error");if(0===e.productosFormArray.length)return void g().fire("Error","Debes agregar al menos un producto","error");const o=e.albaranForm.value,r=o.productos.map(n=>{const d=e.productos.find(v=>v.id===n.productoId)?.IVA||0,f=n.cantidad*n.precioUnitario;return{productoId:n.productoId,cantidad:n.cantidad,precioUnitario:n.precioUnitario,total:f+f*(d/100),IVA:d}}),i={numero:o.numero,proveedorId:o.proveedorId,estado:o.estado,fechaEmision:new Date(o.fechaEmision),fechaEntrega:new Date(o.fechaEntrega),recibidoPor:o.recibidoPor,observaciones:o.observaciones,productos:r,subtotal:e.subtotalAlbaran,iva:e.ivaAlbaran,total:e.totalAlbaran,fechaActualizacion:new Date};try{if(e.modoEdicion&&e.albaranEditando?.id){const n=(0,c.H9)(e.firestore,"albaranes",e.albaranEditando.id);yield(0,c.mZ)(n,e.cleanObjectForFirebase(i)),g().fire("\xa1\xc9xito!","Albar\xe1n actualizado correctamente","success")}else{i.fechaCreacion=new Date;const n=(0,c.rJ)(e.firestore,"albaranes");yield(0,c.gS)(n,e.cleanObjectForFirebase(i)),g().fire("\xa1\xc9xito!","Albar\xe1n creado correctamente","success")}e.cerrarModal()}catch(n){console.error("Error al guardar albar\xe1n:",n),g().fire("Error","No se pudo guardar el albar\xe1n","error")}})()}cerrarModal(){$("#modalAlbaran").modal("hide"),this.albaranForm.reset(),this.productosFormArray.clear(),this.modoEdicion=!1,this.albaranEditando=null,this.productosProveedor=[],this.ivaBreakdown=[]}cleanObjectForFirebase(e){const o={};for(const r in e)null!=e[r]&&(o[r]=e[r]instanceof Date||"object"!=typeof e[r]||Array.isArray(e[r])?e[r]:this.cleanObjectForFirebase(e[r]));return o}static{this.\u0275fac=function(o){return new(o||a)(t.rXU(s.ok),t.rXU(c._7))}}static{this.\u0275cmp=t.VBU({type:a,selectors:[["app-albaranes-page"]],decls:164,vars:36,consts:[[1,"container-fluid"],[1,"row"],[1,"col-12"],[1,"d-flex","justify-content-between","align-items-center"],[1,"mb-1"],[1,"text-muted"],[1,"btn","btn-danger",3,"click"],[1,"bi","bi-plus"],[1,"row","mt-4"],[1,"col-12","col-md-6","col-xl-3","mb-4"],[1,"card","border-0","shadow-sm","h-100"],[1,"card-body","text-center"],[1,"text-primary","fw-bold","mb-1"],[1,"text-muted","mb-0"],[1,"text-success","fw-bold","mb-1"],[1,"text-warning","fw-bold","mb-1"],[1,"text-info","fw-bold","mb-1"],[1,"card","border-0","shadow-sm","mb-4"],[1,"card-body"],[1,"row","g-3"],[1,"col-12","col-md-8"],[1,"input-group"],[1,"input-group-text"],[1,"bi","bi-search"],["type","text","placeholder","Buscar albaranes...",1,"form-control",3,"ngModel","ngModelChange","input"],[1,"col-12","col-md-4"],[1,"form-select",3,"ngModel","ngModelChange","change"],["value",""],["value","Pendiente"],["value","Parcial"],["value","Recibido"],["class","mt-3",4,"ngIf"],["class","col-12 col-lg-6 mb-4",4,"ngFor","ngForOf"],["class","col-12",4,"ngIf"],["id","modalAlbaran","tabindex","-1","data-bs-backdrop","static",1,"modal","fade"],[1,"modal-dialog","modal-xl"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["type","button",1,"btn-close",3,"click"],[1,"modal-body"],[3,"formGroup","ngSubmit"],[1,"col-12","col-lg-6"],[1,"card","border-0","bg-light","mb-4"],[1,"card-header","bg-transparent","border-0"],[1,"mb-0"],[1,"bi","bi-info-circle","me-2"],[1,"col-6"],[1,"mb-3"],[1,"form-label"],["type","text","formControlName","numero","placeholder","ALB-2025-001",1,"form-control"],["formControlName","estado",1,"form-select"],["formControlName","proveedorId",1,"form-select",3,"change"],[3,"value",4,"ngFor","ngForOf"],["type","date","formControlName","fechaEmision",1,"form-control"],["type","date","formControlName","fechaEntrega",1,"form-control"],["type","text","formControlName","recibidoPor","placeholder","Nombre del receptor",1,"form-control"],[1,"bi","bi-calculator","me-2"],[1,"row","mb-3"],[1,"text-center","p-3","bg-warning","bg-opacity-10","rounded","mb-3"],["class","mb-3",4,"ngIf"],[1,"text-center","p-3","bg-danger","bg-opacity-10","rounded","mb-3"],[1,"mb-1","text-danger"],["rows","3","formControlName","observaciones","placeholder","Observaciones del albar\xe1n...",1,"form-control"],[1,"card","border-0","bg-light"],[1,"card-header","bg-transparent","border-0","d-flex","justify-content-between","align-items-center"],["type","button",1,"btn","btn-sm","btn-info",3,"disabled","click"],["class","text-center py-4 text-muted",4,"ngIf"],["class","table-responsive",4,"ngIf"],[1,"modal-footer"],["type","button",1,"btn","btn-secondary",3,"click"],["type","button",1,"btn","btn-danger",3,"disabled","click"],[1,"mt-3"],[1,"bi","bi-funnel","me-1"],[1,"btn","btn-sm","btn-link","p-0","ms-2",3,"click"],[1,"bi","bi-x-circle"],[1,"col-12","col-lg-6","mb-4"],[1,"d-flex","justify-content-between","align-items-start","mb-3"],[1,"d-flex","align-items-center"],[1,"bi","bi-file-earmark-text","text-muted","me-2"],[1,"badge","ms-2"],[1,"d-flex","gap-2"],["title","Ver albar\xe1n",1,"btn","btn-sm","btn-outline-primary",3,"click"],[1,"bi","bi-eye"],["title","Editar albar\xe1n",1,"btn","btn-sm","btn-outline-secondary",3,"click"],[1,"bi","bi-pencil"],["title","Eliminar albar\xe1n",1,"btn","btn-sm","btn-outline-danger",3,"click"],[1,"bi","bi-trash"],[1,"fw-bold"],[1,"col-3"],[1,"text-muted","d-block","mb-1"],[1,"fw-bold","text-danger"],[1,"text-muted","d-block","mb-2"],[1,"product-list"],["class","d-flex justify-content-between align-items-center mb-1",4,"ngFor","ngForOf"],["class","text-muted small",4,"ngIf"],[1,"d-flex","justify-content-between","align-items-center","mb-1"],[1,"small"],[1,"small","text-muted"],[1,"text-muted","small"],[1,"text-muted","d-block"],[1,"text-info"],[1,"text-center","py-5"],[1,"bi","bi-search","fs-1","text-muted"],[1,"mt-3","text-muted"],[1,"btn","btn-outline-primary",3,"click"],[1,"bi","bi-arrow-clockwise","me-1"],[1,"bi","bi-file-earmark-text","fs-1","text-muted"],[1,"bi","bi-plus","me-1"],[3,"value"],[1,"p-3","bg-info","bg-opacity-10","rounded"],[1,"text-center","mb-2"],["class","row",4,"ngFor","ngForOf"],[1,"my-2"],[1,"col-6","text-end"],[1,"text-center","py-4","text-muted"],[1,"bi","bi-info-circle","fs-3"],[1,"mt-2"],[1,"table-responsive"],[1,"table","table-borderless"],["width","50"],["formArrayName","productos"],[3,"formGroupName",4,"ngFor","ngForOf"],[3,"formGroupName"],["formControlName","productoId",1,"form-select",3,"change"],["type","number","formControlName","cantidad","min","0","step","1",1,"form-control",3,"input"],["type","number","formControlName","precioUnitario","min","0","step","0.01",1,"form-control",3,"input"],[1,"fw-bold","text-info"],[1,"fw-bold","text-success"],["type","button",1,"btn","btn-sm","btn-outline-danger",3,"click"]],template:function(o,r){if(1&o&&(t.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div")(5,"h3",4),t.EFF(6,"Gesti\xf3n de Albaranes"),t.k0s(),t.j41(7,"span",5),t.EFF(8,"Administra los albaranes de entrega de proveedores"),t.k0s()(),t.j41(9,"button",6),t.bIt("click",function(){return r.abrirModalAlbaran()}),t.nrm(10,"i",7),t.EFF(11," Nuevo Albar\xe1n "),t.k0s()()()(),t.j41(12,"div",8)(13,"div",9)(14,"div",10)(15,"div",11)(16,"h2",12),t.EFF(17),t.k0s(),t.j41(18,"p",13),t.EFF(19,"Total Albaranes"),t.k0s()()()(),t.j41(20,"div",9)(21,"div",10)(22,"div",11)(23,"h2",14),t.EFF(24),t.k0s(),t.j41(25,"p",13),t.EFF(26,"Recibidos"),t.k0s()()()(),t.j41(27,"div",9)(28,"div",10)(29,"div",11)(30,"h2",15),t.EFF(31),t.k0s(),t.j41(32,"p",13),t.EFF(33,"Pendientes"),t.k0s()()()(),t.j41(34,"div",9)(35,"div",10)(36,"div",11)(37,"h2",16),t.EFF(38),t.nI1(39,"currency"),t.k0s(),t.j41(40,"p",13),t.EFF(41,"Valor Total"),t.k0s()()()()(),t.j41(42,"div",8)(43,"div",2)(44,"div",17)(45,"div",18)(46,"div",19)(47,"div",20)(48,"div",21)(49,"span",22),t.nrm(50,"i",23),t.k0s(),t.j41(51,"input",24),t.bIt("ngModelChange",function(n){return r.filtros.busqueda=n})("input",function(){return r.aplicarFiltros()}),t.k0s()()(),t.j41(52,"div",25)(53,"select",26),t.bIt("ngModelChange",function(n){return r.filtros.estado=n})("change",function(){return r.aplicarFiltros()}),t.j41(54,"option",27),t.EFF(55,"Todos los estados"),t.k0s(),t.j41(56,"option",28),t.EFF(57,"Pendiente"),t.k0s(),t.j41(58,"option",29),t.EFF(59,"Parcial"),t.k0s(),t.j41(60,"option",30),t.EFF(61,"Recibido"),t.k0s()()()(),t.DNE(62,j,7,2,"div",31),t.k0s()()()(),t.j41(63,"div",1),t.DNE(64,T,62,36,"div",32),t.DNE(65,N,10,0,"div",33),t.DNE(66,O,10,0,"div",33),t.k0s()(),t.j41(67,"div",34)(68,"div",35)(69,"div",36)(70,"div",37)(71,"h5",38),t.EFF(72),t.k0s(),t.j41(73,"button",39),t.bIt("click",function(){return r.cerrarModal()}),t.k0s()(),t.j41(74,"div",40)(75,"form",41),t.bIt("ngSubmit",function(){return r.guardarAlbaran()}),t.j41(76,"div",1)(77,"div",42)(78,"div",43)(79,"div",44)(80,"h6",45),t.nrm(81,"i",46),t.EFF(82," Informaci\xf3n del Albar\xe1n "),t.k0s()(),t.j41(83,"div",18)(84,"div",1)(85,"div",47)(86,"div",48)(87,"label",49),t.EFF(88,"N\xfamero de Albar\xe1n *"),t.k0s(),t.nrm(89,"input",50),t.k0s()(),t.j41(90,"div",47)(91,"div",48)(92,"label",49),t.EFF(93,"Estado"),t.k0s(),t.j41(94,"select",51)(95,"option",28),t.EFF(96,"Pendiente"),t.k0s(),t.j41(97,"option",29),t.EFF(98,"Parcial"),t.k0s(),t.j41(99,"option",30),t.EFF(100,"Recibido"),t.k0s()()()()(),t.j41(101,"div",48)(102,"label",49),t.EFF(103,"Proveedor *"),t.k0s(),t.j41(104,"select",52),t.bIt("change",function(){return r.onProveedorChange()}),t.j41(105,"option",27),t.EFF(106,"Seleccionar proveedor"),t.k0s(),t.DNE(107,D,2,2,"option",53),t.k0s()(),t.j41(108,"div",1)(109,"div",47)(110,"div",48)(111,"label",49),t.EFF(112,"Fecha de Emisi\xf3n *"),t.k0s(),t.nrm(113,"input",54),t.k0s()(),t.j41(114,"div",47)(115,"div",48)(116,"label",49),t.EFF(117,"Fecha de Entrega *"),t.k0s(),t.nrm(118,"input",55),t.k0s()()(),t.j41(119,"div",48)(120,"label",49),t.EFF(121,"Recibido por"),t.k0s(),t.nrm(122,"input",56),t.k0s()()()(),t.j41(123,"div",42)(124,"div",43)(125,"div",44)(126,"h6",45),t.nrm(127,"i",57),t.EFF(128," Resumen del Albar\xe1n "),t.k0s()(),t.j41(129,"div",18)(130,"div",58)(131,"div",2)(132,"div",59)(133,"h4",4),t.EFF(134),t.nI1(135,"currency"),t.k0s(),t.j41(136,"small",5),t.EFF(137,"Subtotal"),t.k0s()()()(),t.DNE(138,S,14,7,"div",60),t.j41(139,"div",61)(140,"h3",62),t.EFF(141),t.nI1(142,"currency"),t.k0s(),t.j41(143,"small",5),t.EFF(144,"Total"),t.k0s()(),t.j41(145,"div",48)(146,"label",49),t.EFF(147,"Observaciones"),t.k0s(),t.nrm(148,"textarea",63),t.k0s()()()()(),t.j41(149,"div",64)(150,"div",65)(151,"h6",45),t.EFF(152,"Productos del Albar\xe1n"),t.k0s(),t.j41(153,"button",66),t.bIt("click",function(){return r.agregarProducto()}),t.nrm(154,"i",7),t.EFF(155," Agregar Producto "),t.k0s()(),t.j41(156,"div",18),t.DNE(157,G,4,0,"div",67),t.DNE(158,z,19,1,"div",68),t.k0s()()()(),t.j41(159,"div",69)(160,"button",70),t.bIt("click",function(){return r.cerrarModal()}),t.EFF(161," Cancelar "),t.k0s(),t.j41(162,"button",71),t.bIt("click",function(){return r.guardarAlbaran()}),t.EFF(163),t.k0s()()()()()),2&o){let i,n,u;t.R7$(17),t.SpI(" ",r.estadisticas.totalAlbaranes," "),t.R7$(7),t.SpI(" ",r.estadisticas.recibidos," "),t.R7$(7),t.SpI(" ",r.estadisticas.pendientes," "),t.R7$(7),t.SpI(" ",t.ii3(39,21,r.estadisticas.valorTotal,"EUR","symbol","1.2-2")," "),t.R7$(13),t.Y8G("ngModel",r.filtros.busqueda),t.R7$(2),t.Y8G("ngModel",r.filtros.estado),t.R7$(9),t.Y8G("ngIf",r.filtros.busqueda||r.filtros.estado),t.R7$(2),t.Y8G("ngForOf",r.albaranesFiltrados),t.R7$(1),t.Y8G("ngIf",0===r.albaranesFiltrados.length&&r.albaranes.length>0),t.R7$(1),t.Y8G("ngIf",0===r.albaranes.length),t.R7$(6),t.SpI(" ",r.modoEdicion?"Editar":"Nuevo"," Albar\xe1n "),t.R7$(3),t.Y8G("formGroup",r.albaranForm),t.R7$(32),t.Y8G("ngForOf",r.proveedores),t.R7$(27),t.SpI(" ",t.ii3(135,26,r.subtotalAlbaran,"EUR","symbol","1.2-2")," "),t.R7$(4),t.Y8G("ngIf",r.ivaBreakdown.length>0),t.R7$(3),t.SpI(" ",t.ii3(142,31,r.totalAlbaran,"EUR","symbol","1.2-2")," "),t.R7$(12),t.Y8G("disabled",!(null!=(i=r.albaranForm.get("proveedorId"))&&i.value)),t.R7$(4),t.Y8G("ngIf",!(null!=(n=r.albaranForm.get("proveedorId"))&&n.value)),t.R7$(1),t.Y8G("ngIf",null==(u=r.albaranForm.get("proveedorId"))?null:u.value),t.R7$(4),t.Y8G("disabled",!r.albaranForm.valid),t.R7$(1),t.SpI(" ",r.modoEdicion?"Actualizar":"Crear"," Albar\xe1n ")}},dependencies:[F.Sq,F.bT,s.qT,s.xH,s.y7,s.me,s.Q0,s.wz,s.BC,s.cb,s.VZ,s.j4,s.JD,s.$R,s.v8,s.vS,F.oe,F.vh],styles:[".product-list[_ngcontent-%COMP%]{max-height:120px;overflow-y:auto}.card[_ngcontent-%COMP%]{transition:transform .2s ease-in-out}.card[_ngcontent-%COMP%]:hover{transform:translateY(-2px)}.modal-xl[_ngcontent-%COMP%]{max-width:1200px}.table-responsive[_ngcontent-%COMP%]{max-height:400px;overflow-y:auto}.badge[_ngcontent-%COMP%]{font-size:.75em}.btn-sm[_ngcontent-%COMP%]{padding:.25rem .5rem;font-size:.875rem}.bg-opacity-10[_ngcontent-%COMP%]{background-color:rgba(var(--bs-success-rgb),.1)!important}.bg-warning.bg-opacity-10[_ngcontent-%COMP%]{background-color:rgba(var(--bs-warning-rgb),.1)!important}.bg-info.bg-opacity-10[_ngcontent-%COMP%]{background-color:rgba(var(--bs-info-rgb),.1)!important}.bg-danger.bg-opacity-10[_ngcontent-%COMP%]{background-color:rgba(var(--bs-danger-rgb),.1)!important}.albaran-card[_ngcontent-%COMP%]{border-left:4px solid #007bff;transition:all .3s ease}.albaran-card[_ngcontent-%COMP%]:hover{box-shadow:0 .5rem 1rem #00000026!important}.albaran-pendiente[_ngcontent-%COMP%]{border-left-color:#6c757d}.albaran-parcial[_ngcontent-%COMP%]{border-left-color:#ffc107}.albaran-recibido[_ngcontent-%COMP%]{border-left-color:#198754}.summary-card[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f8f9fa 0%,#e9ecef 100%);border-radius:.5rem;padding:1rem}.product-row[_ngcontent-%COMP%]{border-bottom:1px solid #eee;padding:.5rem 0}.product-row[_ngcontent-%COMP%]:last-child{border-bottom:none}.estado-badge[_ngcontent-%COMP%]{font-size:.8em;padding:.25em .6em}.total-highlight[_ngcontent-%COMP%]{font-size:1.1em;font-weight:700}.form-floating[_ngcontent-%COMP%]{position:relative}.input-group-text[_ngcontent-%COMP%]{background-color:#f8f9fa;border-color:#dee2e6}.table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#f8f9fa;border-bottom:2px solid #dee2e6;font-weight:600;font-size:.875rem}.table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{vertical-align:middle}.alert-info[_ngcontent-%COMP%]{background-color:#d1ecf1;border-color:#bee5eb;color:#0c5460}.text-truncate-2[_ngcontent-%COMP%]{display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}"]})}}return a})()}];let Y=(()=>{class a{static{this.\u0275fac=function(o){return new(o||a)}}static{this.\u0275mod=t.$C({type:a})}static{this.\u0275inj=t.G2t({imports:[x.iI.forChild(U),x.iI]})}}return a})(),L=(()=>{class a{static{this.\u0275fac=function(o){return new(o||a)}}static{this.\u0275mod=t.$C({type:a})}static{this.\u0275inj=t.G2t({imports:[Y,y.PrivateModule,F.MD,s.X1,s.YN]})}}return a})()}}]);