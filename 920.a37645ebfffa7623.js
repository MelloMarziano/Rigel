"use strict";(self.webpackChunkrigel=self.webpackChunkrigel||[]).push([[920],{2920:(X,y,n)=>{n.r(y),n.d(y,{UsuariosPageModule:()=>J});var x=n(7412),l=n(9417),b=n(177),R=n(5743),C=n(467),d=n(9173),G=n(8359),$=n(4572),U=n(9172),T=n(152),A=n(8032),u=n.n(A),e=n(7705),D=n(4441);function I(t,c){1&t&&(e.j41(0,"div",96)(1,"p",28),e.EFF(2," No se encontraron usuarios con los filtros seleccionados. "),e.k0s()())}function V(t,c){if(1&t&&(e.j41(0,"div",113),e.nrm(1,"i",121),e.j41(2,"small",28),e.EFF(3),e.k0s()()),2&t){const r=e.XpG().$implicit;e.R7$(3),e.JRh(r.telefono)}}function O(t,c){if(1&t&&(e.j41(0,"span",122),e.EFF(1),e.k0s()),2&t){const r=c.$implicit;e.R7$(1),e.SpI(" ",r," ")}}function N(t,c){if(1&t&&(e.j41(0,"span",123),e.EFF(1),e.k0s()),2&t){const r=e.XpG().$implicit;e.R7$(1),e.SpI(" +",r.permisos.length-3," m\xe1s ")}}function Y(t,c){if(1&t){const r=e.RV6();e.j41(0,"div",97)(1,"div",98)(2,"div",99)(3,"div",100)(4,"div",101)(5,"div",102),e.nrm(6,"i",103),e.k0s(),e.j41(7,"div")(8,"h6",104),e.EFF(9),e.k0s(),e.j41(10,"p",105),e.EFF(11),e.k0s()()(),e.j41(12,"div",106)(13,"button",107),e.bIt("click",function(){const i=e.eBV(r).$implicit,a=e.XpG();return e.Njj(a.editarUsuario(i))}),e.nrm(14,"i",108),e.k0s(),e.j41(15,"button",109),e.bIt("click",function(){const i=e.eBV(r).$implicit,a=e.XpG();return e.Njj(a.eliminarUsuario(i.id))}),e.nrm(16,"i",110),e.k0s()()(),e.j41(17,"div",44)(18,"span",111),e.EFF(19),e.k0s()(),e.j41(20,"div",44),e.DNE(21,V,4,1,"div",112),e.j41(22,"div",113),e.nrm(23,"i",114),e.j41(24,"small",28),e.EFF(25),e.k0s()(),e.j41(26,"div",101),e.nrm(27,"i",115),e.j41(28,"small",28),e.EFF(29),e.k0s()()(),e.j41(30,"div")(31,"div",113),e.nrm(32,"i",116),e.j41(33,"small",117),e.EFF(34,"Permisos:"),e.k0s()(),e.j41(35,"div",118),e.DNE(36,O,2,1,"span",119),e.DNE(37,N,2,1,"span",120),e.k0s()()()()()}if(2&t){const r=c.$implicit,o=e.XpG();e.R7$(9),e.JRh(r.nombre),e.R7$(2),e.JRh(r.email),e.R7$(7),e.Y8G("ngClass",o.getRoleBadgeClass(r.rol)),e.R7$(1),e.SpI(" ",r.rol," "),e.R7$(2),e.Y8G("ngIf",r.telefono),e.R7$(4),e.JRh(r.email),e.R7$(4),e.SpI(" \xdaltimo acceso: ",o.formatearFecha(r.ultimoAcceso)," "),e.R7$(7),e.Y8G("ngForOf",r.permisos),e.R7$(1),e.Y8G("ngIf",r.permisos&&r.permisos.length>3)}}function S(t,c){if(1&t){const r=e.RV6();e.j41(0,"div",44)(1,"label",45),e.EFF(2," Contrase\xf1a "),e.j41(3,"span",46),e.EFF(4,"*"),e.k0s()(),e.j41(5,"div",19),e.nrm(6,"input",124),e.j41(7,"button",125),e.bIt("click",function(){e.eBV(r);const s=e.XpG();return e.Njj(s.togglePasswordVisibility())}),e.nrm(8,"i",28),e.k0s()()()}if(2&t){const r=e.XpG();e.R7$(6),e.Y8G("type",r.showPassword?"text":"password"),e.R7$(2),e.HbH(r.showPassword?"bi bi-eye-slash":"bi bi-eye")}}function B(t,c){1&t&&(e.j41(0,"div",44)(1,"label",45),e.EFF(2," Confirmar Contrase\xf1a "),e.j41(3,"span",46),e.EFF(4,"*"),e.k0s()(),e.nrm(5,"input",126),e.k0s())}function M(t,c){1&t&&(e.j41(0,"div",44)(1,"div",57),e.nrm(2,"input",127),e.j41(3,"label",128)(4,"div",60),e.EFF(5,"ROOT"),e.k0s(),e.j41(6,"small",28),e.EFF(7,"Control total del sistema incluyendo apagado/encendido"),e.k0s()()()())}const z=[{path:"",component:(()=>{class t{get isCurrentUserRoot(){return"ROOT"===this.authService.getCurrentUser()?.rol}constructor(r,o,s){this.firestore=r,this.fb=o,this.authService=s,this.usuarios=[],this.filteredUsers=[],this.totalUsuarios=0,this.usuariosActivos=0,this.administradores=0,this.activosHoy=0,this.userSearch=new l.MJ(""),this.roleFilter=new l.MJ("all"),this.permisosDisponibles=["dashboard","productos","categorias","recetas","ventas","reportes","proveedores","albaranes","usuarios","inventario","ajustes","app_shutdown"],this.showPassword=!1,this.subscriptions=new G.yU,this.usuarioForm=this.fb.group({id:[null],nombre:["",l.k0.required],email:["",[l.k0.required,l.k0.email]],telefono:[""],rol:["",l.k0.required],permisos:[[]],password:[""],confirmPassword:[""],activo:[!0]})}ngOnInit(){this.cargarUsuarios(),this.initModal(),this.setupFilters(),this.setupRoleListener()}ngOnDestroy(){this.subscriptions.unsubscribe()}initModal(){const r=document.getElementById("userModal");r&&(this.modal=new bootstrap.Modal(r))}setupFilters(){this.subscriptions.add((0,$.z)([this.userSearch.valueChanges.pipe((0,U.Z)("")),this.roleFilter.valueChanges.pipe((0,U.Z)("all"))]).pipe((0,T.B)(300)).subscribe(([r,o])=>{this.filterUsers(r||"",o||"all")}))}cargarUsuarios(){const r=(0,d.collection)(this.firestore,"usuarios");this.subscriptions.add((0,d.collectionData)(r,{idField:"id"}).subscribe(o=>{this.usuarios=o,this.filteredUsers=o,this.calcularEstadisticas()}))}calcularEstadisticas(){this.totalUsuarios=this.usuarios.length,this.usuariosActivos=this.usuarios.filter(o=>o.activo).length,this.administradores=this.usuarios.filter(o=>"Administrador"===o.rol).length;const r=new Date;this.activosHoy=this.usuarios.filter(o=>!!o.ultimoAcceso&&(o.ultimoAcceso.toDate?o.ultimoAcceso.toDate():new Date(o.ultimoAcceso)).toDateString()===r.toDateString()).length}filterUsers(r,o){let s=[...this.usuarios];this.isCurrentUserRoot||(s=s.filter(i=>"ROOT"!==i.rol)),r&&(s=s.filter(i=>i.nombre.toLowerCase().includes(r.toLowerCase())||i.email.toLowerCase().includes(r.toLowerCase()))),o&&"all"!==o&&(s=s.filter(i=>i.rol===o)),this.filteredUsers=s}getRoleBadgeClass(r){switch(r){case"ROOT":return"bg-dark";case"Administrador":return"bg-danger";case"Gerente":return"bg-info";case"Empleado":return"bg-success";default:return"bg-secondary"}}formatearFecha(r){return r?(r.toDate?r.toDate():new Date(r)).toLocaleDateString("es-ES",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):"Nunca"}onPermisoChange(r,o){const s=this.usuarioForm.get("permisos")?.value||[];if(r.target.checked)s.includes(o)||s.push(o);else{const i=s.indexOf(o);i>-1&&s.splice(i,1)}this.usuarioForm.get("permisos")?.setValue(s)}togglePasswordVisibility(){this.showPassword=!this.showPassword}abrirModalNuevo(){this.resetForm(),this.usuarioForm.get("password")?.setValidators([l.k0.required,l.k0.minLength(6)]),this.usuarioForm.get("confirmPassword")?.setValidators([l.k0.required]),this.usuarioForm.get("password")?.updateValueAndValidity(),this.usuarioForm.get("confirmPassword")?.updateValueAndValidity(),this.modal.show()}editarUsuario(r){this.usuarioForm.patchValue(r),this.usuarioForm.get("password")?.clearValidators(),this.usuarioForm.get("confirmPassword")?.clearValidators(),this.usuarioForm.get("password")?.updateValueAndValidity(),this.usuarioForm.get("confirmPassword")?.updateValueAndValidity(),this.modal.show()}guardarUsuario(){var r=this;return(0,C.A)(function*(){if(r.usuarioForm.invalid)return void u().fire("Error","Por favor, complete todos los campos requeridos.","error");const o=r.usuarioForm.getRawValue();if("ROOT"!==o.rol||r.isCurrentUserRoot)if(o.id||o.password===o.confirmPassword)if(r.usuarios.find(i=>i.email.toLowerCase()===o.email.toLowerCase()&&i.id!==o.id))u().fire("Error","Ya existe un usuario con este correo electr\xf3nico.","error");else{u().showLoading();try{if(o.id){const{id:i,password:a,confirmPassword:m,...p}=o;if("ROOT"===p.rol&&!r.isCurrentUserRoot)return void u().fire("Error","Solo los usuarios ROOT pueden asignar el rol ROOT.","error");const h=(0,d.doc)(r.firestore,"usuarios",i);yield(0,d.updateDoc)(h,p),u().fire("\xa1Actualizado!","El usuario ha sido actualizado.","success")}else{const{id:i,confirmPassword:a,...m}=o;m.fechaCreacion=(0,d.serverTimestamp)(),m.ultimoAcceso=(0,d.serverTimestamp)(),yield(0,d.addDoc)((0,d.collection)(r.firestore,"usuarios"),m),u().fire("\xa1Creado!","El nuevo usuario ha sido creado.","success")}r.modal.hide(),r.resetForm()}catch(i){console.error("Error al guardar el usuario:",i),u().fire("Error","Hubo un problema al guardar el usuario.","error")}}else u().fire("Error","Las contrase\xf1as no coinciden.","error");else u().fire("Error","Solo los usuarios ROOT pueden crear otros usuarios ROOT.","error")})()}eliminarUsuario(r){var o=this;return(0,C.A)(function*(){if((yield u().fire({title:"\xbfEst\xe1s seguro?",text:"Esta acci\xf3n no se puede deshacer.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#dc3545",cancelButtonColor:"#6c757d",confirmButtonText:"S\xed, eliminar",cancelButtonText:"Cancelar"})).isConfirmed)try{yield(0,d.deleteDoc)((0,d.doc)(o.firestore,"usuarios",r)),u().fire("\xa1Eliminado!","El usuario ha sido eliminado.","success")}catch(i){console.error("Error al eliminar el usuario:",i),u().fire("Error","No se pudo eliminar el usuario.","error")}})()}setupRoleListener(){this.subscriptions.add(this.usuarioForm.get("rol")?.valueChanges.subscribe(r=>{r&&this.setPermisosSegunRol(r)}))}setPermisosSegunRol(r){let o=[];switch(r){case"ROOT":o=[...this.permisosDisponibles];break;case"Administrador":o=[...this.permisosDisponibles.filter(s=>"app_shutdown"!==s)];break;case"Gerente":o=["dashboard","productos","categorias","recetas","ventas","reportes","proveedores","albaranes","inventario"];break;case"Empleado":o=["dashboard","productos","ventas"];break;case"Visualizador":o=["dashboard","reportes"];break;default:o=[]}this.usuarioForm.get("permisos")?.setValue(o)}resetForm(){this.usuarioForm.reset({nombre:"",email:"",telefono:"",rol:"",permisos:[],password:"",confirmPassword:"",activo:!0}),this.showPassword=!1}static{this.\u0275fac=function(o){return new(o||t)(e.rXU(d.Firestore),e.rXU(l.ok),e.rXU(D.u))}}static{this.\u0275cmp=e.VBU({type:t,selectors:[["app-usuarios-page"]],decls:248,vars:27,consts:[[1,"container-fluid"],[1,"row"],[1,"col-8"],[1,"col","text-end"],[1,"btn","btn-danger",3,"click"],[1,"bi","bi-plus-lg","me-2"],[1,"row","mt-4"],[1,"col-12","col-md-3","mb-3"],[1,"card","border-0","shadow-sm"],[1,"card-body","text-center"],[1,"text-danger","fw-bold","mb-1"],[1,"text-muted","mb-0"],[1,"text-info","fw-bold","mb-1"],[1,"text-primary","fw-bold","mb-1"],[1,"text-secondary","fw-bold","mb-1"],[1,"col"],[1,"card-body"],[1,"row","align-items-center"],[1,"col-12","col-md-4","mb-2","mb-md-0"],[1,"position-relative"],[1,"bi","bi-search","position-absolute",2,"left","12px","top","50%","transform","translateY(-50%)","color","#6c757d"],["type","text","placeholder","Buscar usuarios...",1,"form-control","ps-5",3,"formControl"],[1,"form-select",3,"formControl"],["value","all"],["value","Administrador"],["value","Gerente"],["value","Empleado"],[1,"col-12","col-md-4","text-end"],[1,"text-muted"],[1,"bi","bi-people","me-1"],["class","col-12 text-center",4,"ngIf"],["class","col-12 col-lg-4 mb-4",4,"ngFor","ngForOf"],["id","userModal","data-bs-backdrop","static","data-bs-keyboard","false","tabindex","-1",1,"modal","fade"],[1,"modal-dialog","modal-lg","modal-dialog-centered"],[1,"modal-content","border-0","shadow-lg"],[3,"formGroup","ngSubmit"],[1,"modal-header","border-0","pb-0"],[1,"modal-title","fw-bold","text-dark"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close"],[1,"modal-body","px-4","py-3"],[1,"col-md-6"],[1,"d-flex","align-items-center","mb-4"],[1,"bi","bi-person-circle","me-2","text-primary","fs-5"],[1,"mb-0","fw-bold","text-dark"],[1,"mb-3"],[1,"form-label","text-dark","fw-medium"],[1,"text-danger"],["type","text","formControlName","nombre","placeholder","Juan P\xe9rez",1,"form-control","border-1","py-2",2,"border-color","#e0e0e0","border-radius","8px"],["type","email","formControlName","email","placeholder","juan@orionsystem.com",1,"form-control","border-1","py-2",2,"border-color","#e0e0e0","border-radius","8px"],["type","tel","formControlName","telefono","placeholder","+34 91 123 4567",1,"form-control","border-1","py-2",2,"border-color","#e0e0e0","border-radius","8px"],["class","mb-3",4,"ngIf"],[1,"form-check"],["type","checkbox","formControlName","activo","id","usuarioActivo",1,"form-check-input"],["for","usuarioActivo",1,"form-check-label","text-dark","fw-medium"],[1,"bi","bi-shield-check","me-2","text-primary","fs-5"],[1,"mb-4"],[1,"form-label","text-dark","fw-medium","mb-3"],[1,"form-check","p-3","border","rounded-3",2,"border-color","#e0e0e0"],["type","radio","name","rol","value","Administrador","formControlName","rol","id","rolAdmin",1,"form-check-input"],["for","rolAdmin",1,"form-check-label","w-100"],[1,"fw-bold","text-dark"],["type","radio","name","rol","value","Gerente","formControlName","rol","id","rolGerente",1,"form-check-input"],["for","rolGerente",1,"form-check-label","w-100"],["type","radio","name","rol","value","Empleado","formControlName","rol","id","rolEmpleado",1,"form-check-input"],["for","rolEmpleado",1,"form-check-label","w-100"],["type","radio","name","rol","value","Visualizador","formControlName","rol","id","rolVisualizador",1,"form-check-input"],["for","rolVisualizador",1,"form-check-label","w-100"],[1,"col-12"],[1,"d-flex","align-items-center","mb-3"],[1,"mb-2"],["type","checkbox","value","dashboard","id","permisoDashboard",1,"form-check-input",3,"checked","change"],["for","permisoDashboard",1,"form-check-label","w-100"],["type","checkbox","value","productos","id","permisoProductos",1,"form-check-input",3,"checked","change"],["for","permisoProductos",1,"form-check-label","w-100"],["type","checkbox","value","categorias","id","permisoCategorias",1,"form-check-input",3,"checked","change"],["for","permisoCategorias",1,"form-check-label","w-100"],["type","checkbox","value","recetas","id","permisoRecetas",1,"form-check-input",3,"checked","change"],["for","permisoRecetas",1,"form-check-label","w-100"],["type","checkbox","value","ventas","id","permisoVentas",1,"form-check-input",3,"checked","change"],["for","permisoVentas",1,"form-check-label","w-100"],["type","checkbox","value","reportes","id","permisoReportes",1,"form-check-input",3,"checked","change"],["for","permisoReportes",1,"form-check-label","w-100"],["type","checkbox","value","proveedores","id","permisoProveedores",1,"form-check-input",3,"checked","change"],["for","permisoProveedores",1,"form-check-label","w-100"],["type","checkbox","value","albaranes","id","permisoAlbaranes",1,"form-check-input",3,"checked","change"],["for","permisoAlbaranes",1,"form-check-label","w-100"],["type","checkbox","value","usuarios","id","permisoUsuarios",1,"form-check-input",3,"checked","change"],["for","permisoUsuarios",1,"form-check-label","w-100"],["type","checkbox","value","inventario","id","permisoInventario",1,"form-check-input",3,"checked","change"],["for","permisoInventario",1,"form-check-label","w-100"],["type","checkbox","value","ajustes","id","permisoAjustes",1,"form-check-input",3,"checked","change"],["for","permisoAjustes",1,"form-check-label","w-100"],[1,"text-muted","mt-2","d-block"],[1,"modal-footer","border-0","pt-0","px-4","pb-4"],["type","button","data-bs-dismiss","modal",1,"btn","btn-outline-secondary","px-4","py-2",2,"border-radius","8px"],["type","submit",1,"btn","btn-danger","px-4","py-2","ms-2",2,"border-radius","8px",3,"disabled"],[1,"col-12","text-center"],[1,"col-12","col-lg-4","mb-4"],[1,"card","border-0","shadow-sm","h-100"],[1,"card-body","p-4"],[1,"d-flex","justify-content-between","align-items-start","mb-3"],[1,"d-flex","align-items-center"],[1,"rounded-circle","bg-dark","d-flex","align-items-center","justify-content-center","me-3",2,"width","48px","height","48px"],[1,"bi","bi-person-fill","text-white","fs-5"],[1,"mb-1","fw-bold"],[1,"text-muted","small","mb-0"],[1,"d-flex","gap-1"],[1,"btn","btn-outline-primary","btn-sm",2,"width","32px","height","32px","padding","0",3,"click"],[1,"bi","bi-pencil-fill",2,"font-size","0.75rem"],[1,"btn","btn-outline-danger","btn-sm",2,"width","32px","height","32px","padding","0",3,"click"],[1,"bi","bi-trash3-fill",2,"font-size","0.75rem"],[1,"badge","rounded-pill",3,"ngClass"],["class","d-flex align-items-center mb-2",4,"ngIf"],[1,"d-flex","align-items-center","mb-2"],[1,"bi","bi-envelope","text-muted","me-2"],[1,"bi","bi-clock","text-muted","me-2"],[1,"bi","bi-shield-check","text-muted","me-2"],[1,"text-muted","fw-bold"],[1,"d-flex","flex-wrap","gap-1"],["class","badge bg-light text-dark border small",4,"ngFor","ngForOf"],["class","badge bg-secondary small",4,"ngIf"],[1,"bi","bi-telephone","text-muted","me-2"],[1,"badge","bg-light","text-dark","border","small"],[1,"badge","bg-secondary","small"],["formControlName","password","placeholder","M\xednimo 6 caracteres",1,"form-control","border-1","py-2","pe-5",2,"border-color","#e0e0e0","border-radius","8px",3,"type"],["type","button",1,"btn","btn-link","position-absolute","end-0","top-50","translate-middle-y","pe-3",2,"border","none","background","none",3,"click"],["type","password","formControlName","confirmPassword","placeholder","Repetir contrase\xf1a",1,"form-control","border-1","py-2",2,"border-color","#e0e0e0","border-radius","8px"],["type","radio","name","rol","value","ROOT","formControlName","rol","id","rolRoot",1,"form-check-input"],["for","rolRoot",1,"form-check-label","w-100"]],template:function(o,s){if(1&o&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3"),e.EFF(4,"Gesti\xf3n de Usuarios"),e.k0s(),e.j41(5,"span"),e.EFF(6,"Administra los usuarios y sus permisos del sistema"),e.k0s()(),e.j41(7,"div",3)(8,"button",4),e.bIt("click",function(){return s.abrirModalNuevo()}),e.nrm(9,"i",5),e.EFF(10," Nuevo Usuario "),e.k0s()()(),e.j41(11,"div",6)(12,"div",7)(13,"div",8)(14,"div",9)(15,"h2",10),e.EFF(16),e.k0s(),e.j41(17,"p",11),e.EFF(18,"Total Usuarios"),e.k0s()()()(),e.j41(19,"div",7)(20,"div",8)(21,"div",9)(22,"h2",12),e.EFF(23),e.k0s(),e.j41(24,"p",11),e.EFF(25,"Usuarios Activos"),e.k0s()()()(),e.j41(26,"div",7)(27,"div",8)(28,"div",9)(29,"h2",13),e.EFF(30),e.k0s(),e.j41(31,"p",11),e.EFF(32,"Administradores"),e.k0s()()()(),e.j41(33,"div",7)(34,"div",8)(35,"div",9)(36,"h2",14),e.EFF(37),e.k0s(),e.j41(38,"p",11),e.EFF(39,"Activos Hoy"),e.k0s()()()()(),e.j41(40,"div",6)(41,"div",15)(42,"div",8)(43,"div",16)(44,"div",17)(45,"div",18)(46,"div",19),e.nrm(47,"i",20)(48,"input",21),e.k0s()(),e.j41(49,"div",18)(50,"select",22)(51,"option",23),e.EFF(52,"Todos los roles"),e.k0s(),e.j41(53,"option",24),e.EFF(54,"Administrador"),e.k0s(),e.j41(55,"option",25),e.EFF(56,"Gerente"),e.k0s(),e.j41(57,"option",26),e.EFF(58,"Empleado"),e.k0s()()(),e.j41(59,"div",27)(60,"span",28),e.nrm(61,"i",29),e.EFF(62),e.k0s()()()()()()(),e.j41(63,"div",6),e.DNE(64,I,3,0,"div",30),e.DNE(65,Y,38,9,"div",31),e.k0s(),e.j41(66,"div",32)(67,"div",33)(68,"div",34)(69,"form",35),e.bIt("ngSubmit",function(){return s.guardarUsuario()}),e.j41(70,"div",36)(71,"h4",37),e.EFF(72),e.k0s(),e.nrm(73,"button",38),e.k0s(),e.j41(74,"div",39)(75,"div",1)(76,"div",40)(77,"div",41),e.nrm(78,"i",42),e.j41(79,"h6",43),e.EFF(80,"Informaci\xf3n Personal"),e.k0s()(),e.j41(81,"div",44)(82,"label",45),e.EFF(83," Nombre Completo "),e.j41(84,"span",46),e.EFF(85,"*"),e.k0s()(),e.nrm(86,"input",47),e.k0s(),e.j41(87,"div",44)(88,"label",45),e.EFF(89," Email "),e.j41(90,"span",46),e.EFF(91,"*"),e.k0s()(),e.nrm(92,"input",48),e.k0s(),e.j41(93,"div",44)(94,"label",45),e.EFF(95,"Tel\xe9fono"),e.k0s(),e.nrm(96,"input",49),e.k0s(),e.DNE(97,S,9,3,"div",50),e.DNE(98,B,6,0,"div",50),e.j41(99,"div",51),e.nrm(100,"input",52),e.j41(101,"label",53),e.EFF(102," Usuario activo "),e.k0s()()(),e.j41(103,"div",40)(104,"div",41),e.nrm(105,"i",54),e.j41(106,"h6",43),e.EFF(107,"Rol y Permisos"),e.k0s()(),e.j41(108,"div",55)(109,"label",56),e.EFF(110,"Rol del Usuario"),e.k0s(),e.j41(111,"div",44)(112,"div",57),e.nrm(113,"input",58),e.j41(114,"label",59)(115,"div",60),e.EFF(116,"Administrador"),e.k0s(),e.j41(117,"small",28),e.EFF(118,"Acceso completo al sistema"),e.k0s()()()(),e.j41(119,"div",44)(120,"div",57),e.nrm(121,"input",61),e.j41(122,"label",62)(123,"div",60),e.EFF(124,"Gerente"),e.k0s(),e.j41(125,"small",28),e.EFF(126,"Gesti\xf3n de productos, ventas y reportes"),e.k0s()()()(),e.j41(127,"div",44)(128,"div",57),e.nrm(129,"input",63),e.j41(130,"label",64)(131,"div",60),e.EFF(132,"Empleado"),e.k0s(),e.j41(133,"small",28),e.EFF(134,"Operaciones b\xe1sicas de venta"),e.k0s()()()(),e.DNE(135,M,8,0,"div",50),e.j41(136,"div",44)(137,"div",57),e.nrm(138,"input",65),e.j41(139,"label",66)(140,"div",60),e.EFF(141,"Visualizador"),e.k0s(),e.j41(142,"small",28),e.EFF(143,"Solo lectura de reportes"),e.k0s()()()()()()(),e.j41(144,"div",6)(145,"div",67)(146,"div",68),e.nrm(147,"i",54),e.j41(148,"h6",43),e.EFF(149,"Permisos Espec\xedficos"),e.k0s()(),e.j41(150,"div",1)(151,"div",40)(152,"div",69)(153,"div",51)(154,"input",70),e.bIt("change",function(a){return s.onPermisoChange(a,"dashboard")}),e.k0s(),e.j41(155,"label",71)(156,"div",60),e.EFF(157,"Dashboard"),e.k0s(),e.j41(158,"small",28),e.EFF(159,"Ver m\xe9tricas principales"),e.k0s()()()(),e.j41(160,"div",69)(161,"div",51)(162,"input",72),e.bIt("change",function(a){return s.onPermisoChange(a,"productos")}),e.k0s(),e.j41(163,"label",73)(164,"div",60),e.EFF(165,"Productos"),e.k0s(),e.j41(166,"small",28),e.EFF(167,"Gestionar inventario"),e.k0s()()()(),e.j41(168,"div",69)(169,"div",51)(170,"input",74),e.bIt("change",function(a){return s.onPermisoChange(a,"categorias")}),e.k0s(),e.j41(171,"label",75)(172,"div",60),e.EFF(173,"Categor\xedas"),e.k0s(),e.j41(174,"small",28),e.EFF(175,"Gestionar categor\xedas"),e.k0s()()()(),e.j41(176,"div",69)(177,"div",51)(178,"input",76),e.bIt("change",function(a){return s.onPermisoChange(a,"recetas")}),e.k0s(),e.j41(179,"label",77)(180,"div",60),e.EFF(181,"Recetas"),e.k0s(),e.j41(182,"small",28),e.EFF(183,"Crear y editar recetas"),e.k0s()()()(),e.j41(184,"div",69)(185,"div",51)(186,"input",78),e.bIt("change",function(a){return s.onPermisoChange(a,"ventas")}),e.k0s(),e.j41(187,"label",79)(188,"div",60),e.EFF(189,"Ventas"),e.k0s(),e.j41(190,"small",28),e.EFF(191,"Procesar ventas"),e.k0s()()()(),e.j41(192,"div",69)(193,"div",51)(194,"input",80),e.bIt("change",function(a){return s.onPermisoChange(a,"reportes")}),e.k0s(),e.j41(195,"label",81)(196,"div",60),e.EFF(197,"Reportes"),e.k0s(),e.j41(198,"small",28),e.EFF(199,"Ver reportes y estad\xedsticas"),e.k0s()()()()(),e.j41(200,"div",40)(201,"div",69)(202,"div",51)(203,"input",82),e.bIt("change",function(a){return s.onPermisoChange(a,"proveedores")}),e.k0s(),e.j41(204,"label",83)(205,"div",60),e.EFF(206,"Proveedores"),e.k0s(),e.j41(207,"small",28),e.EFF(208,"Gestionar proveedores"),e.k0s()()()(),e.j41(209,"div",69)(210,"div",51)(211,"input",84),e.bIt("change",function(a){return s.onPermisoChange(a,"albaranes")}),e.k0s(),e.j41(212,"label",85)(213,"div",60),e.EFF(214,"Albaranes"),e.k0s(),e.j41(215,"small",28),e.EFF(216,"Gestionar albaranes"),e.k0s()()()(),e.j41(217,"div",69)(218,"div",51)(219,"input",86),e.bIt("change",function(a){return s.onPermisoChange(a,"usuarios")}),e.k0s(),e.j41(220,"label",87)(221,"div",60),e.EFF(222,"Usuarios"),e.k0s(),e.j41(223,"small",28),e.EFF(224,"Gestionar usuarios del sistema"),e.k0s()()()(),e.j41(225,"div",69)(226,"div",51)(227,"input",88),e.bIt("change",function(a){return s.onPermisoChange(a,"inventario")}),e.k0s(),e.j41(228,"label",89)(229,"div",60),e.EFF(230,"Inventario"),e.k0s(),e.j41(231,"small",28),e.EFF(232,"Control de inventario"),e.k0s()()()(),e.j41(233,"div",69)(234,"div",51)(235,"input",90),e.bIt("change",function(a){return s.onPermisoChange(a,"ajustes")}),e.k0s(),e.j41(236,"label",91)(237,"div",60),e.EFF(238,"Ajustes"),e.k0s(),e.j41(239,"small",28),e.EFF(240,"Configurar sistema"),e.k0s()()()()()(),e.j41(241,"small",92),e.EFF(242," Los permisos se asignan autom\xe1ticamente seg\xfan el rol, pero puedes personalizarlos aqu\xed. "),e.k0s()()()(),e.j41(243,"div",93)(244,"button",94),e.EFF(245," Cancelar "),e.k0s(),e.j41(246,"button",95),e.EFF(247),e.k0s()()()()()()()),2&o){let i,a,m,p,h,f,v,g,F,k,j,E,_,w,P;e.R7$(16),e.JRh(s.totalUsuarios),e.R7$(7),e.JRh(s.usuariosActivos),e.R7$(7),e.JRh(s.administradores),e.R7$(7),e.JRh(s.activosHoy),e.R7$(11),e.Y8G("formControl",s.userSearch),e.R7$(2),e.Y8G("formControl",s.roleFilter),e.R7$(12),e.SpI("",s.filteredUsers.length," usuarios "),e.R7$(2),e.Y8G("ngIf",0===s.filteredUsers.length),e.R7$(1),e.Y8G("ngForOf",s.filteredUsers),e.R7$(4),e.Y8G("formGroup",s.usuarioForm),e.R7$(3),e.SpI(" ",null!=(i=s.usuarioForm.get("id"))&&i.value?"Editar Usuario":"Nuevo Usuario"," "),e.R7$(25),e.Y8G("ngIf",!(null!=(a=s.usuarioForm.get("id"))&&a.value)),e.R7$(1),e.Y8G("ngIf",!(null!=(m=s.usuarioForm.get("id"))&&m.value)),e.R7$(37),e.Y8G("ngIf",s.isCurrentUserRoot),e.R7$(19),e.Y8G("checked",null==(p=s.usuarioForm.get("permisos"))||null==p.value?null:p.value.includes("dashboard")),e.R7$(8),e.Y8G("checked",null==(h=s.usuarioForm.get("permisos"))||null==h.value?null:h.value.includes("productos")),e.R7$(8),e.Y8G("checked",null==(f=s.usuarioForm.get("permisos"))||null==f.value?null:f.value.includes("categorias")),e.R7$(8),e.Y8G("checked",null==(v=s.usuarioForm.get("permisos"))||null==v.value?null:v.value.includes("recetas")),e.R7$(8),e.Y8G("checked",null==(g=s.usuarioForm.get("permisos"))||null==g.value?null:g.value.includes("ventas")),e.R7$(8),e.Y8G("checked",null==(F=s.usuarioForm.get("permisos"))||null==F.value?null:F.value.includes("reportes")),e.R7$(9),e.Y8G("checked",null==(k=s.usuarioForm.get("permisos"))||null==k.value?null:k.value.includes("proveedores")),e.R7$(8),e.Y8G("checked",null==(j=s.usuarioForm.get("permisos"))||null==j.value?null:j.value.includes("albaranes")),e.R7$(8),e.Y8G("checked",null==(E=s.usuarioForm.get("permisos"))||null==E.value?null:E.value.includes("usuarios")),e.R7$(8),e.Y8G("checked",null==(_=s.usuarioForm.get("permisos"))||null==_.value?null:_.value.includes("inventario")),e.R7$(8),e.Y8G("checked",null==(w=s.usuarioForm.get("permisos"))||null==w.value?null:w.value.includes("ajustes")),e.R7$(11),e.Y8G("disabled",s.usuarioForm.invalid),e.R7$(1),e.SpI(" ",null!=(P=s.usuarioForm.get("id"))&&P.value?"Actualizar Usuario":"Crear Usuario"," ")}},dependencies:[b.YU,b.Sq,b.bT,l.qT,l.xH,l.y7,l.me,l.Zm,l.wz,l.Fm,l.BC,l.cb,l.l_,l.j4,l.JD]})}}return t})()}];let L=(()=>{class t{static{this.\u0275fac=function(o){return new(o||t)}}static{this.\u0275mod=e.$C({type:t})}static{this.\u0275inj=e.G2t({imports:[R.iI.forChild(z),R.iI]})}}return t})(),J=(()=>{class t{static{this.\u0275fac=function(o){return new(o||t)}}static{this.\u0275mod=e.$C({type:t})}static{this.\u0275inj=e.G2t({imports:[L,x.PrivateModule,b.MD,l.X1,l.YN]})}}return t})()}}]);