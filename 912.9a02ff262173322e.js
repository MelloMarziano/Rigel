"use strict";(self.webpackChunkrigel=self.webpackChunkrigel||[]).push([[912],{8912:(W,k,m)=>{m.r(k),m.d(k,{EscandallosPageModule:()=>K});var R=m(7412),i=m(9417),f=m(177),C=m(5743),F=m(467),l=m(9173),x=m(8032),p=m.n(x),y=m(8359),e=m(7705),I=m(6239);function O(r,d){if(1&r){const t=e.RV6();e.j41(0,"div",71),e.nrm(1,"i",72),e.j41(2,"h5",73),e.EFF(3,"No hay escandallos registrados"),e.k0s(),e.j41(4,"p",11),e.EFF(5,"Crea tu primer escandallo para comenzar"),e.k0s(),e.j41(6,"button",4),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.abrirModalNuevo())}),e.nrm(7,"i",57),e.EFF(8," Nuevo Escandallo "),e.k0s()()}}function $(r,d){if(1&r){const t=e.RV6();e.j41(0,"div",74)(1,"div",75),e.bIt("click",function(){const a=e.eBV(t).$implicit,s=e.XpG();return e.Njj(s.verDetalleEscandallo(a))}),e.j41(2,"div",76)(3,"div",77)(4,"div",78),e.nrm(5,"i",79),e.k0s(),e.j41(6,"div",80)(7,"h6",81),e.EFF(8),e.k0s(),e.j41(9,"p",82),e.EFF(10),e.k0s(),e.j41(11,"span",83),e.EFF(12),e.k0s()()(),e.j41(13,"div",84)(14,"div",85)(15,"div",86),e.EFF(16,"Costo"),e.k0s(),e.j41(17,"div",87),e.EFF(18),e.nI1(19,"currency"),e.k0s()(),e.j41(20,"div",85)(21,"div",86),e.EFF(22,"Precio Venta"),e.k0s(),e.j41(23,"div",88),e.EFF(24),e.nI1(25,"currency"),e.k0s()()(),e.j41(26,"div",47)(27,"div",89)(28,"small",11),e.nrm(29,"i",90),e.EFF(30," Margen "),e.k0s(),e.j41(31,"h5",91),e.EFF(32),e.nI1(33,"number"),e.k0s()(),e.j41(34,"div",92),e.nrm(35,"div",93),e.k0s()(),e.j41(36,"div",94)(37,"small",11),e.nrm(38,"i",95),e.EFF(39),e.k0s(),e.j41(40,"span",96),e.nrm(41,"i",97),e.EFF(42),e.k0s()()()()()}if(2&r){const t=d.$implicit,o=e.XpG();e.R7$(8),e.JRh(t.nombre),e.R7$(2),e.JRh(t.descripcion||"Sin descripci\xf3n"),e.R7$(1),e.Y8G("ngClass",o.getCategoriaBadgeClass(t.categoriaId)),e.R7$(1),e.SpI(" ",o.getCategoriaNombre(t.categoriaId)," "),e.R7$(6),e.SpI(" ",e.ii3(19,17,t.costoTotalConMermas,"EUR","symbol","1.2-2")," "),e.R7$(6),e.SpI(" ",e.ii3(25,22,t.precioVenta,"EUR","symbol","1.2-2")," "),e.R7$(7),e.Y8G("ngClass",t.margenPorcentaje>=0?"text-success":"text-danger"),e.R7$(1),e.SpI(" ",e.i5U(33,27,t.margenPorcentaje,"1.1-1"),"% "),e.R7$(3),e.xc7("width",t.margenPorcentaje>=0?t.margenPorcentaje:0,"%"),e.Y8G("ngClass",t.margenPorcentaje>=0?"bg-success":"bg-danger"),e.BMQ("aria-valuenow",t.margenPorcentaje),e.R7$(4),e.Lme(" ",t.porciones," ",1===t.porciones?"porci\xf3n":"porciones"," "),e.R7$(1),e.Y8G("ngClass",t.activo?"bg-success":"bg-secondary"),e.R7$(1),e.Y8G("ngClass",t.activo?"bi-check-circle":"bi-x-circle"),e.R7$(1),e.SpI(" ",t.activo?"Activo":"Inactivo"," ")}}function G(r,d){1&r&&e.nrm(0,"i",134)}function w(r,d){if(1&r&&(e.j41(0,"tr")(1,"td")(2,"strong"),e.EFF(3),e.k0s()(),e.j41(4,"td",130),e.EFF(5),e.k0s(),e.j41(6,"td",130),e.EFF(7),e.nI1(8,"currency"),e.k0s(),e.j41(9,"td",131)(10,"span",96),e.DNE(11,G,1,0,"i",133),e.EFF(12),e.k0s()(),e.j41(13,"td",130)(14,"strong"),e.EFF(15),e.nI1(16,"currency"),e.k0s()()()),2&r){const t=d.$implicit;e.R7$(3),e.JRh(t.productoNombre),e.R7$(2),e.Lme("",t.cantidad," ",t.unidadMedida,""),e.R7$(2),e.JRh(e.ii3(8,8,t.costoSinMerma,"EUR","symbol","1.2-2")),e.R7$(3),e.Y8G("ngClass",t.porcentajeMerma>0?"bg-warning text-dark":"bg-secondary"),e.R7$(1),e.Y8G("ngIf",t.porcentajeMerma>0),e.R7$(1),e.SpI(" ",t.porcentajeMerma,"% "),e.R7$(3),e.JRh(e.ii3(16,13,t.costoConMerma,"EUR","symbol","1.2-2"))}}function N(r,d){if(1&r&&(e.j41(0,"div",126)(1,"div",121)(2,"h6",47),e.nrm(3,"i",127),e.EFF(4," Ingredientes Base "),e.k0s(),e.j41(5,"div",128)(6,"table",129)(7,"thead")(8,"tr")(9,"th"),e.EFF(10,"Ingrediente"),e.k0s(),e.j41(11,"th",130),e.EFF(12,"Cantidad"),e.k0s(),e.j41(13,"th",130),e.EFF(14,"Costo Sin Merma"),e.k0s(),e.j41(15,"th",131),e.EFF(16,"Merma"),e.k0s(),e.j41(17,"th",130),e.EFF(18,"Costo Con Merma"),e.k0s()()(),e.j41(19,"tbody"),e.DNE(20,w,17,18,"tr",132),e.k0s()()()()()),2&r){const t=e.XpG(2);e.R7$(20),e.Y8G("ngForOf",t.escandalloSeleccionado.ingredientesBase)}}function S(r,d){if(1&r&&(e.j41(0,"tr")(1,"td")(2,"strong"),e.EFF(3),e.k0s()(),e.j41(4,"td",130),e.EFF(5),e.k0s(),e.j41(6,"td",130)(7,"strong"),e.EFF(8),e.nI1(9,"currency"),e.k0s()()()),2&r){const t=d.$implicit;e.R7$(3),e.JRh(t.recetaNombre),e.R7$(2),e.Lme("",t.cantidad," ",t.unidadMedida,""),e.R7$(3),e.JRh(e.ii3(9,4,t.costo,"EUR","symbol","1.2-2"))}}function B(r,d){if(1&r&&(e.j41(0,"div",126)(1,"div",121)(2,"h6",47),e.nrm(3,"i",135),e.EFF(4," Recetas Pre-elaboradas "),e.k0s(),e.j41(5,"div",128)(6,"table",129)(7,"thead")(8,"tr")(9,"th"),e.EFF(10,"Receta"),e.k0s(),e.j41(11,"th",130),e.EFF(12,"Cantidad"),e.k0s(),e.j41(13,"th",130),e.EFF(14,"Costo"),e.k0s()()(),e.j41(15,"tbody"),e.DNE(16,S,10,9,"tr",132),e.k0s()()()()()),2&r){const t=e.XpG(2);e.R7$(16),e.Y8G("ngForOf",t.escandalloSeleccionado.recetas)}}function T(r,d){if(1&r&&(e.j41(0,"div",98)(1,"div",99)(2,"span",100),e.nrm(3,"i",101),e.EFF(4),e.k0s(),e.j41(5,"span",102),e.nrm(6,"i",97),e.EFF(7),e.k0s()(),e.j41(8,"div",103)(9,"div",104)(10,"div",105)(11,"div",9),e.nrm(12,"i",106),e.j41(13,"h3",107),e.EFF(14),e.nI1(15,"currency"),e.k0s(),e.j41(16,"small",11),e.EFF(17,"Costo Total"),e.k0s()()()(),e.j41(18,"div",104)(19,"div",108)(20,"div",9),e.nrm(21,"i",109),e.j41(22,"h3",110),e.EFF(23),e.nI1(24,"currency"),e.k0s(),e.j41(25,"small",11),e.EFF(26,"Precio Venta"),e.k0s()()()(),e.j41(27,"div",104)(28,"div",111)(29,"div",9),e.nrm(30,"i",112),e.j41(31,"h3",113),e.EFF(32),e.nI1(33,"currency"),e.k0s(),e.j41(34,"small",11),e.EFF(35,"Ganancia"),e.k0s()()()(),e.j41(36,"div",104)(37,"div",114)(38,"div",9),e.nrm(39,"i",115),e.j41(40,"h3",116),e.EFF(41),e.nI1(42,"number"),e.k0s(),e.j41(43,"small",11),e.EFF(44,"Margen"),e.k0s()()()()(),e.DNE(45,N,21,1,"div",117),e.DNE(46,B,17,1,"div",117),e.j41(47,"div",118)(48,"div",119)(49,"div",120)(50,"div",121)(51,"h6",47),e.nrm(52,"i",122),e.EFF(53," Porciones "),e.k0s(),e.j41(54,"div",21),e.nrm(55,"i",123),e.j41(56,"div")(57,"h3",24),e.EFF(58),e.k0s(),e.j41(59,"small",11),e.EFF(60),e.k0s()()()()()(),e.j41(61,"div",119)(62,"div",108)(63,"div",121)(64,"h6",47),e.nrm(65,"i",124),e.EFF(66," Costo por Porci\xf3n "),e.k0s(),e.j41(67,"div",21),e.nrm(68,"i",125),e.j41(69,"div")(70,"h3",24),e.EFF(71),e.nI1(72,"currency"),e.k0s(),e.j41(73,"small",11),e.EFF(74,"por porci\xf3n"),e.k0s()()()()()()()()),2&r){const t=e.XpG();e.R7$(2),e.Y8G("ngClass",t.getCategoriaBadgeClass(t.escandalloSeleccionado.categoriaId)),e.R7$(2),e.SpI(" ",t.getCategoriaNombre(t.escandalloSeleccionado.categoriaId)," "),e.R7$(1),e.Y8G("ngClass",t.escandalloSeleccionado.activo?"bg-success":"bg-secondary"),e.R7$(1),e.Y8G("ngClass",t.escandalloSeleccionado.activo?"bi-check-circle-fill":"bi-x-circle-fill"),e.R7$(1),e.SpI(" ",t.escandalloSeleccionado.activo?"Activo":"Inactivo"," "),e.R7$(7),e.JRh(e.ii3(15,14,t.escandalloSeleccionado.costoTotalConMermas,"EUR","symbol","1.2-2")),e.R7$(9),e.JRh(e.ii3(24,19,t.escandalloSeleccionado.precioVenta,"EUR","symbol","1.2-2")),e.R7$(9),e.JRh(e.ii3(33,24,t.escandalloSeleccionado.margen,"EUR","symbol","1.2-2")),e.R7$(9),e.SpI("",e.i5U(42,29,t.escandalloSeleccionado.margenPorcentaje,"1.1-1"),"%"),e.R7$(4),e.Y8G("ngIf",t.escandalloSeleccionado&&t.escandalloSeleccionado.ingredientesBase&&t.escandalloSeleccionado.ingredientesBase.length>0),e.R7$(1),e.Y8G("ngIf",t.escandalloSeleccionado&&t.escandalloSeleccionado.recetas&&t.escandalloSeleccionado.recetas.length>0),e.R7$(12),e.JRh(t.escandalloSeleccionado.porciones),e.R7$(2),e.JRh(1===t.escandalloSeleccionado.porciones?"porci\xf3n":"porciones"),e.R7$(11),e.JRh(e.ii3(72,32,t.escandalloSeleccionado.costoPorPorcion,"EUR","symbol","1.2-2"))}}function D(r,d){if(1&r&&(e.j41(0,"option",136),e.EFF(1),e.k0s()),2&r){const t=d.$implicit;e.Y8G("value",t.id),e.R7$(1),e.JRh(t.nombre)}}function V(r,d){if(1&r){const t=e.RV6();e.j41(0,"button",154),e.bIt("click",function(){const a=e.eBV(t).$implicit,s=e.XpG(2).index,c=e.XpG();return e.Njj(c.seleccionarProductoIngrediente(s,a))}),e.j41(1,"div",94)(2,"div")(3,"strong",155),e.EFF(4),e.k0s(),e.nrm(5,"br"),e.j41(6,"small",11),e.EFF(7),e.k0s()(),e.j41(8,"span",156),e.EFF(9),e.nI1(10,"currency"),e.k0s()()()}if(2&r){const t=d.$implicit;e.R7$(4),e.JRh(t.nombre),e.R7$(3),e.Lme("",t.cantidad," ",t.unidadMedida,""),e.R7$(2),e.JRh(e.ii3(10,4,t.costo,"EUR","symbol","1.2-2"))}}function Y(r,d){if(1&r&&(e.j41(0,"div",152),e.DNE(1,V,11,9,"button",153),e.k0s()),2&r){const t=e.XpG(2);e.R7$(1),e.Y8G("ngForOf",t.productosFiltradosIngrediente)}}function A(r,d){if(1&r&&(e.j41(0,"option",136),e.EFF(1),e.k0s()),2&r){const t=d.$implicit;e.Y8G("value",t.id),e.R7$(1),e.Lme(" ",t.nombre," (",t.porcentajeMerma,"%) ")}}const P=function(){return{standalone:!0}};function U(r,d){if(1&r){const t=e.RV6();e.j41(0,"div",137)(1,"div",138)(2,"div",139)(3,"div",119)(4,"label",140),e.EFF(5,"Producto"),e.k0s(),e.j41(6,"div",141)(7,"input",142),e.bIt("ngModelChange",function(n){const s=e.eBV(t).index,c=e.XpG();return e.Njj(c.busquedaProductos[s]=n)})("focus",function(){const a=e.eBV(t).index,s=e.XpG();return e.Njj(s.mostrarListaProductosIndex=a)})("input",function(){const a=e.eBV(t).index,s=e.XpG();return e.Njj(s.filtrarProductosIngrediente(a))}),e.k0s(),e.nrm(8,"i",143),e.DNE(9,Y,2,1,"div",144),e.k0s()(),e.j41(10,"div",145)(11,"label",140),e.EFF(12,"Cantidad"),e.k0s(),e.nrm(13,"input",146),e.k0s(),e.j41(14,"div",104)(15,"label",140),e.nrm(16,"i",147),e.EFF(17," Merma Cocina "),e.k0s(),e.j41(18,"select",148)(19,"option",45),e.EFF(20,"Sin merma (0%)"),e.k0s(),e.DNE(21,A,2,3,"option",46),e.k0s(),e.j41(22,"small",11),e.EFF(23,"Solo mermas de cocina"),e.k0s()(),e.j41(24,"div",149)(25,"button",150),e.bIt("click",function(){const a=e.eBV(t).index,s=e.XpG();return e.Njj(s.eliminarIngredienteBase(a))}),e.nrm(26,"i",151),e.k0s()()()()()}if(2&r){const t=d.$implicit,o=d.index,n=e.XpG();let a;e.Y8G("formGroupName",o),e.R7$(7),e.Y8G("ngModel",n.busquedaProductos[o])("ngModelOptions",e.lJ4(5,P)),e.R7$(2),e.Y8G("ngIf",n.mostrarListaProductosIndex===o&&n.productosFiltradosIngrediente.length>0),e.R7$(12),e.Y8G("ngForOf",n.getMermasDisponibles(null==(a=t.get("productoId"))?null:a.value))}}function J(r,d){1&r&&(e.j41(0,"div",157)(1,"small"),e.nrm(2,"i",158),e.EFF(3," Los ingredientes base son productos directos. Solo se pueden aplicar "),e.j41(4,"strong"),e.EFF(5,"mermas de cocina"),e.k0s(),e.EFF(6," (p\xe9rdidas durante preparaci\xf3n). "),e.k0s()())}function X(r,d){if(1&r){const t=e.RV6();e.j41(0,"button",154),e.bIt("click",function(){const a=e.eBV(t).$implicit,s=e.XpG(2).index,c=e.XpG();return e.Njj(c.seleccionarRecetaEscandallo(s,a))}),e.j41(1,"div",94)(2,"div")(3,"strong",155),e.EFF(4),e.k0s(),e.nrm(5,"br"),e.j41(6,"small",11),e.EFF(7),e.k0s()(),e.j41(8,"span",164),e.EFF(9),e.nI1(10,"currency"),e.k0s()()()}if(2&r){const t=d.$implicit;e.R7$(4),e.JRh(t.nombre),e.R7$(3),e.Lme("",t.rendimiento," ",t.unidadRendimiento,""),e.R7$(2),e.JRh(e.ii3(10,4,t.costoTotal,"EUR","symbol","1.2-2"))}}function L(r,d){if(1&r&&(e.j41(0,"div",152),e.DNE(1,X,11,9,"button",153),e.k0s()),2&r){const t=e.XpG(2);e.R7$(1),e.Y8G("ngForOf",t.recetasFiltradas)}}function q(r,d){if(1&r){const t=e.RV6();e.j41(0,"div",159)(1,"div",138)(2,"div",139)(3,"div",160)(4,"label",140),e.EFF(5,"Receta"),e.k0s(),e.j41(6,"div",141)(7,"input",161),e.bIt("ngModelChange",function(n){const s=e.eBV(t).index,c=e.XpG();return e.Njj(c.busquedaRecetas[s]=n)})("focus",function(){const a=e.eBV(t).index,s=e.XpG();return e.Njj(s.mostrarListaRecetasIndex=a)})("input",function(){const a=e.eBV(t).index,s=e.XpG();return e.Njj(s.filtrarRecetasEscandallo(a))}),e.k0s(),e.nrm(8,"i",143),e.DNE(9,L,2,1,"div",144),e.k0s()(),e.j41(10,"div",104),e.nrm(11,"input",162),e.k0s(),e.j41(12,"div",163)(13,"button",150),e.bIt("click",function(){const a=e.eBV(t).index,s=e.XpG();return e.Njj(s.eliminarReceta(a))}),e.nrm(14,"i",151),e.k0s()()()()()}if(2&r){const t=d.index,o=e.XpG();e.Y8G("formGroupName",t),e.R7$(7),e.Y8G("ngModel",o.busquedaRecetas[t])("ngModelOptions",e.lJ4(4,P)),e.R7$(2),e.Y8G("ngIf",o.mostrarListaRecetasIndex===t&&o.recetasFiltradas.length>0)}}function z(r,d){1&r&&(e.j41(0,"div",157)(1,"small"),e.nrm(2,"i",158),e.EFF(3," Las recetas pre-elaboradas ya tienen sus costos calculados incluyendo todos sus ingredientes. "),e.k0s()())}function Q(r,d){if(1&r&&(e.j41(0,"div",165)(1,"h6",166),e.nrm(2,"i",167),e.EFF(3," Resumen de Costos "),e.k0s(),e.j41(4,"div",1)(5,"div",104)(6,"small",168),e.EFF(7,"Costo Total:"),e.k0s(),e.j41(8,"strong",169),e.EFF(9),e.nI1(10,"currency"),e.k0s()(),e.j41(11,"div",104)(12,"small",168),e.EFF(13,"Precio Venta:"),e.k0s(),e.j41(14,"strong",170),e.EFF(15),e.nI1(16,"currency"),e.k0s()(),e.j41(17,"div",104)(18,"small",168),e.EFF(19,"Ganancia:"),e.k0s(),e.j41(20,"strong",171),e.EFF(21),e.nI1(22,"currency"),e.k0s()(),e.j41(23,"div",104)(24,"small",168),e.EFF(25,"Margen:"),e.k0s(),e.j41(26,"strong",171),e.EFF(27),e.nI1(28,"number"),e.k0s()()()()),2&r){const t=e.XpG();let o;e.R7$(9),e.JRh(e.ii3(10,6,t.costoPreview.costoConMermas,"EUR","symbol","1.2-2")),e.R7$(6),e.JRh(e.ii3(16,11,null==(o=t.escandalloForm.get("precioVenta"))?null:o.value,"EUR","symbol","1.2-2")),e.R7$(5),e.Y8G("ngClass",t.costoPreview.margen>=0?"text-success":"text-danger"),e.R7$(1),e.SpI(" ",e.ii3(22,16,t.costoPreview.margen,"EUR","symbol","1.2-2")," "),e.R7$(5),e.Y8G("ngClass",t.costoPreview.margenPorcentaje>=0?"text-success":"text-danger"),e.R7$(1),e.SpI(" ",e.i5U(28,21,t.costoPreview.margenPorcentaje,"1.1-1"),"% ")}}const H=[{path:"",component:(()=>{class r{constructor(t,o,n){this.fb=t,this.firestore=o,this.mermasService=n,this.escandallos=[],this.productos=[],this.recetas=[],this.mermas=[],this.escandalloSeleccionado=null,this.totalEscandallos=0,this.escandallosActivos=0,this.margenPromedio=0,this.totalPorciones=0,this.categorias=[{id:"platos",nombre:"Platos"},{id:"bebidas",nombre:"Bebidas"},{id:"postres",nombre:"Postres"},{id:"entradas",nombre:"Entradas"},{id:"menu",nombre:"Men\xfa"}],this.busquedaProductos={},this.busquedaRecetas={},this.productosFiltradosIngrediente=[],this.recetasFiltradas=[],this.mostrarListaProductosIndex=null,this.mostrarListaRecetasIndex=null,this.subscriptions=new y.yU,this.inicializarForm()}ngOnInit(){this.cargarEscandallos(),this.cargarProductos(),this.cargarRecetas(),this.cargarMermas();const t=document.getElementById("escandalloModal");t&&(this.modal=new bootstrap.Modal(t));const o=document.getElementById("detalleEscandalloModal");o&&(this.detalleModal=new bootstrap.Modal(o))}ngOnDestroy(){this.subscriptions.unsubscribe()}inicializarForm(){this.escandalloForm=this.fb.group({id:[""],nombre:["",i.k0.required],descripcion:[""],categoriaId:["",i.k0.required],precioVenta:[0,[i.k0.required,i.k0.min(0)]],porciones:[1,[i.k0.required,i.k0.min(1)]],ingredientesBase:this.fb.array([]),recetas:this.fb.array([]),activo:[!0]})}get ingredientesBase(){return this.escandalloForm.get("ingredientesBase")}get recetasArray(){return this.escandalloForm.get("recetas")}agregarIngredienteBase(){const t=this.fb.group({productoId:["",i.k0.required],cantidad:[0,[i.k0.required,i.k0.min(0)]],mermaId:[""]});this.ingredientesBase.push(t)}eliminarIngredienteBase(t){this.ingredientesBase.removeAt(t)}agregarReceta(){const t=this.fb.group({recetaId:["",i.k0.required],cantidad:[0,[i.k0.required,i.k0.min(0)]]});this.recetasArray.push(t)}eliminarReceta(t){this.recetasArray.removeAt(t)}cargarEscandallos(){const t=(0,l.collection)(this.firestore,"escandallos");this.subscriptions.add((0,l.collectionData)(t,{idField:"id"}).subscribe(o=>{this.escandallos=o.map(n=>this.calcularCostos(n)),this.calcularEstadisticas()}))}cargarProductos(){const t=(0,l.collection)(this.firestore,"productos");this.subscriptions.add((0,l.collectionData)(t,{idField:"id"}).subscribe(o=>{this.productos=o.filter(n=>!n.esCombinado)}))}cargarRecetas(){const t=(0,l.collection)(this.firestore,"recetas");this.subscriptions.add((0,l.collectionData)(t,{idField:"id"}).subscribe(o=>{this.recetas=o.map(n=>this.calcularCostosReceta(n))}))}cargarMermas(){this.subscriptions.add(this.mermasService.getMermasCocinaActivas().subscribe(t=>{this.mermas=t,console.log("Mermas de cocina cargadas:",this.mermas)}))}getMermasDisponibles(t){return t?this.mermas.filter(o=>o.productoId===t):[]}calcularCostosReceta(t){let o=0;return t.ingredientes&&Array.isArray(t.ingredientes)&&t.ingredientes.forEach(a=>{const s=this.productos.find(c=>c.id===a.productoId);s&&s.cantidad>0&&(o+=s.costo/s.cantidad*a.cantidad)}),{id:t.id,nombre:t.nombre,rendimiento:t.rendimiento||0,unidadRendimiento:t.unidadRendimiento||"g",costoTotal:o,costoPorUnidad:t.rendimiento>0?o/t.rendimiento:0}}calcularCostos(t){let o=0,n=0;return t.ingredientesBase&&t.ingredientesBase.forEach(a=>{const s=this.productos.find(c=>c.id===a.productoId);if(s&&s.cantidad>0){a.productoNombre=s.nombre,a.unidadMedida=s.unidadMedida;const c=s.costo/s.cantidad;a.costoSinMerma=c*a.cantidad,o+=a.costoSinMerma;const u=this.mermas.find(g=>g.productoId===s.id);u?(a.mermaId=u.id,a.porcentajeMerma=u.porcentajeMerma,a.costoConMerma=c*(a.cantidad/(1-u.porcentajeMerma/100))):(a.porcentajeMerma=0,a.costoConMerma=a.costoSinMerma),n+=a.costoConMerma}}),t.recetas&&t.recetas.forEach(a=>{const s=this.recetas.find(c=>c.id===a.recetaId);s&&(a.recetaNombre=s.nombre,a.unidadMedida=s.unidadRendimiento,a.costo=s.costoPorUnidad*a.cantidad,o+=a.costo,n+=a.costo)}),t.costoTotal=o,t.costoTotalConMermas=n,t.costoPorPorcion=t.porciones>0?n/t.porciones:0,t.margen=t.precioVenta-t.costoPorPorcion,t.margenPorcentaje=t.precioVenta>0?t.margen/t.precioVenta*100:0,t}calcularEstadisticas(){if(this.totalEscandallos=this.escandallos.length,this.escandallosActivos=this.escandallos.filter(t=>t.activo).length,this.totalPorciones=this.escandallos.reduce((t,o)=>t+o.porciones,0),this.escandallos.length>0){const t=this.escandallos.reduce((o,n)=>o+n.margenPorcentaje,0);this.margenPromedio=t/this.escandallos.length}else this.margenPromedio=0}abrirModalNuevo(){this.escandalloForm.reset({id:"",nombre:"",descripcion:"",categoriaId:"",precioVenta:0,porciones:1,activo:!0}),this.ingredientesBase.clear(),this.recetasArray.clear(),this.modal.show()}verDetalleEscandallo(t){this.escandalloSeleccionado=this.calcularCostos({...t}),this.detalleModal.show()}editarEscandallo(t){this.escandalloForm.patchValue(t),this.ingredientesBase.clear(),this.recetasArray.clear(),t.ingredientesBase&&t.ingredientesBase.forEach(o=>{const n=this.fb.group({productoId:[o.productoId,i.k0.required],cantidad:[o.cantidad,[i.k0.required,i.k0.min(0)]],mermaId:[o.mermaId||""]});this.ingredientesBase.push(n)}),t.recetas&&t.recetas.forEach(o=>{const n=this.fb.group({recetaId:[o.recetaId,i.k0.required],cantidad:[o.cantidad,[i.k0.required,i.k0.min(0)]]});this.recetasArray.push(n)}),this.modal.show()}editarDesdeDetalle(){this.escandalloSeleccionado&&(this.detalleModal.hide(),this.editarEscandallo(this.escandalloSeleccionado))}eliminarEscandallo(t){var o=this;return(0,F.A)(function*(){if((yield p().fire({title:"\xbfEliminar Escandallo?",text:"Esta acci\xf3n no se puede deshacer.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#dc3545",cancelButtonColor:"#6c757d",confirmButtonText:"S\xed, eliminar",cancelButtonText:"Cancelar"})).isConfirmed)try{yield(0,l.deleteDoc)((0,l.doc)(o.firestore,"escandallos",t)),p().fire("\xa1Eliminado!","El escandallo ha sido eliminado.","success")}catch(a){console.error("Error al eliminar escandallo:",a),p().fire("Error","No se pudo eliminar el escandallo.","error")}})()}eliminarDesdeDetalle(){var t=this;return(0,F.A)(function*(){t.escandalloSeleccionado?.id&&(t.detalleModal.hide(),yield t.eliminarEscandallo(t.escandalloSeleccionado.id),t.escandalloSeleccionado=null)})()}guardarEscandallo(){var t=this;return(0,F.A)(function*(){if(t.escandalloForm.invalid)return void p().fire("Error","Por favor completa todos los campos requeridos.","error");const o=t.escandalloForm.value,n={nombre:o.nombre,descripcion:o.descripcion||"",categoriaId:o.categoriaId,precioVenta:o.precioVenta,porciones:o.porciones,ingredientesBase:o.ingredientesBase||[],recetas:o.recetas||[],activo:o.activo,fechaActualizacion:new Date};try{if(o.id){const a=(0,l.doc)(t.firestore,"escandallos",o.id);yield(0,l.updateDoc)(a,n),p().fire("\xa1Actualizado!","El escandallo ha sido actualizado.","success")}else{const a={...n,fechaCreacion:(0,l.serverTimestamp)()};yield(0,l.addDoc)((0,l.collection)(t.firestore,"escandallos"),a),p().fire("\xa1Creado!","El nuevo escandallo ha sido guardado.","success")}t.modal.hide(),t.escandalloForm.reset()}catch(a){console.error("Error al guardar escandallo:",a),p().fire("Error","Hubo un problema al guardar el escandallo.","error")}})()}getCategoriaNombre(t){return this.categorias.find(n=>n.id===t)?.nombre||"Sin categor\xeda"}getCategoriaBadgeClass(t){return{platos:"bg-primary",bebidas:"bg-info",postres:"bg-warning text-dark",entradas:"bg-success",menu:"bg-danger"}[t]||"bg-secondary"}getProductoNombre(t){return this.productos.find(n=>n.id===t)?.nombre||"Producto no encontrado"}getRecetaNombre(t){return this.recetas.find(n=>n.id===t)?.nombre||"Receta no encontrada"}onProductoInput(t,o){const n=o.target.value,a=this.productos.find(c=>c.nombre.toLowerCase()===n.toLowerCase()),s=this.ingredientesBase.at(t);if(a){const c=this.mermas.find(u=>u.productoId===a.id&&u.activo);s.patchValue({productoId:a.id,mermaId:c?c.id:""})}else s.patchValue({productoId:"",mermaId:""})}getMermaPorcentaje(t){if(!t)return 0;const o=this.mermas.find(n=>n.productoId===t);return o?o.porcentajeMerma:0}filtrarProductosIngrediente(t){const o=this.busquedaProductos[t]||"";if(!o.trim())return void(this.productosFiltradosIngrediente=this.productos.slice(0,10));const n=o.toLowerCase();this.productosFiltradosIngrediente=this.productos.filter(a=>a.nombre.toLowerCase().includes(n)).slice(0,10)}seleccionarProductoIngrediente(t,o){this.ingredientesBase.at(t).patchValue({productoId:o.id}),this.busquedaProductos[t]=o.nombre,this.mostrarListaProductosIndex=null}filtrarRecetasEscandallo(t){const o=this.busquedaRecetas[t]||"";if(!o.trim())return void(this.recetasFiltradas=this.recetas.slice(0,10));const n=o.toLowerCase();this.recetasFiltradas=this.recetas.filter(a=>a.nombre.toLowerCase().includes(n)).slice(0,10)}seleccionarRecetaEscandallo(t,o){this.recetasArray.at(t).patchValue({recetaId:o.id}),this.busquedaRecetas[t]=o.nombre,this.mostrarListaRecetasIndex=null}onRecetaInput(t,o){const n=o.target.value,a=this.recetas.find(c=>c.nombre.toLowerCase()===n.toLowerCase());this.recetasArray.at(t).patchValue(a?{recetaId:a.id}:{recetaId:""})}getProductoNombreById(t){return this.productos.find(n=>n.id===t)?.nombre||""}getRecetaNombreById(t){return this.recetas.find(n=>n.id===t)?.nombre||""}get costoPreview(){let t=0,o=0;const n=this.escandalloForm.get("precioVenta")?.value||0,a=this.escandalloForm.get("porciones")?.value||1;this.ingredientesBase.controls.forEach(g=>{const _=g.get("productoId")?.value,v=g.get("cantidad")?.value||0;if(_&&v>0){const h=this.productos.find(b=>b.id===_);if(h&&h.cantidad>0){const b=h.costo/h.cantidad,j=b*v;t+=j;const M=this.mermas.find(E=>E.productoId===_);o+=M?b*(v/(1-M.porcentajeMerma/100)):j}}}),this.recetasArray.controls.forEach(g=>{const _=g.get("recetaId")?.value,v=g.get("cantidad")?.value||0;if(_&&v>0){const h=this.recetas.find(b=>b.id===_);if(h){const b=h.costoPorUnidad*v;t+=b,o+=b}}});const s=a>0?o/a:0,c=n-s,u=n>0?c/n*100:0;return{costoTotal:isFinite(t)?t:0,costoConMermas:isFinite(o)?o:0,costoPorPorcion:isFinite(s)?s:0,margen:isFinite(c)?c:0,margenPorcentaje:isFinite(u)?u:0}}static{this.\u0275fac=function(o){return new(o||r)(e.rXU(i.ok),e.rXU(l.Firestore),e.rXU(I.d))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-escandallos-page"]],decls:145,vars:22,consts:[[1,"container-fluid"],[1,"row"],[1,"col-8"],[1,"col","text-end"],[1,"btn","btn-danger",3,"click"],[1,"bi","bi-plus-lg","me-2"],[1,"row","mt-4"],[1,"col-md-3","mb-3"],[1,"card","border-0","shadow-sm"],[1,"card-body","text-center"],[1,"text-primary","mb-0"],[1,"text-muted"],[1,"text-success","mb-0"],[1,"text-warning","mb-0"],[1,"text-info","mb-0"],["class","col-12 text-center py-5",4,"ngIf"],["class","col-12 col-md-6 col-lg-4 mb-4",4,"ngFor","ngForOf"],["id","detalleEscandalloModal","data-bs-backdrop","static","data-bs-keyboard","false","tabindex","-1",1,"modal","fade"],[1,"modal-dialog","modal-dialog-centered","modal-xl"],[1,"modal-content"],[1,"modal-header","border-0","pb-0"],[1,"d-flex","align-items-center"],[1,"rounded-circle","me-3","d-flex","justify-content-center","align-items-center",2,"background-color","#dc3545","width","56px","height","56px"],[1,"bi","bi-calculator-fill","text-white","fs-3"],[1,"mb-0"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close"],["class","modal-body pt-3",4,"ngIf"],[1,"modal-footer","border-0"],["type","button","data-bs-dismiss","modal",1,"btn","btn-secondary"],[1,"bi","bi-x-lg","me-2"],["type","button",1,"btn","btn-primary",3,"click"],[1,"bi","bi-pencil-fill","me-2"],["type","button",1,"btn","btn-danger",3,"click"],[1,"bi","bi-trash3-fill","me-2"],["id","escandalloModal","data-bs-backdrop","static","data-bs-keyboard","false","tabindex","-1",1,"modal","fade"],[1,"modal-dialog","modal-dialog-centered","modal-xl","modal-dialog-scrollable"],[3,"formGroup","ngSubmit"],[1,"modal-header"],[1,"modal-title"],[1,"modal-body"],[1,"col-md-6","mb-3"],[1,"form-label"],[1,"text-danger"],["type","text","formControlName","nombre","placeholder","Ej: Pescado Frito con Pur\xe9",1,"form-control"],["formControlName","categoriaId",1,"form-select"],["value",""],[3,"value",4,"ngFor","ngForOf"],[1,"mb-3"],["formControlName","descripcion","rows","2","placeholder","Descripci\xf3n del plato",1,"form-control"],[1,"input-group"],[1,"input-group-text"],["type","number","formControlName","precioVenta","placeholder","0.00","step","0.01",1,"form-control"],["type","number","formControlName","porciones","placeholder","1","min","1",1,"form-control"],[1,"d-flex","justify-content-between","align-items-center","mb-2"],[1,"form-label","mb-0"],[1,"bi","bi-box-seam","me-1"],["type","button",1,"btn","btn-sm","btn-outline-primary",3,"click"],[1,"bi","bi-plus","me-1"],["formArrayName","ingredientesBase"],["class","card mb-2",3,"formGroupName",4,"ngFor","ngForOf"],["class","alert alert-info py-2 px-3",4,"ngIf"],[1,"bi","bi-cup-straw","me-1"],["type","button",1,"btn","btn-sm","btn-outline-success",3,"click"],["formArrayName","recetas"],["class","card mb-2 border-success",3,"formGroupName",4,"ngFor","ngForOf"],["class","alert alert-warning mb-3",4,"ngIf"],[1,"form-check"],["type","checkbox","formControlName","activo","id","activoCheck",1,"form-check-input"],["for","activoCheck",1,"form-check-label"],[1,"modal-footer"],["type","submit",1,"btn","btn-danger",3,"disabled"],[1,"col-12","text-center","py-5"],[1,"bi","bi-inbox","fs-1","text-muted"],[1,"mt-3","text-muted"],[1,"col-12","col-md-6","col-lg-4","mb-4"],[1,"card","shadow-sm","border-0","h-100",2,"cursor","pointer",3,"click"],[1,"card-body","p-4"],[1,"d-flex","align-items-start","mb-3"],[1,"rounded-circle","me-3","d-flex","justify-content-center","align-items-center",2,"background-color","#dc3545","width","48px","height","48px","min-width","48px"],[1,"bi","bi-calculator-fill","text-white","fs-5"],[1,"flex-grow-1"],[1,"mb-1","fw-bold"],[1,"text-muted","small","mb-2"],[1,"badge","rounded-pill",3,"ngClass"],[1,"row","mb-3"],[1,"col-6"],[1,"text-muted","small"],[1,"fw-bold","text-danger",2,"font-size","1.1rem"],[1,"fw-bold","text-success",2,"font-size","1.1rem"],[1,"d-flex","align-items-center","justify-content-between","mb-2"],[1,"bi","bi-graph-up","me-1"],[1,"mb-0",3,"ngClass"],[1,"progress",2,"height","8px"],["role","progressbar","aria-valuemin","0","aria-valuemax","100",1,"progress-bar",3,"ngClass"],[1,"d-flex","justify-content-between","align-items-center"],[1,"bi","bi-people","me-1"],[1,"badge",3,"ngClass"],[1,"bi",3,"ngClass"],[1,"modal-body","pt-3"],[1,"mb-4"],[1,"badge","px-3","py-2","me-2",3,"ngClass"],[1,"bi","bi-tag-fill","me-1"],[1,"badge","px-3","py-2",3,"ngClass"],[1,"row","g-3","mb-4"],[1,"col-md-3"],[1,"card","border-0","bg-danger","bg-opacity-10","h-100"],[1,"bi","bi-cash-coin","text-danger","fs-2","d-block","mb-2"],[1,"mb-0","text-danger"],[1,"card","border-0","bg-success","bg-opacity-10","h-100"],[1,"bi","bi-tag","text-success","fs-2","d-block","mb-2"],[1,"mb-0","text-success"],[1,"card","border-0","bg-warning","bg-opacity-10","h-100"],[1,"bi","bi-graph-up","text-warning","fs-2","d-block","mb-2"],[1,"mb-0","text-warning"],[1,"card","border-0","bg-info","bg-opacity-10","h-100"],[1,"bi","bi-percent","text-info","fs-2","d-block","mb-2"],[1,"mb-0","text-info"],["class","card border-0 bg-light mb-3",4,"ngIf"],[1,"row","g-3"],[1,"col-md-6"],[1,"card","border-0","bg-primary","bg-opacity-10","h-100"],[1,"card-body"],[1,"bi","bi-people","me-2","text-primary"],[1,"bi","bi-person-fill","fs-2","text-primary","me-3"],[1,"bi","bi-calculator","me-2","text-success"],[1,"bi","bi-cash-stack","fs-2","text-success","me-3"],[1,"card","border-0","bg-light","mb-3"],[1,"bi","bi-box-seam","me-2","text-primary"],[1,"table-responsive"],[1,"table","table-sm","mb-0"],[1,"text-end"],[1,"text-center"],[4,"ngFor","ngForOf"],["class","bi bi-scissors me-1",4,"ngIf"],[1,"bi","bi-scissors","me-1"],[1,"bi","bi-cup-straw","me-2","text-primary"],[3,"value"],[1,"card","mb-2",3,"formGroupName"],[1,"card-body","p-3"],[1,"row","g-2"],[1,"form-label","small","mb-1"],[1,"position-relative"],["type","text","placeholder","Buscar producto...","autocomplete","off",1,"form-control","form-control-sm",3,"ngModel","ngModelOptions","ngModelChange","focus","input"],[1,"bi","bi-search","position-absolute","top-50","end-0","translate-middle-y","me-2","text-muted",2,"font-size","0.8rem"],["class","list-group position-absolute w-100 shadow-lg","style","max-height: 200px; overflow-y: auto; z-index: 1050;",4,"ngIf"],[1,"col-md-2"],["type","number","formControlName","cantidad","placeholder","0","step","0.01",1,"form-control","form-control-sm"],[1,"bi","bi-scissors","text-warning","me-1"],["formControlName","mermaId",1,"form-select","form-select-sm"],[1,"col-md-1","d-flex","align-items-end"],["type","button",1,"btn","btn-sm","btn-outline-danger","w-100",3,"click"],[1,"bi","bi-trash"],[1,"list-group","position-absolute","w-100","shadow-lg",2,"max-height","200px","overflow-y","auto","z-index","1050"],["type","button","class","list-group-item list-group-item-action py-2",3,"click",4,"ngFor","ngForOf"],["type","button",1,"list-group-item","list-group-item-action","py-2",3,"click"],[1,"small"],[1,"badge","bg-primary"],[1,"alert","alert-info","py-2","px-3"],[1,"bi","bi-info-circle","me-1"],[1,"card","mb-2","border-success",3,"formGroupName"],[1,"col-md-8"],["type","text","placeholder","Buscar receta...","autocomplete","off",1,"form-control","form-control-sm",3,"ngModel","ngModelOptions","ngModelChange","focus","input"],["type","number","formControlName","cantidad","placeholder","Cantidad","step","0.01",1,"form-control","form-control-sm"],[1,"col-md-1"],[1,"badge","bg-success"],[1,"alert","alert-warning","mb-3"],[1,"alert-heading"],[1,"bi","bi-calculator","me-2"],[1,"text-muted","d-block"],[1,"fs-5","text-danger"],[1,"fs-5","text-success"],[1,"fs-5",3,"ngClass"]],template:function(o,n){if(1&o&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"h5"),e.EFF(4,"Escandallos"),e.k0s(),e.j41(5,"span"),e.EFF(6,"Calcula costos precisos de tus platos finales"),e.k0s()(),e.j41(7,"div",3)(8,"button",4),e.bIt("click",function(){return n.abrirModalNuevo()}),e.nrm(9,"i",5),e.EFF(10," Nuevo Escandallo "),e.k0s()()(),e.j41(11,"div",6)(12,"div",7)(13,"div",8)(14,"div",9)(15,"h2",10),e.EFF(16),e.k0s(),e.j41(17,"span",11),e.EFF(18,"Total Escandallos"),e.k0s()()()(),e.j41(19,"div",7)(20,"div",8)(21,"div",9)(22,"h2",12),e.EFF(23),e.k0s(),e.j41(24,"span",11),e.EFF(25,"Activos"),e.k0s()()()(),e.j41(26,"div",7)(27,"div",8)(28,"div",9)(29,"h2",13),e.EFF(30),e.nI1(31,"number"),e.k0s(),e.j41(32,"span",11),e.EFF(33,"Margen Promedio"),e.k0s()()()(),e.j41(34,"div",7)(35,"div",8)(36,"div",9)(37,"h2",14),e.EFF(38),e.k0s(),e.j41(39,"span",11),e.EFF(40,"Total Porciones"),e.k0s()()()()(),e.j41(41,"div",6),e.DNE(42,O,9,0,"div",15),e.DNE(43,$,43,30,"div",16),e.k0s()(),e.j41(44,"div",17)(45,"div",18)(46,"div",19)(47,"div",20)(48,"div",21)(49,"div",22),e.nrm(50,"i",23),e.k0s(),e.j41(51,"div")(52,"h4",24),e.EFF(53),e.k0s(),e.j41(54,"small",11),e.EFF(55),e.k0s()()(),e.nrm(56,"button",25),e.k0s(),e.DNE(57,T,75,37,"div",26),e.j41(58,"div",27)(59,"button",28),e.nrm(60,"i",29),e.EFF(61,"Cerrar "),e.k0s(),e.j41(62,"button",30),e.bIt("click",function(){return n.editarDesdeDetalle()}),e.nrm(63,"i",31),e.EFF(64,"Editar "),e.k0s(),e.j41(65,"button",32),e.bIt("click",function(){return n.eliminarDesdeDetalle()}),e.nrm(66,"i",33),e.EFF(67,"Eliminar "),e.k0s()()()()(),e.j41(68,"div",34)(69,"div",35)(70,"div",19)(71,"form",36),e.bIt("ngSubmit",function(){return n.guardarEscandallo()}),e.j41(72,"div",37)(73,"h5",38),e.EFF(74),e.k0s(),e.nrm(75,"button",25),e.k0s(),e.j41(76,"div",39)(77,"div",1)(78,"div",40)(79,"label",41),e.EFF(80,"Nombre "),e.j41(81,"span",42),e.EFF(82,"*"),e.k0s()(),e.nrm(83,"input",43),e.k0s(),e.j41(84,"div",40)(85,"label",41),e.EFF(86,"Categor\xeda "),e.j41(87,"span",42),e.EFF(88,"*"),e.k0s()(),e.j41(89,"select",44)(90,"option",45),e.EFF(91,"Seleccionar categor\xeda"),e.k0s(),e.DNE(92,D,2,2,"option",46),e.k0s()()(),e.j41(93,"div",47)(94,"label",41),e.EFF(95,"Descripci\xf3n"),e.k0s(),e.nrm(96,"textarea",48),e.k0s(),e.j41(97,"div",1)(98,"div",40)(99,"label",41),e.EFF(100,"Precio de Venta "),e.j41(101,"span",42),e.EFF(102,"*"),e.k0s()(),e.j41(103,"div",49)(104,"span",50),e.EFF(105,"\u20ac"),e.k0s(),e.nrm(106,"input",51),e.k0s()(),e.j41(107,"div",40)(108,"label",41),e.EFF(109,"Porciones "),e.j41(110,"span",42),e.EFF(111,"*"),e.k0s()(),e.nrm(112,"input",52),e.k0s()(),e.j41(113,"div",47)(114,"div",53)(115,"label",54),e.nrm(116,"i",55),e.EFF(117," Ingredientes Base "),e.k0s(),e.j41(118,"button",56),e.bIt("click",function(){return n.agregarIngredienteBase()}),e.nrm(119,"i",57),e.EFF(120,"Agregar "),e.k0s()(),e.j41(121,"div",58),e.DNE(122,U,27,6,"div",59),e.k0s(),e.DNE(123,J,7,0,"div",60),e.k0s(),e.j41(124,"div",47)(125,"div",53)(126,"label",54),e.nrm(127,"i",61),e.EFF(128," Recetas Pre-elaboradas "),e.k0s(),e.j41(129,"button",62),e.bIt("click",function(){return n.agregarReceta()}),e.nrm(130,"i",57),e.EFF(131,"Agregar "),e.k0s()(),e.j41(132,"div",63),e.DNE(133,q,15,5,"div",64),e.k0s(),e.DNE(134,z,4,0,"div",60),e.k0s(),e.DNE(135,Q,29,24,"div",65),e.j41(136,"div",66),e.nrm(137,"input",67),e.j41(138,"label",68),e.EFF(139," Activo "),e.k0s()()(),e.j41(140,"div",69)(141,"button",28),e.EFF(142,"Cancelar"),e.k0s(),e.j41(143,"button",70),e.EFF(144),e.k0s()()()()()()),2&o){let a,s;e.R7$(16),e.JRh(n.totalEscandallos),e.R7$(7),e.JRh(n.escandallosActivos),e.R7$(7),e.SpI("",e.i5U(31,19,n.margenPromedio,"1.1-1"),"%"),e.R7$(8),e.JRh(n.totalPorciones),e.R7$(4),e.Y8G("ngIf",0===n.escandallos.length),e.R7$(1),e.Y8G("ngForOf",n.escandallos),e.R7$(10),e.JRh(null==n.escandalloSeleccionado?null:n.escandalloSeleccionado.nombre),e.R7$(2),e.JRh((null==n.escandalloSeleccionado?null:n.escandalloSeleccionado.descripcion)||"Sin descripci\xf3n"),e.R7$(2),e.Y8G("ngIf",n.escandalloSeleccionado),e.R7$(14),e.Y8G("formGroup",n.escandalloForm),e.R7$(3),e.JRh(null!=(a=n.escandalloForm.get("id"))&&a.value?"Editar Escandallo":"Nuevo Escandallo"),e.R7$(18),e.Y8G("ngForOf",n.categorias),e.R7$(30),e.Y8G("ngForOf",n.ingredientesBase.controls),e.R7$(1),e.Y8G("ngIf",0===n.ingredientesBase.length),e.R7$(10),e.Y8G("ngForOf",n.recetasArray.controls),e.R7$(1),e.Y8G("ngIf",0===n.recetasArray.length),e.R7$(1),e.Y8G("ngIf",n.ingredientesBase.length>0||n.recetasArray.length>0),e.R7$(8),e.Y8G("disabled",n.escandalloForm.invalid),e.R7$(1),e.SpI(" ",null!=(s=n.escandalloForm.get("id"))&&s.value?"Actualizar":"Guardar"," ")}},dependencies:[f.YU,f.Sq,f.bT,i.qT,i.xH,i.y7,i.me,i.Q0,i.Zm,i.wz,i.BC,i.cb,i.VZ,i.j4,i.JD,i.$R,i.v8,i.vS,f.QX,f.oe],styles:[".card[_ngcontent-%COMP%]{transition:transform .2s ease,box-shadow .2s ease}.card[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 .5rem 1rem #00000026!important}.badge[_ngcontent-%COMP%]{font-weight:500}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}.card[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .3s ease-out}.table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-weight:600;font-size:.875rem;text-transform:uppercase;letter-spacing:.5px}.table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{transition:background-color .2s ease}.table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#00000005}.modal-content[_ngcontent-%COMP%]{border-radius:12px;overflow:hidden}input[list][_ngcontent-%COMP%]::-webkit-calendar-picker-indicator{opacity:.6}.dark-mode[_nghost-%COMP%]   .card[_ngcontent-%COMP%], .dark-mode   [_nghost-%COMP%]   .card[_ngcontent-%COMP%]{background-color:var(--bg-card);color:var(--text-primary)}.dark-mode[_nghost-%COMP%]   .card[_ngcontent-%COMP%]:hover, .dark-mode   [_nghost-%COMP%]   .card[_ngcontent-%COMP%]:hover{box-shadow:0 .5rem 1rem #ffffff1a!important}.dark-mode[_nghost-%COMP%]   .text-muted[_ngcontent-%COMP%], .dark-mode   [_nghost-%COMP%]   .text-muted[_ngcontent-%COMP%]{color:var(--text-muted)!important}.dark-mode[_nghost-%COMP%]   .bg-light[_ngcontent-%COMP%], .dark-mode   [_nghost-%COMP%]   .bg-light[_ngcontent-%COMP%]{background-color:var(--bg-surface)!important}.dark-mode[_nghost-%COMP%]   .table[_ngcontent-%COMP%], .dark-mode   [_nghost-%COMP%]   .table[_ngcontent-%COMP%]{color:var(--text-primary)}.dark-mode[_nghost-%COMP%]   .table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover, .dark-mode   [_nghost-%COMP%]   .table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#ffffff0d}.dark-mode[_nghost-%COMP%]   .modal-content[_ngcontent-%COMP%], .dark-mode   [_nghost-%COMP%]   .modal-content[_ngcontent-%COMP%]{background-color:var(--bg-card);color:var(--text-primary)}.dark-mode[_nghost-%COMP%]   .modal-header[_ngcontent-%COMP%], .dark-mode   [_nghost-%COMP%]   .modal-header[_ngcontent-%COMP%]{border-bottom-color:var(--border-color)}.dark-mode[_nghost-%COMP%]   .modal-footer[_ngcontent-%COMP%], .dark-mode   [_nghost-%COMP%]   .modal-footer[_ngcontent-%COMP%]{border-top-color:var(--border-color)}.dark-mode[_nghost-%COMP%]   .form-control[_ngcontent-%COMP%], .dark-mode   [_nghost-%COMP%]   .form-control[_ngcontent-%COMP%], .dark-mode[_nghost-%COMP%]   .form-select[_ngcontent-%COMP%], .dark-mode   [_nghost-%COMP%]   .form-select[_ngcontent-%COMP%]{background-color:var(--input-bg);border-color:var(--input-border);color:var(--text-primary)}.dark-mode[_nghost-%COMP%]   .form-control[_ngcontent-%COMP%]:focus, .dark-mode   [_nghost-%COMP%]   .form-control[_ngcontent-%COMP%]:focus, .dark-mode[_nghost-%COMP%]   .form-select[_ngcontent-%COMP%]:focus, .dark-mode   [_nghost-%COMP%]   .form-select[_ngcontent-%COMP%]:focus{background-color:var(--input-bg);border-color:var(--color-principal);color:var(--text-primary)}.dark-mode[_nghost-%COMP%]   .form-control[_ngcontent-%COMP%]::placeholder, .dark-mode   [_nghost-%COMP%]   .form-control[_ngcontent-%COMP%]::placeholder, .dark-mode[_nghost-%COMP%]   .form-select[_ngcontent-%COMP%]::placeholder, .dark-mode   [_nghost-%COMP%]   .form-select[_ngcontent-%COMP%]::placeholder{color:var(--text-muted)}.dark-mode[_nghost-%COMP%]   .alert[_ngcontent-%COMP%], .dark-mode   [_nghost-%COMP%]   .alert[_ngcontent-%COMP%]{background-color:var(--bg-surface);border-color:var(--border-color);color:var(--text-primary)}.dark-mode[_nghost-%COMP%]   .card.border-success[_ngcontent-%COMP%], .dark-mode   [_nghost-%COMP%]   .card.border-success[_ngcontent-%COMP%]{border-color:#28a745!important}.card-body[_ngcontent-%COMP%]   .row.g-2[_ngcontent-%COMP%]   .form-select-sm[_ngcontent-%COMP%], .card-body[_ngcontent-%COMP%]   .row.g-2[_ngcontent-%COMP%]   .form-control-sm[_ngcontent-%COMP%]{font-size:.875rem}.badge.rounded-pill[_ngcontent-%COMP%]{padding:.35em .75em;font-size:.75rem;font-weight:600}.card-body[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-weight:700}.table-responsive[_ngcontent-%COMP%]{border-radius:8px}.card.mb-2[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .2s ease-out}.card.border-success[_ngcontent-%COMP%]{border-width:2px}.alert-warning[_ngcontent-%COMP%]{background-color:#ffc1071a;border-left:4px solid #ffc107;border-radius:8px}.modal-dialog-scrollable[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]{max-height:calc(100vh - 200px);overflow-y:auto}"]})}}return r})()}];let Z=(()=>{class r{static{this.\u0275fac=function(o){return new(o||r)}}static{this.\u0275mod=e.$C({type:r})}static{this.\u0275inj=e.G2t({imports:[C.iI.forChild(H),C.iI]})}}return r})(),K=(()=>{class r{static{this.\u0275fac=function(o){return new(o||r)}}static{this.\u0275mod=e.$C({type:r})}static{this.\u0275inj=e.G2t({imports:[Z,R.PrivateModule,f.MD,i.X1,i.YN]})}}return r})()}}]);