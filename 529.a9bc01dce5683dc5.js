"use strict";(self.webpackChunkrigel=self.webpackChunkrigel||[]).push([[529],{8529:(L,F,l)=>{l.r(F),l.d(F,{ProductosPageModule:()=>X});var m=l(177),r=l(9417),v=l(5743),g=l(467),c=l(9173),E=l(8032),u=l.n(E),j=l(8359),C=l(4572),p=l(7673),f=l(9172),h=l(152),P=l(5558),o=l(7705);function R(a,n){if(1&a&&(o.j41(0,"option",84),o.EFF(1),o.k0s()),2&a){const e=n.$implicit;o.Y8G("value",e.id),o.R7$(1),o.JRh(e.nombre)}}function I(a,n){if(1&a&&(o.j41(0,"option",84),o.EFF(1),o.k0s()),2&a){const e=n.$implicit;o.Y8G("value",e.id),o.R7$(1),o.JRh(e.nombre)}}function S(a,n){1&a&&(o.j41(0,"div",85)(1,"p",65),o.EFF(2,"No se encontraron productos con los filtros seleccionados."),o.k0s()())}function y(a,n){if(1&a&&(o.j41(0,"span",101),o.EFF(1),o.k0s()),2&a){const e=o.XpG().$implicit,t=o.XpG();o.R7$(1),o.SpI(" ",t.getFamiliaName(e.categoriaId,e.familiaId)," ")}}function x(a,n){if(1&a&&(o.j41(0,"div",98)(1,"div",96),o.EFF(2,"Stock (unidades)"),o.k0s(),o.j41(3,"div",102),o.EFF(4),o.k0s()()),2&a){const e=o.XpG().$implicit,t=o.XpG();o.R7$(3),o.HbH(t.getStockClass(e)),o.R7$(1),o.SpI(" ",e.stock||0," ")}}function $(a,n){1&a&&(o.j41(0,"div",98)(1,"div",96),o.EFF(2,"Tipo"),o.k0s(),o.j41(3,"div",103),o.EFF(4," Receta/Combinado "),o.k0s()())}function D(a,n){if(1&a){const e=o.RV6();o.j41(0,"div",86)(1,"div",87),o.bIt("click",function(){const s=o.eBV(e).$implicit,d=o.XpG();return o.Njj(d.verDetalleProducto(s))}),o.j41(2,"div",88)(3,"div",48)(4,"div",30)(5,"h6",89),o.EFF(6),o.k0s(),o.j41(7,"p",90),o.EFF(8),o.k0s(),o.j41(9,"div",91)(10,"span",92),o.EFF(11),o.k0s(),o.DNE(12,y,2,1,"span",93),o.k0s()()(),o.j41(13,"div",94)(14,"div",95)(15,"div",96),o.EFF(16,"Contenido por unidad"),o.k0s(),o.j41(17,"div",97),o.EFF(18),o.k0s()(),o.j41(19,"div",98)(20,"div",96),o.EFF(21,"Costo"),o.k0s(),o.j41(22,"div",99),o.EFF(23),o.nI1(24,"currency"),o.k0s()(),o.DNE(25,x,5,3,"div",100),o.DNE(26,$,5,0,"div",100),o.k0s()()()()}if(2&a){const e=n.$implicit,t=o.XpG();o.R7$(6),o.JRh(e.nombre),o.R7$(2),o.JRh(e.descripcion),o.R7$(2),o.Y8G("ngClass",t.getCategoryBadgeClass(e.categoriaId)),o.R7$(1),o.SpI(" ",t.getCategoryName(e.categoriaId)," "),o.R7$(1),o.Y8G("ngIf",e.familiaId),o.R7$(6),o.Lme(" ",e.cantidad," ",e.unidadMedida," "),o.R7$(5),o.SpI(" ",o.ii3(24,10,e.costo,"EUR","symbol","1.2-2")," "),o.R7$(2),o.Y8G("ngIf",!e.esCombinado),o.R7$(1),o.Y8G("ngIf",e.esCombinado)}}function _(a,n){if(1&a&&(o.j41(0,"span",139),o.nrm(1,"i",140),o.EFF(2),o.k0s()),2&a){const e=o.XpG(2);o.R7$(2),o.SpI(" ",e.getFamiliaName(e.productoSeleccionado.categoriaId,e.productoSeleccionado.familiaId)," ")}}function G(a,n){if(1&a&&(o.j41(0,"div",141)(1,"div",9)(2,"h6",48),o.nrm(3,"i",142),o.EFF(4,"Control de Stock"),o.k0s(),o.j41(5,"div",124)(6,"div",98)(7,"div",143)(8,"div")(9,"small",128),o.EFF(10,"Stock Actual"),o.k0s(),o.j41(11,"h4",144),o.EFF(12),o.k0s()(),o.nrm(13,"i",145),o.k0s()(),o.j41(14,"div",98)(15,"div",143)(16,"div")(17,"small",128),o.EFF(18,"Stock M\xednimo"),o.k0s(),o.j41(19,"h4",146),o.EFF(20),o.k0s()(),o.nrm(21,"i",147),o.k0s()()()()()),2&a){const e=o.XpG(2);o.R7$(11),o.Y8G("ngClass",e.getStockClass(e.productoSeleccionado)),o.R7$(1),o.JRh(e.productoSeleccionado.stock),o.R7$(1),o.Y8G("ngClass",e.getStockClass(e.productoSeleccionado)),o.R7$(7),o.JRh(e.productoSeleccionado.stockMinimo)}}function M(a,n){if(1&a&&(o.j41(0,"div")(1,"small",128),o.EFF(2,"Valor en stock"),o.k0s(),o.j41(3,"strong",148),o.EFF(4),o.nI1(5,"currency"),o.k0s()()),2&a){const e=o.XpG(2);o.R7$(4),o.SpI(" ",o.ii3(5,1,(e.productoSeleccionado.stock||0)*e.productoSeleccionado.costo,"EUR","symbol","1.2-2")," ")}}function N(a,n){1&a&&(o.j41(0,"div",149),o.nrm(1,"i",150),o.j41(2,"div")(3,"strong"),o.EFF(4,"\xa1Atenci\xf3n!"),o.k0s(),o.EFF(5," El stock actual est\xe1 por debajo o igual al stock m\xednimo. Considera realizar un pedido. "),o.k0s()())}function w(a,n){if(1&a&&(o.j41(0,"div",104)(1,"div",105)(2,"span",106),o.nrm(3,"i",107),o.EFF(4),o.k0s(),o.DNE(5,_,3,1,"span",108),o.j41(6,"span",106),o.nrm(7,"i",109),o.EFF(8),o.k0s()(),o.j41(9,"div",110)(10,"div",111)(11,"div",112)(12,"div",113),o.nrm(13,"i",114),o.j41(14,"h3",115),o.EFF(15),o.nI1(16,"currency"),o.k0s(),o.j41(17,"small",65),o.EFF(18,"Costo"),o.k0s()()()(),o.j41(19,"div",111)(20,"div",116)(21,"div",113),o.nrm(22,"i",117),o.j41(23,"h3",118),o.EFF(24),o.k0s(),o.j41(25,"small",119),o.EFF(26,"IVA"),o.k0s()()()(),o.j41(27,"div",111)(28,"div",120)(29,"div",113),o.nrm(30,"i",121),o.j41(31,"h3",122),o.EFF(32),o.nI1(33,"currency"),o.k0s(),o.j41(34,"small",65),o.EFF(35,"Precio + IVA"),o.k0s()()()()(),o.DNE(36,G,22,4,"div",123),o.j41(37,"div",124)(38,"div",125)(39,"div",126)(40,"div",9)(41,"h6",48),o.nrm(42,"i",127),o.EFF(43,"Informaci\xf3n del Producto"),o.k0s(),o.j41(44,"div",48)(45,"small",128),o.EFF(46,"Contenido por unidad"),o.k0s(),o.j41(47,"strong",129),o.EFF(48),o.k0s(),o.j41(49,"small",130),o.nrm(50,"i",131),o.EFF(51," Cada unidad contiene esta cantidad "),o.k0s()(),o.j41(52,"div",48)(53,"small",128),o.EFF(54,"Proveedor"),o.k0s(),o.j41(55,"div",132),o.nrm(56,"i",133),o.j41(57,"strong"),o.EFF(58),o.k0s()()()()()(),o.j41(59,"div",125)(60,"div",126)(61,"div",9)(62,"h6",48),o.nrm(63,"i",134),o.EFF(64,"An\xe1lisis"),o.k0s(),o.j41(65,"div",48)(66,"small",128),o.EFF(67,"Margen de ganancia"),o.k0s(),o.j41(68,"div",135)(69,"div",136)(70,"strong"),o.EFF(71),o.k0s()()()(),o.DNE(72,M,6,6,"div",137),o.k0s()()()(),o.DNE(73,N,6,0,"div",138),o.k0s()),2&a){const e=o.XpG();o.R7$(2),o.Y8G("ngClass",e.getCategoryBadgeClass(e.productoSeleccionado.categoriaId)),o.R7$(2),o.SpI(" ",e.getCategoryName(e.productoSeleccionado.categoriaId)," "),o.R7$(1),o.Y8G("ngIf",e.productoSeleccionado.familiaId),o.R7$(1),o.Y8G("ngClass",e.productoSeleccionado.esCombinado?"bg-warning text-dark":"bg-info"),o.R7$(1),o.Y8G("ngClass",e.productoSeleccionado.esCombinado?"bi-cup-straw":"bi-box"),o.R7$(1),o.SpI(" ",e.productoSeleccionado.esCombinado?"Receta/Combinado":"Producto Simple"," "),o.R7$(7),o.JRh(o.ii3(16,19,e.productoSeleccionado.costo,"EUR","symbol","1.2-2")),o.R7$(9),o.SpI("",e.productoSeleccionado.IVA,"%"),o.R7$(8),o.JRh(o.ii3(33,24,e.getPrecioVenta(e.productoSeleccionado),"EUR","symbol","1.2-2")),o.R7$(4),o.Y8G("ngIf",!e.productoSeleccionado.esCombinado),o.R7$(12),o.Lme("",e.productoSeleccionado.cantidad," ",e.productoSeleccionado.unidadMedida,""),o.R7$(10),o.JRh(e.getProveedorName(e.productoSeleccionado.proveedorId)),o.R7$(11),o.xc7("width",e.getMargenPorcentaje(e.productoSeleccionado),"%"),o.BMQ("aria-valuenow",e.getMargenPorcentaje(e.productoSeleccionado)),o.R7$(2),o.SpI("",e.getMargenPorcentaje(e.productoSeleccionado),"%"),o.R7$(1),o.Y8G("ngIf",!e.productoSeleccionado.esCombinado),o.R7$(1),o.Y8G("ngIf",!e.productoSeleccionado.esCombinado&&(e.productoSeleccionado.stock||0)<=(e.productoSeleccionado.stockMinimo||0))}}function Y(a,n){1&a&&(o.j41(0,"div",151),o.EFF(1," Este nombre de producto ya existe. "),o.k0s())}function T(a,n){if(1&a&&(o.j41(0,"option",84),o.EFF(1),o.k0s()),2&a){const e=n.$implicit;o.Y8G("value",e.id),o.R7$(1),o.JRh(e.nombre)}}function V(a,n){if(1&a&&(o.j41(0,"option",84),o.EFF(1),o.k0s()),2&a){const e=n.$implicit;o.Y8G("value",e.id),o.R7$(1),o.JRh(e.nombre)}}function A(a,n){1&a&&(o.j41(0,"small",65),o.EFF(1," Las familias se cargar\xe1n al seleccionar una categor\xeda "),o.k0s())}function B(a,n){if(1&a&&(o.j41(0,"option",84),o.EFF(1),o.k0s()),2&a){const e=n.$implicit;o.Y8G("value",e.id),o.R7$(1),o.JRh(e.nombre)}}function J(a,n){if(1&a&&(o.j41(0,"option",84),o.EFF(1),o.k0s()),2&a){const e=n.$implicit;o.Y8G("value",e),o.R7$(1),o.JRh(e)}}function z(a,n){1&a&&(o.j41(0,"div",71)(1,"div",9)(2,"h6",72),o.nrm(3,"i",152),o.EFF(4," Control de Inventario "),o.k0s(),o.j41(5,"div",1)(6,"div",54)(7,"label",49),o.EFF(8," Stock Actual (Unidades) "),o.nrm(9,"i",153),o.k0s(),o.nrm(10,"input",154),o.j41(11,"small",65),o.EFF(12,"Ejemplo: Si tienes 24 botellas, pon 24"),o.k0s()(),o.j41(13,"div",54)(14,"label",49),o.EFF(15," Stock M\xednimo (Unidades) "),o.nrm(16,"i",155),o.k0s(),o.nrm(17,"input",156),o.j41(18,"small",65),o.EFF(19,"Te avisaremos cuando llegues a esta cantidad"),o.k0s()()(),o.j41(20,"div",157)(21,"small"),o.nrm(22,"i",158),o.j41(23,"strong"),o.EFF(24,"Importante:"),o.k0s(),o.EFF(25," El stock se cuenta en unidades completas del producto. Si tienes 10 botellas de 500ml, el stock es 10 (no 5000ml). "),o.k0s()()()())}const U=[{path:"",component:(()=>{class a{constructor(e,t){this.fb=e,this.firestore=t,this.productos=[],this.filteredProducts=[],this.categorias=[],this.proveedores=[],this.unidadesDisponibles=[],this.familiasDisponibles=[],this.totalProveedores=0,this.totalStockValue=0,this.productosBajosEnStock=0,this.subscriptions=new j.yU,this.productSearch=new r.MJ(""),this.categoryFilter=new r.MJ("all"),this.supplierFilter=new r.MJ("all"),this.productoSeleccionado=null}ngOnInit(){this.productoForm=this.fb.group({id:[""],nombre:["",{validators:[r.k0.required],asyncValidators:[this.productNameValidator()],updateOn:"blur"}],descripcion:["",r.k0.required],costo:[0,[r.k0.required,r.k0.min(0)]],IVA:[0,[r.k0.required,r.k0.min(0)]],categoriaId:["",r.k0.required],familiaId:["",r.k0.required],proveedorId:[null],esCombinado:[!1],stock:[0,r.k0.min(0)],stockMinimo:[0,r.k0.min(0)],cantidad:[0,[r.k0.required,r.k0.min(0)]],unidadMedida:["",r.k0.required]}),this.cargarProductos(),this.cargarCategorias(),this.cargarProveedores();const e=document.getElementById("productModal");e&&(this.modal=new bootstrap.Modal(e));const t=document.getElementById("detalleProductoModal");t&&(this.detalleModal=new bootstrap.Modal(t)),this.subscriptions.add(this.productoForm.get("categoriaId")?.valueChanges.subscribe(i=>{this.onCategoriaChange(i)})),this.subscriptions.add(this.productoForm.get("esCombinado")?.valueChanges.subscribe(i=>{this.onEsCombinadoChange(i)})),this.subscriptions.add((0,C.z)([this.productSearch.valueChanges.pipe((0,f.Z)("")),this.categoryFilter.valueChanges.pipe((0,f.Z)("all")),this.supplierFilter.valueChanges.pipe((0,f.Z)("all"))]).pipe((0,h.B)(300)).subscribe(([i,s,d])=>{this.filterProducts(i||"",s||"all",d||"all")}))}ngOnDestroy(){this.subscriptions.unsubscribe()}productNameValidator(){return e=>(0,p.of)(e.value).pipe((0,h.B)(500),(0,P.n)(t=>{if(!t||!t.trim())return(0,p.of)(null);const i=t.trim().toLowerCase(),s=this.productoForm?.get("id")?.value;return this.productos&&0!==this.productos.length&&this.productos.some(b=>b.nombre.toLowerCase()===i&&b.id!==s)?(0,p.of)({productNameExists:!0}):(0,p.of)(null)}))}cargarProductos(){const e=(0,c.collection)(this.firestore,"productos");this.subscriptions.add((0,c.collectionData)(e,{idField:"id"}).subscribe(t=>{this.productos=t,this.filteredProducts=t,this.totalStockValue=t.reduce((i,s)=>i+(s.stock||0)*s.costo,0),this.productosBajosEnStock=t.filter(i=>!i.esCombinado&&(i.stock||0)<=(i.stockMinimo||0)).length}))}cargarCategorias(){const e=(0,c.collection)(this.firestore,"categorias");this.subscriptions.add((0,c.collectionData)(e,{idField:"id"}).subscribe(t=>{this.categorias=t}))}cargarProveedores(){const e=(0,c.collection)(this.firestore,"proveedores");this.subscriptions.add((0,c.collectionData)(e,{idField:"id"}).subscribe(t=>{this.proveedores=t,this.totalProveedores=t.length}))}filterProducts(e,t,i){let s=[...this.productos];e&&(s=s.filter(d=>d.nombre.toLowerCase().includes(e.toLowerCase()))),t&&"all"!==t&&(s=s.filter(d=>d.categoriaId===t)),i&&"all"!==i&&(s=s.filter(d=>d.proveedorId===i)),this.filteredProducts=s}onCategoriaChange(e){const t=this.categorias.find(i=>i.id===e);this.unidadesDisponibles=t?.unidadesDisponibles||[],this.unidadesDisponibles.length>0?this.productoForm.get("unidadMedida")?.setValue(this.unidadesDisponibles[0]):this.productoForm.get("unidadMedida")?.setValue(""),this.familiasDisponibles=t?.familias||[],this.productoForm.get("familiaId")?.setValue("")}onEsCombinadoChange(e){const t=this.productoForm.get("stock"),i=this.productoForm.get("stockMinimo");e?(t?.setValue(null),t?.disable(),i?.setValue(null),i?.disable()):(t?.enable(),i?.enable())}guardarProducto(){var e=this;return(0,g.A)(function*(){if(e.productoForm.invalid)return void u().fire("Error","Por favor, complete todos los campos requeridos.","error");const t=e.productoForm.getRawValue();u().showLoading();try{if(t.id){const i=(0,c.doc)(e.firestore,"productos",t.id);yield(0,c.updateDoc)(i,t),u().fire("\xa1Actualizado!","El producto ha sido actualizado.","success")}else t.fechaCreacion=(0,c.serverTimestamp)(),delete t.id,yield(0,c.addDoc)((0,c.collection)(e.firestore,"productos"),t),u().fire("\xa1Creado!","El nuevo producto ha sido guardado.","success");e.modal.hide(),e.resetForm()}catch(i){console.error("Error al guardar el producto:",i),u().fire("Error","Hubo un problema al guardar el producto.","error")}})()}editarProducto(e){this.productoForm.contains("id")||this.productoForm.addControl("id",this.fb.control(""));const t=this.categorias.find(i=>i.id===e.categoriaId);this.unidadesDisponibles=t?.unidadesDisponibles||[],this.familiasDisponibles=t?.familias||[],this.productoForm.patchValue({id:e.id,nombre:e.nombre,descripcion:e.descripcion,costo:e.costo,IVA:e.IVA,categoriaId:e.categoriaId,familiaId:e.familiaId,proveedorId:e.proveedorId,esCombinado:e.esCombinado,stock:e.stock,stockMinimo:e.stockMinimo,cantidad:e.cantidad,unidadMedida:e.unidadMedida}),this.modal.show()}eliminarProducto(e){var t=this;return(0,g.A)(function*(){if((yield u().fire({title:"\xbfEst\xe1s seguro?",text:"Esta acci\xf3n no se puede deshacer.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#dc3545",cancelButtonColor:"#6c757d",confirmButtonText:"S\xed, eliminar",cancelButtonText:"Cancelar"})).isConfirmed)try{yield(0,c.deleteDoc)((0,c.doc)(t.firestore,"productos",e)),u().fire("\xa1Eliminado!","El producto ha sido eliminado.","success")}catch(s){console.error("Error al eliminar el producto:",s),u().fire("Error","No se pudo eliminar el producto.","error")}})()}abrirModalNuevo(){this.resetForm(),this.modal.show()}resetForm(){this.productoForm.reset({id:"",nombre:"",descripcion:"",costo:0,IVA:0,categoriaId:"",familiaId:"",proveedorId:null,esCombinado:!1,stock:0,stockMinimo:0,cantidad:0,unidadMedida:""}),this.familiasDisponibles=[],this.unidadesDisponibles=[]}getCategoryName(e){const t=this.categorias.find(i=>i.id===e);return t?t.nombre:""}getFamiliaName(e,t){if(!t)return"";const i=this.categorias.find(d=>d.id===e);if(!i||!i.familias)return"";const s=i.familias.find(d=>d.id===t);return s?s.nombre:""}getCategoryBadgeClass(e){const t=this.categorias.find(d=>d.id===e);if(!t)return"bg-secondary";const i=["bg-primary","bg-success","bg-info","bg-warning","bg-danger"];return i[t.nombre.length%i.length]}getPrecioVenta(e){return e.costo*(1+(e.IVA||0)/100)}getStockClass(e){if(e.esCombinado)return"text-muted";const t=e.stock||0;return t<=0?"text-danger":t<=(e.stockMinimo||0)?"text-warning":"text-success"}getUnidadDisplay(e){return e.cantidad&&e.unidadMedida?`${e.unidadMedida}`:"unidades"}getMargenPorcentaje(e){const t=this.getPrecioVenta(e),i=e.costo;return 0===i?"0.0":((t-i)/i*100).toFixed(1)}verDetalleProducto(e){this.productoSeleccionado=e,this.detalleModal.show()}editarDesdeDetalle(){this.productoSeleccionado&&(this.detalleModal.hide(),this.editarProducto(this.productoSeleccionado))}eliminarDesdeDetalle(){var e=this;return(0,g.A)(function*(){e.productoSeleccionado&&(e.detalleModal.hide(),yield e.eliminarProducto(e.productoSeleccionado.id),e.productoSeleccionado=null)})()}getProveedorName(e){if(!e)return"Sin proveedor";const t=this.proveedores.find(i=>i.id===e);return t?t.nombre:"Sin proveedor"}static{this.\u0275fac=function(t){return new(t||a)(o.rXU(r.ok),o.rXU(c.Firestore))}}static{this.\u0275cmp=o.VBU({type:a,selectors:[["app-productos-page"]],decls:182,vars:26,consts:[[1,"container-fluid"],[1,"row"],[1,"col-8"],[1,"col","text-end"],[1,"btn","btn-danger",3,"click"],[1,"bi","bi-plus-lg","me-2"],[1,"row","mt-3"],[1,"col"],[1,"card"],[1,"card-body"],[1,"row","d-flex","align-items-center"],[1,"col-12","col-sm-4","mt-2"],["type","text","placeholder","Buscar productos...",1,"form-control",3,"formControl"],[1,"col-12","col-sm-3","mt-2"],[1,"form-select",3,"formControl"],["value","all"],[3,"value",4,"ngFor","ngForOf"],[1,"col-12","col-sm-2","mt-2"],[1,"bi","bi-box","text-primary"],[1,"bi","bi-exclamation-circle","text-danger"],[1,"row","mt-4"],["class","col-12 text-center",4,"ngIf"],["class","col-12 col-sm-3 mb-4",4,"ngFor","ngForOf"],["id","detalleProductoModal","data-bs-backdrop","static","data-bs-keyboard","false","tabindex","-1",1,"modal","fade"],[1,"modal-dialog","modal-dialog-centered","modal-lg"],[1,"modal-content"],[1,"modal-header","border-0","pb-0"],[1,"d-flex","align-items-center","w-100"],[1,"rounded-circle","me-3","d-flex","justify-content-center","align-items-center",2,"background","linear-gradient(135deg, #667eea 0%, #764ba2 100%)","width","56px","height","56px"],[1,"bi","bi-box-seam-fill","text-white","fs-3"],[1,"flex-grow-1"],[1,"mb-1"],[1,"text-muted","mb-0","small"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close"],["class","modal-body pt-3",4,"ngIf"],[1,"modal-footer","border-0"],["type","button","data-bs-dismiss","modal",1,"btn","btn-secondary"],[1,"bi","bi-x-lg","me-2"],["type","button",1,"btn","btn-primary",3,"click"],[1,"bi","bi-pencil-fill","me-2"],["type","button",1,"btn","btn-danger",3,"click"],[1,"bi","bi-trash3-fill","me-2"],["id","productModal","data-bs-backdrop","static","data-bs-keyboard","false","tabindex","-1",1,"modal","fade"],[1,"modal-dialog","modal-dialog-centered"],[3,"formGroup","ngSubmit"],[1,"modal-header"],[1,"modal-title"],[1,"modal-body"],[1,"mb-3"],[1,"form-label"],[1,"text-danger"],["type","text","formControlName","nombre","placeholder","Ej: Coca-Cola",1,"form-control"],["class","text-danger mt-1",4,"ngIf"],["formControlName","descripcion","placeholder","Descripci\xf3n del producto",1,"form-control"],[1,"col-md-6","mb-3"],["type","number","formControlName","costo","placeholder","0.00",1,"form-control"],["formControlName","IVA",1,"form-control"],["selected","","disabled",""],["value","4"],["value","10"],["value","21"],["formControlName","categoriaId",1,"form-select"],["value","","disabled",""],["formControlName","familiaId",1,"form-select",3,"disabled"],["class","text-muted",4,"ngIf"],[1,"text-muted"],["formControlName","proveedorId",1,"form-select"],[3,"ngValue"],[1,"form-check","mb-3"],["type","checkbox","formControlName","esCombinado","id","esCombinadoCheck",1,"form-check-input"],["for","esCombinadoCheck",1,"form-check-label"],[1,"card","bg-light","mb-3"],[1,"card-title","mb-3"],[1,"bi","bi-info-circle","me-2"],["title","\xbfCu\xe1nto contiene cada unidad? Ej: 500ml, 1kg, 250g",1,"bi","bi-question-circle","text-info","ms-1"],["type","number","formControlName","cantidad","placeholder","Ej: 500","step","0.01",1,"form-control"],["formControlName","unidadMedida",1,"form-select"],[1,"alert","alert-info","py-2","px-3","mb-0"],[1,"bi","bi-lightbulb","me-1"],[1,"my-2"],[1,"bi","bi-calculator","me-1"],["class","card bg-light mb-3",4,"ngIf"],[1,"modal-footer"],["type","submit",1,"btn","btn-danger",3,"disabled"],[3,"value"],[1,"col-12","text-center"],[1,"col-12","col-sm-3","mb-4"],[1,"card","shadow-sm","border-0","h-100",2,"cursor","pointer",3,"click"],[1,"card-body","p-3"],[1,"mb-1","fw-bold","text-dark"],[1,"text-muted","small","mb-2"],[1,"d-flex","flex-wrap","gap-1"],[1,"badge","rounded-pill",2,"font-size","0.75rem",3,"ngClass"],["class","badge rounded-pill bg-secondary","style","font-size: 0.7rem;",4,"ngIf"],[1,"row","mb-3"],[1,"col-12","mb-2"],[1,"text-muted","small"],[1,"fw-bold","text-info",2,"font-size","1rem"],[1,"col-6"],[1,"fw-bold","text-danger",2,"font-size","1.1rem"],["class","col-6",4,"ngIf"],[1,"badge","rounded-pill","bg-secondary",2,"font-size","0.7rem"],[1,"fw-bold"],[1,"fw-bold","text-warning",2,"font-size","0.9rem"],[1,"modal-body","pt-3"],[1,"mb-4","d-flex","gap-2","align-items-center"],[1,"badge","rounded-pill","px-3","py-2",3,"ngClass"],[1,"bi","bi-tag-fill","me-1"],["class","badge rounded-pill bg-secondary px-3 py-2",4,"ngIf"],[1,"bi",3,"ngClass"],[1,"row","g-3","mb-3"],[1,"col-md-4"],[1,"card","border-0","bg-danger","bg-opacity-10","h-100"],[1,"card-body","text-center"],[1,"bi","bi-cash-coin","text-danger","fs-2","d-block","mb-2"],[1,"mb-0","text-danger"],[1,"card","border-0","bg-primary","h-100"],[1,"bi","bi-percent","text-white","fs-2","d-block","mb-2"],[1,"mb-0","text-white"],[1,"text-white","opacity-75"],[1,"card","border-0","bg-success","bg-opacity-10","h-100"],[1,"bi","bi-calculator","text-success","fs-2","d-block","mb-2"],[1,"mb-0","text-success"],["class","card border-0 bg-light mb-3",4,"ngIf"],[1,"row","g-3"],[1,"col-md-6"],[1,"card","border-0","bg-light","h-100"],[1,"bi","bi-info-circle","me-2","text-primary"],[1,"text-muted","d-block"],[1,"fs-5","text-info"],[1,"text-muted","d-block","mt-1"],[1,"bi","bi-info-circle","me-1"],[1,"d-flex","align-items-center","mt-1"],[1,"bi","bi-building","me-2","text-primary"],[1,"bi","bi-graph-up","me-2","text-primary"],[1,"progress","mt-2",2,"height","25px"],["role","progressbar","aria-valuemin","0","aria-valuemax","100",1,"progress-bar","bg-success"],[4,"ngIf"],["class","alert alert-warning d-flex align-items-center mt-3",4,"ngIf"],[1,"badge","rounded-pill","bg-secondary","px-3","py-2"],[1,"bi","bi-diagram-3-fill","me-1"],[1,"card","border-0","bg-light","mb-3"],[1,"bi","bi-boxes","me-2","text-primary"],[1,"d-flex","align-items-center","justify-content-between","p-3","bg-white","rounded"],[1,"mb-0",3,"ngClass"],[1,"bi","bi-box-seam","fs-2",3,"ngClass"],[1,"mb-0","text-warning"],[1,"bi","bi-exclamation-triangle","fs-2","text-warning"],[1,"fs-5","text-success"],[1,"alert","alert-warning","d-flex","align-items-center","mt-3"],[1,"bi","bi-exclamation-triangle-fill","fs-4","me-3"],[1,"text-danger","mt-1"],[1,"bi","bi-boxes","me-2"],["title","\xbfCu\xe1ntas unidades tienes en inventario?",1,"bi","bi-question-circle","text-info","ms-1"],["type","number","formControlName","stock","placeholder","Ej: 24","min","0",1,"form-control"],["title","\xbfCu\xe1ndo quieres que te avise para reponer?",1,"bi","bi-question-circle","text-info","ms-1"],["type","number","formControlName","stockMinimo","placeholder","Ej: 5","min","0",1,"form-control"],[1,"alert","alert-warning","py-2","px-3","mb-0"],[1,"bi","bi-exclamation-triangle","me-1"]],template:function(t,i){if(1&t&&(o.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"h5"),o.EFF(4,"Gesti\xf3n de Productos"),o.k0s(),o.j41(5,"span"),o.EFF(6,"Crea, edita y organiza todos tus productos."),o.k0s()(),o.j41(7,"div",3)(8,"button",4),o.bIt("click",function(){return i.abrirModalNuevo()}),o.nrm(9,"i",5),o.EFF(10," Nuevo Producto "),o.k0s()()(),o.j41(11,"div",6)(12,"div",7)(13,"div",8)(14,"div",9)(15,"div",10)(16,"div",11),o.nrm(17,"input",12),o.k0s(),o.j41(18,"div",13)(19,"select",14)(20,"option",15),o.EFF(21,"Todas las categor\xedas"),o.k0s(),o.DNE(22,R,2,2,"option",16),o.k0s()(),o.j41(23,"div",13)(24,"select",14)(25,"option",15),o.EFF(26,"Todos los proveedores"),o.k0s(),o.DNE(27,I,2,2,"option",16),o.k0s()(),o.j41(28,"div",17)(29,"span"),o.nrm(30,"i",18),o.EFF(31),o.k0s(),o.EFF(32,"\xa0\xa0 "),o.j41(33,"span"),o.nrm(34,"i",19),o.EFF(35),o.k0s()()()()()()(),o.j41(36,"div",20),o.DNE(37,S,3,0,"div",21),o.DNE(38,D,27,15,"div",22),o.k0s()(),o.j41(39,"div",23)(40,"div",24)(41,"div",25)(42,"div",26)(43,"div",27)(44,"div",28),o.nrm(45,"i",29),o.k0s(),o.j41(46,"div",30)(47,"h4",31),o.EFF(48),o.k0s(),o.j41(49,"p",32),o.EFF(50),o.k0s()()(),o.nrm(51,"button",33),o.k0s(),o.DNE(52,w,74,29,"div",34),o.j41(53,"div",35)(54,"button",36),o.nrm(55,"i",37),o.EFF(56,"Cerrar "),o.k0s(),o.j41(57,"button",38),o.bIt("click",function(){return i.editarDesdeDetalle()}),o.nrm(58,"i",39),o.EFF(59,"Editar "),o.k0s(),o.j41(60,"button",40),o.bIt("click",function(){return i.eliminarDesdeDetalle()}),o.nrm(61,"i",41),o.EFF(62,"Eliminar "),o.k0s()()()()(),o.j41(63,"div",42)(64,"div",43)(65,"div",25)(66,"form",44),o.bIt("ngSubmit",function(){return i.guardarProducto()}),o.j41(67,"div",45)(68,"h5",46),o.EFF(69),o.k0s(),o.nrm(70,"button",33),o.k0s(),o.j41(71,"div",47)(72,"div",48)(73,"label",49),o.EFF(74,"Nombre del Producto "),o.j41(75,"span",50),o.EFF(76,"*"),o.k0s()(),o.nrm(77,"input",51),o.DNE(78,Y,2,0,"div",52),o.k0s(),o.j41(79,"div",48)(80,"label",49),o.EFF(81,"Descripci\xf3n "),o.j41(82,"span",50),o.EFF(83,"*"),o.k0s()(),o.nrm(84,"textarea",53),o.k0s(),o.j41(85,"div",1)(86,"div",54)(87,"label",49),o.EFF(88,"Costo "),o.j41(89,"span",50),o.EFF(90,"*"),o.k0s()(),o.nrm(91,"input",55),o.k0s(),o.j41(92,"div",54)(93,"label",49),o.EFF(94,"IVA(%) "),o.j41(95,"span",50),o.EFF(96,"*"),o.k0s()(),o.j41(97,"select",56)(98,"option",57),o.EFF(99,"Selecciona un IVA"),o.k0s(),o.j41(100,"option",58),o.EFF(101,"4%"),o.k0s(),o.j41(102,"option",59),o.EFF(103,"10%"),o.k0s(),o.j41(104,"option",60),o.EFF(105,"21%"),o.k0s()()()(),o.j41(106,"div",48)(107,"label",49),o.EFF(108,"Categor\xeda "),o.j41(109,"span",50),o.EFF(110,"*"),o.k0s()(),o.j41(111,"select",61)(112,"option",62),o.EFF(113,"Selecciona una categor\xeda"),o.k0s(),o.DNE(114,T,2,2,"option",16),o.k0s()(),o.j41(115,"div",48)(116,"label",49),o.EFF(117,"Familia "),o.j41(118,"span",50),o.EFF(119,"*"),o.k0s()(),o.j41(120,"select",63)(121,"option",62),o.EFF(122),o.k0s(),o.DNE(123,V,2,2,"option",16),o.k0s(),o.DNE(124,A,2,0,"small",64),o.k0s(),o.j41(125,"div",48)(126,"label",49),o.EFF(127,"Proveedor "),o.j41(128,"small",65),o.EFF(129,"(Opcional)"),o.k0s()(),o.j41(130,"select",66)(131,"option",67),o.EFF(132,"Ninguno"),o.k0s(),o.DNE(133,B,2,2,"option",16),o.k0s()(),o.j41(134,"div",68),o.nrm(135,"input",69),o.j41(136,"label",70),o.EFF(137," Es Receta/Combinado (sin control de stock) "),o.k0s()(),o.j41(138,"div",71)(139,"div",9)(140,"h6",72),o.nrm(141,"i",73),o.EFF(142," Informaci\xf3n del Producto "),o.k0s(),o.j41(143,"div",1)(144,"div",54)(145,"label",49),o.EFF(146," Contenido por Unidad "),o.j41(147,"span",50),o.EFF(148,"*"),o.k0s(),o.nrm(149,"i",74),o.k0s(),o.nrm(150,"input",75),o.j41(151,"small",65),o.EFF(152,"Ejemplo: Si es una botella de 500ml, pon 500"),o.k0s()(),o.j41(153,"div",54)(154,"label",49),o.EFF(155," Unidad de Medida "),o.j41(156,"span",50),o.EFF(157,"*"),o.k0s()(),o.j41(158,"select",76)(159,"option",62),o.EFF(160,"Selecciona una unidad"),o.k0s(),o.DNE(161,J,2,2,"option",16),o.k0s(),o.j41(162,"small",65),o.EFF(163,"Siguiendo el ejemplo: ml (mililitros)"),o.k0s()()(),o.j41(164,"div",77)(165,"small"),o.nrm(166,"i",78),o.j41(167,"strong"),o.EFF(168,"Ejemplo:"),o.k0s(),o.EFF(169,' Si vendes botellas de Coca-Cola de 500ml, pon "500" en contenido y "ml" en unidad. Si vendes bolsas de arroz de 1kg, pon "1" en contenido y "kg" en unidad. '),o.k0s(),o.nrm(170,"hr",79),o.j41(171,"small"),o.nrm(172,"i",80),o.j41(173,"strong"),o.EFF(174,"Para recetas:"),o.k0s(),o.EFF(175," Esta informaci\xf3n se usa para calcular costos exactos. Si el producto cuesta \u20ac2 y contiene 500ml, cada ml cuesta \u20ac0.004. As\xed podemos calcular el costo preciso de cualquier cantidad usada en recetas. "),o.k0s()()()(),o.DNE(176,z,26,0,"div",81),o.k0s(),o.j41(177,"div",82)(178,"button",36),o.EFF(179,"Cancelar"),o.k0s(),o.j41(180,"button",83),o.EFF(181),o.k0s()()()()()()),2&t){let s,d,b,k;o.R7$(17),o.Y8G("formControl",i.productSearch),o.R7$(2),o.Y8G("formControl",i.categoryFilter),o.R7$(3),o.Y8G("ngForOf",i.categorias),o.R7$(2),o.Y8G("formControl",i.supplierFilter),o.R7$(3),o.Y8G("ngForOf",i.proveedores),o.R7$(4),o.SpI("\xa0",i.filteredProducts.length,"\xa0Productos"),o.R7$(4),o.SpI("\xa0",i.productosBajosEnStock,"\xa0Stock"),o.R7$(2),o.Y8G("ngIf",0===i.filteredProducts.length),o.R7$(1),o.Y8G("ngForOf",i.filteredProducts),o.R7$(10),o.JRh(null==i.productoSeleccionado?null:i.productoSeleccionado.nombre),o.R7$(2),o.JRh(null==i.productoSeleccionado?null:i.productoSeleccionado.descripcion),o.R7$(2),o.Y8G("ngIf",i.productoSeleccionado),o.R7$(14),o.Y8G("formGroup",i.productoForm),o.R7$(3),o.JRh(null!=(s=i.productoForm.get("id"))&&s.value?"Editar Producto":"Nuevo Producto"),o.R7$(9),o.Y8G("ngIf",null==(d=i.productoForm.get("nombre"))?null:d.hasError("productNameExists")),o.R7$(36),o.Y8G("ngForOf",i.categorias),o.R7$(6),o.Y8G("disabled",0===i.familiasDisponibles.length),o.R7$(2),o.SpI(" ",0===i.familiasDisponibles.length?"Primero selecciona una categor\xeda":"Selecciona una familia"," "),o.R7$(1),o.Y8G("ngForOf",i.familiasDisponibles),o.R7$(1),o.Y8G("ngIf",0===i.familiasDisponibles.length),o.R7$(7),o.Y8G("ngValue",null),o.R7$(2),o.Y8G("ngForOf",i.proveedores),o.R7$(28),o.Y8G("ngForOf",i.unidadesDisponibles),o.R7$(15),o.Y8G("ngIf",!(null!=(b=i.productoForm.get("esCombinado"))&&b.value)),o.R7$(4),o.Y8G("disabled",i.productoForm.invalid),o.R7$(1),o.JRh(null!=(k=i.productoForm.get("id"))&&k.value?"Actualizar":"Crear")}},dependencies:[m.YU,m.Sq,m.bT,r.qT,r.xH,r.y7,r.me,r.Q0,r.Zm,r.wz,r.BC,r.cb,r.VZ,r.l_,r.j4,r.JD,m.oe]})}}return a})()}];let O=(()=>{class a{static{this.\u0275fac=function(t){return new(t||a)}}static{this.\u0275mod=o.$C({type:a})}static{this.\u0275inj=o.G2t({imports:[v.iI.forChild(U),v.iI]})}}return a})(),X=(()=>{class a{static{this.\u0275fac=function(t){return new(t||a)}}static{this.\u0275mod=o.$C({type:a})}static{this.\u0275inj=o.G2t({imports:[m.MD,r.YN,r.X1,O]})}}return a})()}}]);